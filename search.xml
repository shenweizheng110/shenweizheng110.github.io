<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>React@15.6.2æºç è§£æ---ä» ReactDOM.render åˆ°é¡µé¢æ¸²æŸ“ï¼ˆ2ï¼‰instantiateReactComponent</title>
      <link href="/2019/09/27/React@15.6.2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90---%E4%BB%8E%20ReactDOM.render%20%E5%88%B0%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%EF%BC%882%EF%BC%89instantiateReactComponent/"/>
      <url>/2019/09/27/React@15.6.2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90---%E4%BB%8E%20ReactDOM.render%20%E5%88%B0%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%EF%BC%882%EF%BC%89instantiateReactComponent/</url>
      
        <content type="html"><![CDATA[<blockquote><p>instantiateReactComponent æ–¹æ³•æ˜¯Reactä¸­çš„ä¸€ä¸ªå¾ˆé‡è¦çš„æ–¹æ³•ï¼Œä¸»è¦ä½œç”¨æ˜¯æ ¹æ®ç»™å®šçš„node(ReactElementç±»å‹)å¯¹è±¡ï¼Œå®ä¾‹åŒ–å‡ºä¸€ä¸ªå°†è¢«æŒ‚è½½çš„å®ä¾‹ã€‚å®ä¾‹åŒ–å‡ºçš„å®ä¾‹å¤§ä½“æœ‰ä¸‰ç§ï¼ŒReactEmptyComponentã€ReactCompositeComponentã€ReactHostComponentï¼Œå…¶ä¸­ReactCompositeComponentæ˜¯é‡ç‚¹ï¼Œå†…éƒ¨åŒ…è£…äº†å¾ˆå¤šæ–¹æ³•ï¼Œè€ŒReactHostComponentä¸»è¦ç”¨æ¥å®ä¾‹åŒ–æ–‡æœ¬ç»„ä»¶å®ä¾‹ã€‚</p><p>æ¦‚è¿°<br>Given a ReactNode, create an instance that will actually be mounted.<br>ç»™ä¸€ä¸ªReactNode æŒ‡çš„æ˜¯ ReactElement å¯¹è±¡ï¼Œæ ¹æ®è¯¥å¯¹è±¡åˆ›å»ºä¸€ä¸ªå®é™…è¦æŒ‚è½½çš„å®ä¾‹</p><p>å¤§è‡´æµç¨‹<br>åˆ¤æ–­ node çš„ç±»å‹ä»¥åŠ node.type çš„ç±»å‹ï¼Œæ ¹æ®ä¸åŒçš„ç±»å‹åˆ›å»ºä¸åŒçš„å®ä¾‹</p></blockquote><a id="more"></a><h2 id="node-ä¸º-null-false"><a href="#node-ä¸º-null-false" class="headerlink" title="node ä¸º null | false"></a>node ä¸º null | false</h2><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">if (node === null || node === false) &#123;</span><br><span class="line">   <span class="built_in"> instance </span>= ReactEmptyComponent.create(instantiateReactComponent);</span><br><span class="line">  &#125; else<span class="built_in"> if </span>(typeof node === 'object') &#123;</span><br><span class="line">    var element = node;</span><br><span class="line">    var type = element.type; // function</span><br><span class="line">   <span class="built_in"> if </span>(typeof type !== 'function' &amp;&amp; typeof type !== 'string') &#123;</span><br><span class="line">      var info = '';</span><br><span class="line">     <span class="built_in"> if </span>(process.env.NODE_ENV !== 'production') &#123;</span><br><span class="line">        /**/</span><br><span class="line">      &#125;</span><br><span class="line">      info += getDeclarationErrorAddendum(element._owner); // ''</span><br><span class="line">      !false ? /**/</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Special case string values</span><br><span class="line">   <span class="built_in"> if </span>(typeof element.type === 'string') &#123;</span><br><span class="line">     <span class="built_in"> instance </span>= ReactHostComponent.createInternalComponent(element);</span><br><span class="line">    &#125; else<span class="built_in"> if </span>(isInternalComponentType(element.type)) &#123;</span><br><span class="line">     <span class="built_in"> if </span>(!instance.getHostNode) &#123;</span><br><span class="line">        instance.getHostNode = instance.getNativeNode;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">     <span class="built_in"> instance </span>=<span class="built_in"> new </span>ReactCompositeComponentWrapper(element);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else<span class="built_in"> if </span>(typeof node === 'string' || typeof node === 'number') &#123;</span><br><span class="line">   <span class="built_in"> instance </span>= ReactHostComponent.createInstanceForText(node);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    !false ? /**/</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è‹¥ <code>node</code> çš„ç±»å‹æ˜¯<code>null</code>æˆ–è€…ä¸º<code>false</code>ï¼Œåˆ›å»ºä¸€ä¸ª<code>ReactEmptyComponent</code>å®ä¾‹ã€‚</p><p><strong>ReactEmptyComponent</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ReactEmptyComponent.js</span></span><br><span class="line"><span class="keyword">var</span> emptyComponentFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ReactEmptyComponentInjection = &#123;</span><br><span class="line">  injectEmptyComponentFactory: <span class="function"><span class="keyword">function</span> (<span class="params">factory</span>) </span>&#123;</span><br><span class="line">    emptyComponentFactory = factory;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ReactEmptyComponent = &#123;</span><br><span class="line">  create: <span class="function"><span class="keyword">function</span> (<span class="params">instantiate</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> emptyComponentFactory(instantiate);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ReactEmptyComponent.injection = ReactEmptyComponentInjection;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = ReactEmptyComponent;</span><br></pre></td></tr></table></figure><p>è¿™è¾¹å¯ä»¥çœ‹å‡º<code>ReactEmptyComponent.create</code>æ–¹æ³•å°±æ˜¯è°ƒç”¨<code>emptyComponentFactory()</code>æ–¹æ³•ï¼Œè€Œ<code>emptyComponentFactory</code>æ˜¯å¤–éƒ¨é—­åŒ…çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯åœ¨å…¨å±€ä¾èµ–æ³¨å…¥æ˜¯è°ƒç”¨<code>ReactEmptyComponent.injection</code>æ—¶è¿›è¡Œæ³¨å…¥çš„ã€‚æ³¨å…¥çš„åœ°æ–¹åœ¨<code>ReactDefaultInjection.js</code>æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šä¸€ç¯‡åšå®¢çš„å¼€å¤´æ‰€é˜è¿°çš„å…¨å±€ä¾èµ–æ³¨å…¥ï¼Œä½œç”¨å°±åœ¨äºç»™ä¸€äº›å‡½æ•°å¤–éƒ¨é—­åŒ…çš„å˜é‡å¯¹è±¡æŸä¸ªå±æ€§è¿›è¡Œèµ‹å€¼ï¼Œè¿™æ ·åšæ–¹ä¾¿ç®¡ç†ï¼Œç¥ä¹å…¶æŠ€çš„å°è£…ã€‚æˆ‘è§‰å¾—è¿™ç§ä¼˜ç§€çš„å°è£…ä¹Ÿæ˜¯æˆ‘ä»¬è¯¥å­¦ä¹ çš„ä¸€éƒ¨åˆ†ã€‚æœ‰åŠ©äºæˆ‘ä»¬å†™å‡ºæ›´åŠ å®Œå–„çš„ä»£ç ã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ReactInjection.EmptyComponent.injectEmptyComponentFactory(<span class="function"><span class="keyword">function</span> <span class="params">(instantiate)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ReactDOMEmptyComponent(instantiate);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™è¾¹ç»™<code>emptyComponentFactory</code>èµ‹å€¼çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ª<code>new ReactDOMEmptyComponent(instantiate);</code>ReactDOMEmptyComponentå®ä¾‹ã€‚</p><p><strong>ReactDOMEmptyComponentå®ä¾‹</strong></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ReactDOMEmptyComponent = <span class="function"><span class="keyword">function</span> <span class="params">(instantiate)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ReactCompositeComponent uses this:</span></span><br><span class="line">  <span class="keyword">this</span>._currentElement = <span class="literal">null</span>;</span><br><span class="line">  <span class="comment">// ReactDOMComponentTree uses these:</span></span><br><span class="line">  <span class="keyword">this</span>._hostNode = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>._hostParent = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>._hostContainerInfo = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">this</span>._domID = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line">_assign(ReactDOMEmptyComponent.prototype, &#123;</span><br><span class="line">  mountComponent: <span class="function"><span class="keyword">function</span> <span class="params">(transaction, hostParent, hostContainerInfo, context)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**/</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  receiveComponent: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;&#125;,</span><br><span class="line">  getHostNode: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ReactDOMComponentTree.getNodeFromInstance(<span class="keyword">this</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  unmountComponent: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    ReactDOMComponentTree.uncacheNode(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™è¾¹æˆ‘ä»¬å¤§è‡´äº†è§£ä¸€ä¸‹æœ‰é‚£äº›å±æ€§ç­‰ç”¨åˆ°æ—¶åœ¨åšé˜è¿°ã€‚é‚£ä¹ˆç”±æ­¤å¯ä»¥çœ‹å‡ºï¼ŒReactEmptyComponentåˆ›å»ºçš„å®ä¾‹å®è´¨ä¸Šå°±æ˜¯<code>ReactDOMEmptyComponent</code>ã€‚</p><h2 id="node-ä¸º-object"><a href="#node-ä¸º-object" class="headerlink" title="node ä¸º object"></a>node ä¸º object</h2><p>å½“ node çš„ç±»å‹ä¸ºä¸€ä¸ªobjectæ—¶ï¼Œè¿™è¾¹å¤§å¤šæ•°æƒ…å†µæŒ‡çš„æ˜¯æˆ‘ä»¬çš„<code>node</code>æ˜¯ä¸€ä¸ªReactElementã€‚æ¥ä¸‹æ¥ä¼šå¯¹<code>node.type</code>åšåˆ¤æ–­ã€‚</p><h3 id="node-type-function-node-type-string"><a href="#node-type-function-node-type-string" class="headerlink" title="node.type !== function || node.type !== string"></a>node.type !== function || node.type !== string</h3><p>å½“ <code>type</code> æ—¢ä¸æ˜¯ function ä¹Ÿä¸æ˜¯ä¸€ä¸ª string é‚£ä¹ˆä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šï¼Œè®²é“ç†è¦ä¹ˆæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ä¾‹å¦‚æˆ‘ä»¬çš„<code>App</code>ï¼Œé‚£ä¹ˆæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¾‹å¦‚ä¸€ä¸ª<code>div</code>æ ‡ç­¾ï¼Œä¸‹é¢ç»™ä¸€ä¸ªä¾‹å­</p><p><img src="http://static.zybuluo.com/shenweizheng/nfd2ayxt0ojjxpvqztav78p5/image_1dlpb73ib1li31kp01u8v1el10g9.png" alt="image_1dlpb73ib1li31kp01u8v1el10g9.png-48.6kB"></p><p>æŠŠ<code>node</code>ä¸€å±‚å±‚å‰¥å¼€ï¼Œçœ‹ä»–çš„<code>child</code>ï¼Œå‰§é€ä¸€ä¸‹ï¼Œåé¢ä¸€æ­¥æ­¥çš„å¿˜æ·±å¤„åˆ›å»ºå®ä¾‹ï¼Œé‚£ä¹ˆè‚¯å®šä¼šé‡åˆ°ä¸€ä¸ª<code>type: &#39;div&#39;</code>çš„ReactElementï¼Œè¿™ä¸ªæ—¶å€™ <code>type</code> å°±æ˜¯stringäº†</p><h3 id="node-type-string"><a href="#node-type-string" class="headerlink" title="node.type === string"></a>node.type === string</h3><p>é‚£ä¹ˆå½“<code>node.type</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ª<code>ReactHostComponet</code>å®ä¾‹ï¼Œè¿™è¾¹å’Œæ–‡æœ¬èŠ‚ç‚¹æœ‰æ‰€åŒºåˆ«ï¼Œè¿™è¾¹è°ƒç”¨çš„æ˜¯<code>ReactHostComponet.createInternalComponent</code>æ–¹æ³•ï¼Œæ–‡æœ¬èŠ‚ç‚¹çš„è¯ä¼šè°ƒç”¨<code>ReactHostComponet.createInstanceForText</code>ä¸‹æ–¹ä¼šé‡åˆ°ã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ReactHostComponent.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createInternalComponent</span><span class="params">(element)</span> </span>&#123;</span><br><span class="line">  !genericComponentClass <span class="comment">/**/</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> genericComponentClass(element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°é¦–å…ˆä¼šåˆ¤æ–­<code>genericComponentClass</code>æ˜¯å¦å­˜åœ¨ï¼Œè€Œè¿™ä¸ªå˜é‡æ˜¯å‡½æ•°å¤–éƒ¨é—­åŒ…çš„ä¸€ä¸ªå˜é‡ï¼Œå’Œä¹‹å‰ä¸€æ ·æ˜¯åœ¨å…¨å±€ä¾èµ–æ³¨å…¥çš„æ—¶å€™å®Œæˆäº†èµ‹å€¼ã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ReactHostComponentInjection = &#123;</span><br><span class="line">  <span class="comment">// This accepts a class that receives the tag string. This is a catch all</span></span><br><span class="line">  <span class="comment">// that can render any kind of tag.</span></span><br><span class="line">  injectGenericComponentClass: <span class="function"><span class="keyword">function</span> <span class="params">(componentClass)</span> </span>&#123;</span><br><span class="line">    genericComponentClass = componentClass;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// This accepts a text component class that takes the text string to be</span></span><br><span class="line">  <span class="comment">// rendered as props.</span></span><br><span class="line">  injectTextComponentClass: <span class="function"><span class="keyword">function</span> <span class="params">(componentClass)</span> </span>&#123;</span><br><span class="line">    textComponentClass = componentClass;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå›åˆ°<code>ReactDefaultInjection</code>ç»§ç»­æŸ¥æ‰¾è¿™è¾¹æ³¨å…¥çš„æ˜¯ä»€ä¹ˆ</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ReactInjection</span><span class="selector-class">.HostComponent</span><span class="selector-class">.injectGenericComponentClass</span>(<span class="selector-tag">ReactDOMComponent</span>);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ­¤æ—¶<code>genericComponentClass</code>å°±æ˜¯è¿™è¾¹ä¼ å…¥çš„<code>ReactDOMComponent</code>ï¼Œé‚£ä¹ˆå°±æ˜¯è¿”å›ä¸€ä¸ª<code>ReactDOMComponent</code>å®ä¾‹</p><h3 id="isInternalComponentType-element-type"><a href="#isInternalComponentType-element-type" class="headerlink" title="isInternalComponentType(element.type)"></a>isInternalComponentType(element.type)</h3><p>æ£€æµ‹ <code>node.type</code> æ˜¯ä¸æ˜¯å†…éƒ¨ç»„ä»¶ç±»å‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isInternalComponentType</span>(<span class="params"><span class="keyword">type</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> <span class="keyword">type</span> === <span class="string">'function'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="keyword">type</span>.prototype !== <span class="string">'undefined'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="keyword">type</span>.prototype.mountComponent === <span class="string">'function'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="keyword">type</span>.prototype.receiveComponent === <span class="string">'function'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯å†…éƒ¨çš„ç±»å‹çš„åŒ–ï¼Œé‚£ä¹ˆå°±ç›´æ¥å®ä¾‹åŒ–ä¼ å…¥çš„<code>node</code>ï¼Œå…·ä½“ä¾‹å­æˆ‘è¿˜æ²¡æœ‰é‡åˆ°è¿‡ï¼Œå°±ä¸åšè¿‡å¤šç†è§£äº†ï¼Œæœ‰ä¾‹å­çš„åŒå­¦æ¬¢è¿æŒ‡æ•™ã€‚</p><h3 id="node-type-ä¸æ˜¯ä¸Šè¿°ç±»å‹"><a href="#node-type-ä¸æ˜¯ä¸Šè¿°ç±»å‹" class="headerlink" title="node.type ä¸æ˜¯ä¸Šè¿°ç±»å‹"></a>node.type ä¸æ˜¯ä¸Šè¿°ç±»å‹</h3><p>å…¶å®è¿™è¾¹çš„æ„æ€å°±æ˜¯ <code>node.type</code> æ˜¯ä¸€ä¸ª<code>function</code>ï¼Œå› ä¸º <code>node.type</code> åªèƒ½æ˜¯ <code>function</code> æˆ–è€… <code>string</code>ã€‚åªä¸è¿‡é€ƒè¿‡äº†ä¸Šè¿°<code>isInternalComponentType</code>å‡½æ•°çš„æ£€æµ‹ã€‚<br>é‚£ä¹ˆè¿™è¾¹æ˜¯åˆ›å»ºçš„ä¸€ä¸ª<code>ReactCompositeComponentWrapper</code>å®ä¾‹ï¼Œè¿™ä¸ªæ„é€ å‡½æ•°æ˜¯Reactçš„ä¸€å¤§é‡ç‚¹ï¼Œæ ¹æ®æˆ‘çš„å››çº§è‹±è¯­ç¿»è¯‘ä¸º â€˜ Reactå¤åˆç±»å‹ â€˜ ä»–çš„æœ¬è´¨æ˜¯<code>ReactCompositeComponet</code>å†…éƒ¨å®ç°äº†Reactçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ŒæŒ‚è½½å¸è½½ç­‰æ“ä½œã€‚å…·ä½“çš„åé¢ä¼šæœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†è®²è§£ä»–ã€‚è¿™ä¹Ÿæ˜¯ä»£ç é‡å¯ä»¥è¯´æœ€å¤§çš„å‡ ä¸ªæ–‡ä»¶ä¹‹ä¸€äº†ã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™è¾¹æ˜¯å®šä¹‰äº†ä¸€ä¸‹è¿™ä¸ªæ„é€ å‡½æ•°ï¼Œåœ¨è¯¥æ–‡ä»¶çš„æœ€ä¸‹é¢ï¼Œå¯¹è¯¥æ„é€ å‡½æ•°çš„åŸå‹é“¾æ·»åŠ äº†ä¸€ç³»åˆ—çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">var</span> ReactCompositeComponentWrapper = <span class="function"><span class="keyword">function</span> <span class="params">(element)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.construct(element);</span><br><span class="line">  <span class="comment">// console.log(this);</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">_assign(ReactCompositeComponentWrapper.prototype, ReactCompositeComponent, &#123;</span><br><span class="line">  _instantiateReactComponent: instantiateReactComponent</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™è¾¹å¯ä»¥çœ‹å‡º<code>ReactCompositeComponentWrapper</code>çš„ä¸»è¦æ“ä½œéƒ½åœ¨<code>ReactCompositeComponent</code>æ–‡ä»¶é‡Œï¼Œè€Œè¿™è¾¹è¦†ç›–äº†ä¸€ä¸ª<code>_instantiateReactComponent</code>å±æ€§ï¼Œå€¼ä¸ºå½“å‰è®²è§£çš„è¿™ä¸ªåˆ›å»ºå®ä¾‹çš„å‡½æ•°<code>instantiateReactComponent</code></p><h2 id="node-ä¸º-string-number"><a href="#node-ä¸º-string-number" class="headerlink" title="node ä¸º string | number"></a>node ä¸º string | number</h2><p>å½“ node ä¸º string æˆ–è€… number æ—¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬ç»„ä»¶ï¼Œå¯¹è°ƒç”¨<code>ReactHostComponent.createInstanceForText</code>ï¼Œé‚£ä¹ˆåŠ ä¸Šå½“ node.type ä¸º string æ—¶çš„è®²è§£ï¼Œå¯ä»¥çœ‹å‡º<code>ReactHostComponent</code>ç»„ä»¶æè¿°çš„éƒ½æ˜¯Reactä¸­çš„æ–‡æœ¬ç»„ä»¶ã€‚è€Œ<code>ReactHostComponent.createInstanceForText</code>æ–¹æ³•å¼•ç”¨çš„æ˜¯å¤–éƒ¨é—­åŒ…çš„<code>textComponentClass</code>ï¼Œä¸€æ ·ä¹Ÿæ˜¯åœ¨å…¨å±€ä¾èµ–æ³¨å…¥çš„æ—¶å€™èµ‹å€¼çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ReactHostComponent.js</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;ReactText&#125; text</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;ReactComponent&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createInstanceForText</span><span class="params">(text)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> textComponentClass(text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReactDefaultInjection.js</span></span><br><span class="line">ReactInjection.HostComponent.injectTextComponentClass(ReactDOMTextComponent);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæœ¬è´¨å°±æ˜¯åˆ›å»ºä¸€ä¸ª <code>ReactDOMTextComponent</code> å®ä¾‹ã€‚</p><h2 id="node-ä¸æ˜¯ä¸Šè¿°ç±»å‹"><a href="#node-ä¸æ˜¯ä¸Šè¿°ç±»å‹" class="headerlink" title="node ä¸æ˜¯ä¸Šè¿°ç±»å‹"></a>node ä¸æ˜¯ä¸Šè¿°ç±»å‹</h2><p>è¿™è¾¹ä¸æ˜¯ä¸Šè¿°ç±»å‹ï¼Œé‚£ä¹ˆå°±æŠ¥é”™äº†ã€‚</p><h2 id="æ–°å¢-mountIndex-mountIage"><a href="#æ–°å¢-mountIndex-mountIage" class="headerlink" title="æ–°å¢ _mountIndex _mountIage"></a>æ–°å¢ _mountIndex _mountIage</h2><p>åœ¨å¾—åˆ°å®ä¾‹ä¹‹åï¼Œä¼šç»™<code>instance</code>æ·»åŠ ä¸¤ä¸ªé¢å¤–çš„å±æ€§ã€‚æ ¹æ®å®˜æ–¹ç»™çš„è‹±æ–‡æ³¨é‡Šï¼Œå¤§è‡´å¯ä»¥çŒœå‡ºè¿™ä¸¤ä¸ªå­—æ®µæ˜¯ç”¨äº DOM å’Œ Diff ç®—æ³•ä¸Šçš„ã€‚Reactçš„Diffç®—æ³•æˆ‘ä¹Ÿä¼šå†™åšå®¢è®²è§£ï¼Œåªä¸è¿‡å¾—ç­‰è¿™ä¸ªæ¸²æŸ“çš„ä¸€ç³»åˆ—å†™å®Œã€‚Reactä¸‡å²ï¼ï¼ï¼</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// These two fields are used by the DOM and ART diffing algorithms</span></span><br><span class="line"> <span class="comment">// respectively. Instead of using expandos on components, we should be</span></span><br><span class="line"> <span class="comment">// storing the state needed by the diffing algorithms elsewhere.</span></span><br><span class="line"> <span class="comment">// è¿™ä¸¤ä¸ªå­—æ®µæ˜¯ DOM å’Œ ART diffç®—æ³•æ‰€éœ€è¦çš„å­—æ®µã€‚æˆ‘ä»¬åº”è¯¥åœ¨å…¶ä»–åœ°æ–¹å­˜å‚¨diffç®—æ³•æ‰€éœ€è¦çš„stateï¼Œ</span></span><br><span class="line"> <span class="comment">// è€Œä¸æ˜¯åœ¨ç»„ä»¶ä¸Šæ‰©å±•ä»–</span></span><br><span class="line"> <span class="comment">// è¿™ä¸¤ä¸ªå­—æ®µåˆ†åˆ«ç”¨äºDOMå’ŒART diffingç®—æ³•ã€‚æˆ‘ä»¬ä¸åº”è¯¥åœ¨ç»„ä»¶ä¸Šä½¿ç”¨expandosï¼Œè€Œæ˜¯åº”è¯¥å­˜å‚¨å…¶ä»–ä¸åŒç®—æ³•æ‰€éœ€çš„çŠ¶æ€ã€‚</span></span><br><span class="line"> <span class="keyword">instance</span><span class="variable">._mountIndex</span> = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">instance</span><span class="variable">._mountIage</span> = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><code>instantiateReactComponent</code> å‡½æ•°æ€»ä½“æ¥è¯´è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œåªæ˜¯æ ¹æ® node çš„ç±»å‹ å’Œ node.type çš„ç±»å‹åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œè¿™è¾¹çš„ä»£ç è¿˜æ˜¯å¯ä»¥ç†è§£çš„ï¼Œä¸äº†è§£å®ä¾‹å†…éƒ¨çš„é‚£äº›æ–¹æ³•çš„è¯éš¾åº¦è¿˜æ˜¯å¯ä»¥æ¥å—çš„ï¼Œéš¾çš„åœ°æ–¹è¿˜åœ¨åé¢ï¼Œé‚£ä¹ˆå¯¹è¯¥å‡½æ•°åšä¸€ä¸ªæµç¨‹å›¾å¦‚ä¸‹</p><p><img src="http://static.zybuluo.com/shenweizheng/952qn7bm5dhoaslh8a3v1vc1/image_1dlpdfmtm1os311vit91ndjjm.png" alt="image_1dlpdfmtm1os311vit91ndjjm.png-88.8kB"></p><blockquote><p>æœ¬ç‰‡ç•™å‘</p><p>å„ä¸ªå®ä¾‹çš„å†…éƒ¨å±æ€§ã€æ–¹æ³•</p><p>å‘æ€»ä¼šå¡«çš„ï¼Œä¸æ€¥ä¸æ€¥</p><p>ä¸‹ä¸€ç¯‡è®²è§£ ReactUpdates.js è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé‡ç‚¹ï¼Œåšå®¢æ˜¯æŒ‰ç…§æ•´ä¸ªæ¸²æŸ“çš„æµç¨‹ï¼Œéƒ¨åˆ†é‡ç‚¹æ–‡ä»¶ä¼šå•ç‹¬æ‹‰å‡ºæ¥ä¸€ç¯‡è¿›è¡Œç†è§£ã€‚</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>React@15.6.2æºç è§£æ---ä» ReactDOM.render åˆ°é¡µé¢æ¸²æŸ“ï¼ˆ1ï¼‰ReactMount</title>
      <link href="/2019/09/26/React@15.6.2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90---%E4%BB%8E%20ReactDOM.render%20%E5%88%B0%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%EF%BC%881%EF%BC%89ReactMount/"/>
      <url>/2019/09/26/React@15.6.2%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90---%E4%BB%8E%20ReactDOM.render%20%E5%88%B0%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%EF%BC%881%EF%BC%89ReactMount/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¹‹å‰ä»‹ç»äº†React16.8ç‰ˆæœ¬çš„Reactå…¬ç”¨APIï¼Œæœ¬ç€å­¦ä¹ æœ€æ–°ç‰ˆçš„Reactçš„æƒ³æ³•ï¼Œä½†æ˜¯è´¥åœ¨äº†Fiberçš„é˜µä¸‹ï¼Œè¿˜æœ‰å›è¿‡å¤´æ¥å†™ææ˜ç™½React15çš„æºç ï¼Œæ¯•ç«Ÿä»15åˆ°16æ˜¯ä¸€æ¬¡é‡å¤§çš„æ›´æ–°ã€‚æœ¬æ–‡ä¸­Reactæºç ç‰ˆæœ¬ä¸º 15.6.2 ï¼Œæœ›å„ä½çœ‹å®˜æ‰¾å‡†ç‰ˆæœ¬å·ï¼Œä¸åŒçš„ç‰ˆæœ¬è¿˜æ˜¯æœ‰ç€ç»†å¾®çš„åŒºåˆ«çš„</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨é˜…è¯»æºç æ—¶ï¼Œåœ¨Chromeä¸­æ‰“æ–­ç‚¹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ“ä½œï¼Œå¯ä»¥äº†è§£åˆ°å‡½æ•°çš„è°ƒç”¨æ ˆï¼Œå˜é‡çš„å€¼ï¼Œä¸€æ­¥ä¸€æ­¥çš„è°ƒè¯•è¿˜å¯ä»¥äº†è§£æ•´ä¸ªæ‰§è¡Œçš„æµç¨‹ï¼Œä¸€è¾¹è°ƒè¯•ä¸€è¾¹è®°å½•ç€æµç¨‹ä¸€è¾¹åœ¨åŠ ä»¥ç†è§£ä¸€è¾¹æ„Ÿæ…¨è¿™ç¥ä¹å…¶æŠ€çš„å°è£…ã€‚</p><p>åšå®¢ä¼šåŒæ­¥åˆ°githubä¸Šï¼Œè¿™æ ·ä¹Ÿç®—æ˜¯æœ‰äº†å¼€æºçš„é¡¹ç›®ã€‚æ¬¢è¿å„ä½çœ‹å®˜æŒ‡æ•™ï¼</p></blockquote><a id="more"></a><h2 id="å‡†å¤‡æ­¥éª¤"><a href="#å‡†å¤‡æ­¥éª¤" class="headerlink" title="å‡†å¤‡æ­¥éª¤"></a>å‡†å¤‡æ­¥éª¤</h2><p>é¦–å…ˆéœ€è¦å®‰è£… <a href="mailto:`React@15.6.2" target="_blank" rel="noopener">`React@15.6.2</a>ï¼Œ <a href="mailto:ReactDOM@15.6.2" target="_blank" rel="noopener">ReactDOM@15.6.2</a><code>ï¼Œå…¶æ¬¡æ­å»ºwebpackæ‰“åŒ…ï¼Œå› ä¸ºå¿…ä¸å¯å°‘çš„éœ€è¦</code>console.log<code>å•¥çš„ï¼Œå¦å¤–éœ€è¦</code>babel<code>çš„é…ç½®ï¼Œ</code>babel6 babel7<code>å€’æ˜¯æ— æ‰€è°“ï¼Œå…³é”®æ˜¯å¯ä»¥è§£ææˆ‘ä»¬çš„</code>jsx`è¯­æ³•ã€‚</p><p>ç¤ºä¾‹ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDom <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            name: <span class="string">'Hello World'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component will mount'</span>);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            name: <span class="string">'Hello CHina'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component did mount'</span>);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            name: <span class="string">'Hello CHange'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component will receive props'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUpdate(nextProps, nextState) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component will updates'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidUpdate(prevProps, prevState)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component Did Update'</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'render'</span>);</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &#123; <span class="keyword">this</span>.state.name &#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDom.render(</span></span><br><span class="line"><span class="regexp">    &lt;App&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div&gt;Hello World&lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/App&gt;,</span></span><br><span class="line"><span class="regexp">    document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><p>æœ¬ç‰‡åšå®¢å°±æ˜¯åŸºäºè¯¥ä»£ç è¿›è¡Œè°ƒè¯•çš„ï¼Œå°†è¿™æ®µä»£ç ä½¿ç”¨<code>babel</code>è½¬ç ä¹‹åçš„ç»“æœä¸º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸»è¦ä»£ç æ®µ</span></span><br><span class="line"><span class="keyword">var</span> App =</span><br><span class="line">  <span class="comment">/*#__PURE__*/</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params">_React$Component</span>) </span>&#123;</span><br><span class="line">    _inherits(App, _React$Component);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">      _classCallCheck(<span class="keyword">this</span>, App);</span><br><span class="line"></span><br><span class="line">      _this = _possibleConstructorReturn(<span class="keyword">this</span>, _getPrototypeOf(App).call(<span class="keyword">this</span>, props));</span><br><span class="line">      _this.state = &#123;</span><br><span class="line">        name: <span class="string">'Hello World'</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> _this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _createClass(App, [&#123;</span><br><span class="line">      key: <span class="string">"componentWillMount"</span>,</span><br><span class="line">      value: <span class="function"><span class="keyword">function</span> <span class="title">componentWillMount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component will mount'</span>);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">          name: <span class="string">'Hello CHina'</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      key: <span class="string">"componentDidMount"</span>,</span><br><span class="line">      value: <span class="function"><span class="keyword">function</span> <span class="title">componentDidMount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component did mount'</span>);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">          name: <span class="string">'Hello CHange'</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      key: <span class="string">"componentWillReceiveProps"</span>,</span><br><span class="line">      value: <span class="function"><span class="keyword">function</span> <span class="title">componentWillReceiveProps</span>(<span class="params">nextProps</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component will receive props'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      key: <span class="string">"componentWillUpdate"</span>,</span><br><span class="line">      value: <span class="function"><span class="keyword">function</span> <span class="title">componentWillUpdate</span>(<span class="params">nextProps, nextState</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component will updates'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      key: <span class="string">"componentDidUpdate"</span>,</span><br><span class="line">      value: <span class="function"><span class="keyword">function</span> <span class="title">componentDidUpdate</span>(<span class="params">prevProps, prevState</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'component Did Update'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, &#123;</span><br><span class="line">      key: <span class="string">"render"</span>,</span><br><span class="line">      value: <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'render'</span>);</span><br><span class="line">        <span class="keyword">return</span> _react[<span class="string">"default"</span>].createElement(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="keyword">this</span>.state.name);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> App;</span><br><span class="line">  &#125;(_react[<span class="string">"default"</span>].Component);</span><br><span class="line"></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">_reactDom[<span class="string">"default"</span>].render(_react[<span class="string">"default"</span>].createElement(App, <span class="literal">null</span>, _react[<span class="string">"default"</span>].createElement(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="string">"Hello World"</span>)), <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåä¸º<code>App</code>çš„æ„é€ å‡½æ•°ï¼Œå†…éƒ¨çš„<code>componentWillMount</code> <code>render</code>ç­‰æ–¹æ³•ï¼Œç­‰ä¼šé€šè¿‡<code>Object.defineProperty</code>æ–¹æ³•æ·»åŠ åˆ°<code>App</code>çš„åŸå‹é“¾ä¸­ã€‚ä¹‹åä½¿ç”¨<code>React.createElement</code>å°†<code>App</code>è½¬æ¢ä¸º<code>ReactElement</code>å¯¹è±¡ä¼ å…¥åˆ°<code>ReactDOM.render</code>ä¸­</p><blockquote><p>çœ‹æºç éœ€è¦æ‰å®çš„JsåŸºç¡€ï¼ŒåŸå‹é“¾ã€é—­åŒ…ã€thisæŒ‡å‘ã€æ¨¡å—åŒ–ã€Object.definePropertyç­‰å¸¸ç”¨çš„æ–¹æ³•éƒ½æ˜¯å¿…é¡»æå‰æŒæ¡çš„ã€‚</p></blockquote><h2 id="ReactDOM-render"><a href="#ReactDOM-render" class="headerlink" title="ReactDOM.render"></a>ReactDOM.render</h2><p>åœ¨å¼•å…¥<code>ReactDOM.js</code>æ–‡ä»¶çš„æ—¶å€™ï¼Œä»ä¸Šå¾€ä¸‹ä»”ç»†çœ‹ä¼šå‘ç°æœ‰è¿™ä¹ˆä¸€è¡Œä»£ç æ˜¯åœ¨å¼•å…¥çš„æ—¶å€™è¢«æ‰§è¡Œäº†<code>ReactDefaultInjection.inject();</code>ï¼Œè¿™ä¸ª<code>ReactDefaultInjection</code>è°ƒç”¨äº†å…¶å†…éƒ¨çš„ä¸€ä¸ª<code>inject</code>æ–¹æ³•ï¼Œä¸»è¦ç›®çš„æ˜¯è¿›è¡Œä¸€æ¬¡å…¨å±€çš„ä¾èµ–æ³¨å…¥ï¼Œæœ¬åšä¸»ä¸€å¼€å§‹å…‰æ³¨æ„ç€ç ”ç©¶<code>ReactDOM.render</code>äº†ï¼Œæ¼äº†è¿™ä¸€å¥ï¼Œå¯¼è‡´åé¢æœ‰çš„ä¸œè¥¿å¾ˆè¿·ï¼Œæ‰€ä»¥åœ¨è¿™æä¸ªé†’ï¼Œåœ¨å¼•å…¥ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶å†…éƒ¨æœ‰çš„å‡½æ•°æ˜¯æ²¡æœ‰è¢«å¯¼å‡ºçš„åè€Œæ˜¯åœ¨å¼•å…¥æ–‡ä»¶æ—¶ç›´æ¥æ‰§è¡Œçš„ã€‚è¿™ä¸ª<code>inject</code>å…·ä½“çš„ä»£ç åé¢ç”¨åˆ°æ—¶ä¼šè¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚</p><p>ä¸‹é¢å°±æ˜¯<code>ReactDOM</code>æ–‡ä»¶çš„ä»£ç äº†</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å„ç§æ–‡ä»¶çš„å¼•å…¥ */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œä¾èµ–æ³¨å…¥</span></span><br><span class="line">ReactDefaultInjection.inject();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReactDOMå¯¹è±¡</span></span><br><span class="line">var ReactDOM = &#123;</span><br><span class="line"><span class="symbol">  findDOMNode:</span> findDOMNode,</span><br><span class="line"><span class="symbol">  render:</span> ReactMount.render,</span><br><span class="line"><span class="symbol">  unmountComponentAtNode:</span> ReactMount.unmountComponentAtNode,</span><br><span class="line"><span class="symbol">  version:</span> ReactVersion,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* eslint-disable camelcase */</span></span><br><span class="line"><span class="symbol">  unstable_batchedUpdates:</span> ReactUpdates.batchedUpdates,</span><br><span class="line"><span class="symbol">  unstable_renderSubtreeIntoContainer:</span> renderSubtreeIntoContainer</span><br><span class="line">  <span class="comment">/* eslint-enable camelcase */</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ‚ä¸ƒæ‚å…«çš„ä¸œè¥¿ */</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå®è´¨ä¸Š<code>ReactDOM.render</code>æ–¹æ³•å°±æ˜¯<code>ReactMount.render</code>æ–¹æ³•ï¼Œ<code>ReactMount</code>æ–‡ä»¶å¯ä»¥è¯´æ˜¯renderçš„å…¥å£äº†ï¼Œæ˜¯ä¸€ä¸ªæå…¶é‡è¦çš„æ–‡ä»¶ã€‚å½“ç„¶<code>ReactDOM</code>ä¸¤ä¸‡å¤šè¡Œä»£ç ï¼Œé‡è¦çš„æ–‡ä»¶ä¸€å¤§å †ã€‚ã€‚ã€‚ã€‚</p><h2 id="ReactMount"><a href="#ReactMount" class="headerlink" title="ReactMount"></a>ReactMount</h2><p>è¿˜æ˜¯ä¸€æ ·çš„ï¼Œä»ä¸Šå¾€ä¸‹çœ‹ä»”ç»†çœ‹ï¼Œä¸è¦å»æ‰¾å…³é”®è¯<code>ReactMount</code>ï¼Œä¸€æ—¦æ‰¾å…³é”®è¯ä¼šé”™è¿‡å¾ˆå¤šç»†èŠ‚ã€‚ä¸€æ—¦é”™è¿‡äº†é‚£ä¹ˆå¯¼è‡´çš„ç»“å±€å°±æ˜¯å§æ§½ï¼Œè¿™ä¸ªä¸œè¥¿ä»€ä¹ˆæ—¶å€™è¢«èµ‹å€¼äº†ï¼Œå§æ§½ï¼Œè¿™ä¸ªå±æ€§å“ªé‡Œæ¥çš„å°´å°¬å±€é¢ã€‚æ‰€ä»¥å†ä¸€æ¬¡å¼ºè°ƒï¼Œæ‰“æ–­ç‚¹çš„å¥½å¤„ã€‚Chromeæ–­ç‚¹ï¼ŒğŸ§±</p><p>é‚£ä¹ˆä½ ä¼šå‘ç°ï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªæ„é€ å‡½æ•°</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Temporary (?) hack so that we can store all top-level pending updates on</span></span><br><span class="line"><span class="comment"> * composites instead of having to worry about different types of components</span></span><br><span class="line"><span class="comment"> * here.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> topLevelRootCounter = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> TopLevelWrapper = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.rootID = topLevelRootCounter++;</span><br><span class="line">&#125;;</span><br><span class="line">TopLevelWrapper.prototype.isReactComponent = &#123;&#125;;</span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">  TopLevelWrapper.displayName = <span class="string">'TopLevelWrapper'</span>;</span><br><span class="line">&#125;</span><br><span class="line">TopLevelWrapper.prototype.render = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.props.child;</span><br><span class="line">&#125;;</span><br><span class="line">TopLevelWrapper.isReactTopLevelWrapper = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ª<code>TopLevelWrapper</code>å°±æ˜¯æ•´ä¸ªç»„ä»¶çš„æœ€é¡¶å±‚ï¼Œæˆ‘ä»¬è°ƒç”¨<code>ReactDOM.render</code>æ—¶ï¼Œä¼ é€’çš„å‚æ•°è¢«è¿™ä¸ªæ„é€ å‡½æ•°ç»™åŒ…è£¹èµ·æ¥ã€‚</p><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// ReactMount.js</span><br><span class="line"></span><br><span class="line"> /**</span><br><span class="line">   *</span><br><span class="line">   * @<span class="keyword">param</span> &#123;ReactElement&#125; <span class="keyword">nextElement</span> <span class="keyword">Component</span> <span class="keyword">element</span> <span class="keyword">to</span> <span class="keyword">render</span>.</span><br><span class="line">   * @<span class="keyword">param</span> &#123;DOMElement&#125; <span class="keyword">container</span> <span class="keyword">DOM</span> <span class="keyword">element</span> <span class="keyword">to</span> <span class="keyword">render</span> <span class="keyword">into</span>.</span><br><span class="line">   * @<span class="keyword">param</span> &#123;?function&#125; <span class="keyword">callback</span> <span class="keyword">function</span> <span class="keyword">triggered</span> <span class="keyword">on</span> <span class="keyword">completion</span></span><br><span class="line">   * @<span class="keyword">return</span> &#123;ReactComponent&#125; <span class="keyword">Component</span> <span class="keyword">instance</span> <span class="keyword">rendered</span> <span class="keyword">in</span> `container`.</span><br><span class="line">   */</span><br><span class="line">render: function (nextElement, container, callback) &#123;</span><br><span class="line">    return ReactMount._renderSubtreeIntoContainer(null, nextElement, container, callback);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><blockquote><p>å‚æ•°è¯´æ˜</p><p>nextElement: è¿™æ˜¯React.createElement(App, null, React.createElement(â€œdivâ€, null, â€œHello Worldâ€)))çš„ç»“æœï¼Œbabelåœ¨è§£æjsxæ—¶ï¼Œä¼šè°ƒç”¨React.createElementå°†æˆ‘ä»¬å†™çš„ç»„ä»¶å˜æˆä¸€ä¸ª ReactElement</p><p>container: ReactDOM.render çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ‰€éœ€è¦æŒ‚è½½çš„èŠ‚ç‚¹ï¼Œdocument.getElementById(â€˜rootâ€™)</p><p>callback: å¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°</p></blockquote><p>å†…éƒ¨å°±ä¸€å¥è¯ï¼Œå…³é”®ä»£ç è¿˜æ˜¯<code>ReactMount._renderSubtreeIntoContainer</code>å‡½æ•°</p><h3 id="ReactMount-renderSubtreeIntoContainer"><a href="#ReactMount-renderSubtreeIntoContainer" class="headerlink" title="ReactMount._renderSubtreeIntoContainer"></a>ReactMount._renderSubtreeIntoContainer</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ReactMount.js</span></span><br><span class="line"></span><br><span class="line">_renderSubtreeIntoContainer: <span class="function"><span class="keyword">function</span> <span class="params">(parentComponent, nextElement, container, callback)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒ callback</span></span><br><span class="line">    ReactUpdateQueue.validateCallback(callback, <span class="string">'ReactDOM.render'</span>);</span><br><span class="line">    !React.isValidElement(nextElement) ? <span class="comment">/**/</span></span><br><span class="line">    nextElement != <span class="literal">null</span> &amp;&amp; nextElement.props !== <span class="literal">undefined</span> ? <span class="comment">/**/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> nextWrappedElement = React.createElement(TopLevelWrapper, &#123;</span><br><span class="line">      child: nextElement</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> nextContext;</span><br><span class="line">    <span class="keyword">if</span> (parentComponent) &#123;</span><br><span class="line">      <span class="keyword">var</span> parentInst = ReactInstanceMap.get(parentComponent);</span><br><span class="line">      nextContext = parentInst._processChildContext(parentInst._context);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      nextContext = emptyObject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> prevComponent = getTopLevelWrapperInContainer(container);</span><br><span class="line">    <span class="keyword">if</span> (prevComponent) &#123;</span><br><span class="line">      <span class="keyword">var</span> prevWrappedElement = prevComponent._currentElement;</span><br><span class="line">      <span class="keyword">var</span> prevElement = prevWrappedElement.props.child;</span><br><span class="line">      <span class="keyword">if</span> (shouldUpdateReactComponent(prevElement, nextElement)) &#123;</span><br><span class="line">        <span class="keyword">var</span> publicInst = prevComponent._renderedComponent.getPublicInstance();</span><br><span class="line">        <span class="keyword">var</span> updatedCallback = callback &amp;&amp; <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">          callback.call(publicInst);</span><br><span class="line">        &#125;;</span><br><span class="line">        ReactMount._updateRootComponent(prevComponent, nextWrappedElement, nextContext, container, updatedCallback);</span><br><span class="line">        <span class="keyword">return</span> publicInst;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ReactMount.unmountComponentAtNode(container);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> reactRootElement = getReactRootElementInContainer(container);</span><br><span class="line">    <span class="keyword">var</span> containerHasReactMarkup = reactRootElement &amp;&amp; !!internalGetID(reactRootElement); <span class="comment">// false</span></span><br><span class="line">    <span class="comment">// å¦‚æœDOMå…ƒç´ åŒ…å«ä¸€ä¸ªç”±Reactå‘ˆç°ä½†ä¸æ˜¯æ ¹å…ƒç´ Rçš„ç›´æ¥å­å…ƒç´ ï¼Œåˆ™ä¸ºTrueã€‚</span></span><br><span class="line">    <span class="keyword">var</span> containerHasNonRootReactChild = hasNonRootReactChild(container); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">      <span class="comment">/**/</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> shouldReuseMarkup = containerHasReactMarkup &amp;&amp; !prevComponent &amp;&amp; !containerHasNonRootReactChild; <span class="comment">// false</span></span><br><span class="line">    <span class="keyword">var</span> component = ReactMount._renderNewRootComponent(nextWrappedElement, container, shouldReuseMarkup, nextContext)._renderedComponent.getPublicInstance();</span><br><span class="line">    <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">      callback.call(component);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> component;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>å‚æ•°<br><img src="http://static.zybuluo.com/shenweizheng/fg9uz154qldzeksr8jk0tzgr/image_1dlk722i093bbvvosn8gm1h6pp.png" alt="image_1dlk722i093bbvvosn8gm1h6pp.png-74.5kB"></p></blockquote><p>æµç¨‹ï¼š<br>é¦–å…ˆæ£€æŸ¥<code>callback</code> <code>nextElement</code>æ˜¯å¦æ˜¯åˆæ³•çš„ï¼Œåˆ¤æ–­ä¸€ä¸‹ç±»å‹å•¥çš„ï¼Œç„¶åä¼šä½¿ç”¨React.createElementåˆ›å»ºä¸€ä¸ª<code>type</code>ä¸º<code>TopLevelWrapper</code>çš„<code>ReactElement</code></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">var nextWrappedElement</span> = React.createElement(TopLevelWrapper, &#123;</span><br><span class="line">    child: nextElement</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼ å…¥çš„nextElementä¼šå˜æˆ<code>nextWrapperElement</code>çš„ä¸€ä¸ª<code>props</code>;</p><p><img src="http://static.zybuluo.com/shenweizheng/5svn7431hrt48zcqh34q2otd/image_1dlk7bg5l1vbf1d1dhbteq8f0d16.png" alt="image_1dlk7bg5l1vbf1d1dhbteq8f0d16.png-50.2kB"></p><p>ä¹‹åå¯¹<code>parentComponent</code>æ˜¯å¦å­˜åœ¨è¿›è¡Œåˆ¤æ–­å¹¶å¯¹<code>nextContext</code>èµ‹å€¼ï¼Œå½“å‰ä¸ºç©ºèµ‹å€¼ä¸ºä¸€ä¸ªç©ºå¯¹è±¡<code>emptyObject</code></p><p>è°ƒç”¨<code>getTopLevelWrapperInContainer(container)</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯æ£€æŸ¥å®¹å™¨å†…éƒ¨æ˜¯å¦å·²ç»å­˜åœ¨ä¸€ä¸ªæœ‰ReactDOMç›´æ¥æ¸²æŸ“çš„èŠ‚ç‚¹ï¼Œå½“å‰æ˜¯æ— ï¼Œæˆ‘ä»¬çš„å®¹å™¨å†…éƒ¨æ˜¯ç©ºçš„</p><p>å†å¾€ä¸‹æ‰§è¡Œ<code>var reactRootElement = getReactRootElementInContainer(container);</code></p><p><strong>getReactRootElementInContainer</strong></p><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @<span class="keyword">param</span> &#123;DOMElement|DOMDocument&#125; <span class="keyword">container</span> <span class="keyword">DOM</span> <span class="keyword">element</span> <span class="keyword">that</span> <span class="keyword">may</span> <span class="keyword">contain</span></span><br><span class="line"> * a React component</span><br><span class="line"> * @<span class="keyword">return</span> &#123;?*&#125; <span class="keyword">DOM</span> <span class="keyword">element</span> <span class="keyword">that</span> <span class="keyword">may</span> <span class="keyword">have</span> <span class="keyword">the</span> <span class="keyword">reactRoot</span> <span class="keyword">ID</span>, or null.</span><br><span class="line"> */</span><br><span class="line">function getReactRootElementInContainer(container) &#123;</span><br><span class="line">  if (!container) &#123;</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">  // DOC_NODE_TYPE = 9</span><br><span class="line">  if (container.nodeType === DOC_NODE_TYPE) &#123;</span><br><span class="line">    return container.documentElement;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    return container.firstChild;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹container.nodeTypeåšåˆ¤æ–­ï¼Œ<code>nodeType</code>æ˜¯htmlèŠ‚ç‚¹çš„ä¸€ä¸ªå±æ€§ï¼ŒnodeType = 9 çš„è¯è¡¨æ˜å½“å‰containeræ˜¯documentèŠ‚ç‚¹ï¼Œä¸æ˜¯è¯è¿”å›å†…éƒ¨çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹</p><p>æ¥ä¸‹æ¥æ‰§è¡Œ<code>var containerHasReactMarkup = reactRootElement &amp;&amp; !!internalGetID(reactRootElement);</code></p><p>è¿™ä¸ªæ ‡è®°å˜é‡<code>containerHasReactMarkup</code> ç”¨æ¥åˆ¤æ–­å½“å‰containeræ˜¯å¦å…·æœ‰Reactæ ‡è®°ï¼Œå½“å‰å€¼ä¸º false</p><p>ä¸‹ä¸€ä¸ª<code>var containerHasNonRootReactChild = hasNonRootReactChild(container);</code>å¦‚æœDOMå…ƒç´ åŒ…å«ä¸€ä¸ªç”±Reactå‘ˆç°ä½†ä¸æ˜¯æ ¹å…ƒç´ Rçš„ç›´æ¥å­å…ƒç´ ï¼Œåˆ™ä¸ºTrueã€‚å½“å‰ä¸º false</p><p>ä¸‹é¢æ ¹æ®ä»¥ä¸Šçš„å‡ ä¸ªå˜é‡å¾—å‡ºä¸€ä¸ªæ ‡è®°å˜é‡<code>shouldReuseMarkup</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">var</span> <span class="string">shouldReuseMarkup</span> <span class="string">=</span> <span class="string">containerHasReactMarkup</span> <span class="string">&amp;&amp;</span> <span class="type">!prevComponent</span> <span class="string">&amp;&amp;</span> <span class="type">!containerHasNonRootReactChild</span><span class="string">;</span> <span class="string">//</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ˜¯è¯¥å‡½æ•°çš„æ ¸å¿ƒäº†</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> component = ReactMount._renderNewRootComponent(nextWrappedElement, container, shouldReuseMarkup, nextContext)._renderedComponent.getPublicInstance();</span><br><span class="line">   <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">     callback.call(component);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> component;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>ReactMount._renderNewRootComponent()._renderedComponent.getPublicInstance()</code>å‡½æ•°å¹¶å°†è¿”å›å€¼è¿”å›å‡ºæ¥ï¼Œå¦‚æœä¼ å…¥äº†<code>callback</code>çš„è¯ï¼Œåœ¨returnä¹‹å‰åœ¨è°ƒç”¨ä¸€ä¸‹callbackã€‚</p><p>é‚£ä¹ˆå…ˆçœ‹<code>ReactMount._renderNewRootComponent()</code>æ–¹æ³•</p><h3 id="ReactMount-renderNewRootComponent"><a href="#ReactMount-renderNewRootComponent" class="headerlink" title="ReactMount._renderNewRootComponent"></a>ReactMount._renderNewRootComponent</h3><p>ä¼ å…¥çš„å‚æ•°ä¸º<br><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nextWrappedElement</span>: nextWrappedElement // å¯¹ TopLevelWrapperè°ƒç”¨React.createElementçš„ç»“æœ</span><br><span class="line"></span><br><span class="line"><span class="attribute">container</span>: document.getElementById('root')</span><br><span class="line"></span><br><span class="line"><span class="attribute">shouldReuseMarkup</span>: false</span><br><span class="line"></span><br><span class="line"><span class="attribute">nextContext</span>: &#123;&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">_renderNewRootComponent: <span class="function"><span class="keyword">function</span> <span class="params">(nextElement, container, shouldReuseMarkup, context)</span> </span>&#123;</span><br><span class="line">   process.env.NODE_ENV !== <span class="string">'production'</span> <span class="comment">/**/</span></span><br><span class="line"></span><br><span class="line">   !isValidContainer(container) <span class="comment">/**/</span></span><br><span class="line">   ReactBrowserEventEmitter.ensureScrollValueMonitoring();</span><br><span class="line">   <span class="keyword">var</span> componentInstance = instantiateReactComponent(nextElement, <span class="literal">false</span>);</span><br><span class="line">   <span class="comment">// åˆå§‹renderæ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯åœ¨renderæœŸé—´å‘ç”Ÿçš„ä»»ä½•æ›´æ–°ï¼Œåœ¨componentWillMountæˆ–componentDidMountä¸­ï¼Œéƒ½å°†æ ¹æ®å½“å‰çš„æ‰¹å¤„ç†ç­–ç•¥è¿›è¡Œæ‰¹å¤„ç†ã€‚</span></span><br><span class="line">   ReactUpdates.batchedUpdates(batchedMountComponentIntoNode, componentInstance, container, shouldReuseMarkup, context);</span><br><span class="line">   <span class="keyword">var</span> wrapperID = componentInstance._instance.rootID;</span><br><span class="line">   instancesByReactRootID[wrapperID] = componentInstance;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> componentInstance;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure><p>æµç¨‹å¦‚ä¸‹ï¼š</p><p>å¯¹ container è¿›è¡ŒéªŒè¯</p><p>è°ƒç”¨<code>ReactBrowserEventEmitter.ensureScrollValueMonitoring()</code> ç¡®ä¿ç›‘å¬æµè§ˆå™¨æ»šåŠ¨ï¼Œåœ¨React15ä¸­æ¸²æŸ“æ—¶åº”è¯¥æ˜¯ä¸ä¼šç®¡é¡µé¢ä¸­é«˜æ€§èƒ½äº‹ä»¶çš„ï¼Œæ‰€ä»¥åœ¨React16ä¸­å¼•å…¥çš„fiberæ¶æ„ã€‚</p><p>è°ƒç”¨<code>instantiateReactComponent</code>æ–¹æ³•å®ä¾‹åŒ–ä¸€ä¸ªReactComponentï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ReactDOMçš„ä¸€ä¸ªé‡ç‚¹ï¼Œåœ¨ä¸‹ç¯‡ä¼šè¯´</p><p>è°ƒç”¨<code>ReactUpdates.batchedUpdates();</code>å¼€å§‹æ‰§è¡Œæ‰¹é‡æ›´æ–°ï¼Œè¿™å½“ä¸­ä¼šç”¨åˆ°ä¸€å¼€å§‹æ³¨å…¥çš„<code>ReactDefaultBatchingStrategy</code></p><p>å¤–éƒ¨å­˜å‚¨ä¸€ä¸‹å½“å‰å®ä¾‹<code>instancesByReactRootID[wrapperID] = componentInstance</code>ï¼Œå¯¹è±¡<code>instancesByReactRootID</code>å¤–éƒ¨é—­åŒ…çš„ä¸€ä¸ªObjectï¼Œkeyå€¼ä¸ºå®ä¾‹çš„rootID,valueå€¼ä¸ºå½“å‰å®ä¾‹åŒ–å‡ºæ¥çš„å®ä¾‹</p><p>æœ€åreturnå‡ºè¿™ä¸ªå®ä¾‹ã€‚</p><blockquote><p>å½“å‰æµç¨‹å›¾</p></blockquote><p><img src="http://static.zybuluo.com/shenweizheng/8x9ovvg1sxdb2gexbjrvi10m/image_1dllogis11e54igc14j21hjq4ov1j.png" alt="image_1dllogis11e54igc14j21hjq4ov1j.png-58.4kB"></p><blockquote><p>æœ¬ç¯‡ç•™å‘</p><ol><li><p>instantiateReactComponentæ–¹æ³•</p></li><li><p>ReactUpdates æ–‡ä»¶</p></li></ol></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Reactæºç è§£æ----createElement + Component + PureComponent</title>
      <link href="/2019/09/17/React%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90----createElement%20+%20Component%20+%20PureComponent/"/>
      <url>/2019/09/17/React%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90----createElement%20+%20Component%20+%20PureComponent/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸Šä¸€ç¯‡ä»‹ç»äº†Reactçš„Apiï¼Œä»Šå¤©ä»‹ç»createElementå’ŒReactçš„Componentç›¸å…³æ“ä½œã€‚çœ‹äº†å¾ˆå¤šå…¶ä»–äººçš„åšå®¢ï¼Œå¯¹äºReact16çš„fiberæ¶æ„è¿˜æ˜¯æ— æ³•äº†è§£ï¼Œå°½ç®¡æˆ‘çŸ¥é“ä»–å¾ˆç‰›é€¼ã€‚å‘ç°äº†è§£Reactçš„æºç è¿˜æ˜¯éœ€è¦ä»æ¸²æŸ“å¼€å§‹è¿›è¡Œäº†è§£ï¼Œæ˜ç™½ä»ä¸€ä¸ªç»„ä»¶åˆ°æŒ‚è½½å†åˆ°å“åº”å¼çš„æ‰€æœ‰æ“ä½œã€‚</p></blockquote><p>é¦–å…ˆå…ˆå†™ä¸€ä¸ªç®€å•çš„Reactç»„ä»¶<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="symbol">'reac</span>t';</span><br><span class="line"><span class="keyword">import</span> <span class="type">ReactDom</span> from <span class="symbol">'react</span>-dom';</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            name: <span class="symbol">'Hello</span> <span class="type">World</span>'</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        console.log(<span class="symbol">'component</span> did mount');</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &#123; <span class="keyword">this</span>.state.name &#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">ReactDom</span>.render(</span><br><span class="line">    &lt;<span class="type">App</span> /&gt;,</span><br><span class="line">    document.getElementById(<span class="symbol">'roo</span>t')</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨<code>babel</code>ç¼–è¯‘è¿™ä¸ª<code>jsx</code>æ–‡ä»¶</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _react = _interopRequireDefault(<span class="built_in">require</span>(<span class="string">"react"</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _reactDom = _interopRequireDefault(<span class="built_in">require</span>(<span class="string">"react-dom"</span>));</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_interopRequireDefault</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> obj &amp;&amp; obj.__esModule ? obj : &#123;</span><br><span class="line">        <span class="string">"default"</span>: obj</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_typeof</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Symbol</span> === <span class="string">"function"</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">Symbol</span>.iterator === <span class="string">"symbol"</span>) &#123;</span><br><span class="line">        _typeof = <span class="function"><span class="keyword">function</span> <span class="title">_typeof</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> obj;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _typeof = <span class="function"><span class="keyword">function</span> <span class="title">_typeof</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> obj &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">Symbol</span> === <span class="string">"function"</span> &amp;&amp; obj.constructor === <span class="built_in">Symbol</span> &amp;&amp; obj !== <span class="built_in">Symbol</span>.prototype ? <span class="string">"symbol"</span> : <span class="keyword">typeof</span> obj;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _typeof(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Cannot call a class as a function"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_defineProperties</span>(<span class="params">target, props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> descriptor = props[i];</span><br><span class="line">        descriptor.enumerable = descriptor.enumerable || <span class="literal">false</span>;</span><br><span class="line">        descriptor.configurable = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"value"</span> <span class="keyword">in</span> descriptor) descriptor.writable = <span class="literal">true</span>;</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(target, descriptor.key, descriptor);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_createClass</span>(<span class="params">Constructor, protoProps, staticProps</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (protoProps) _defineProperties(Constructor.prototype, protoProps);</span><br><span class="line">    <span class="keyword">if</span> (staticProps) _defineProperties(Constructor, staticProps);</span><br><span class="line">    <span class="keyword">return</span> Constructor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_possibleConstructorReturn</span>(<span class="params">self, call</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (call &amp;&amp; (_typeof(call) === <span class="string">"object"</span> || <span class="keyword">typeof</span> call === <span class="string">"function"</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> call;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _assertThisInitialized(self);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_assertThisInitialized</span>(<span class="params">self</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (self === <span class="keyword">void</span> <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">ReferenceError</span>(<span class="string">"this hasn't been initialised - super() hasn't been called"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_getPrototypeOf</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    _getPrototypeOf = <span class="built_in">Object</span>.setPrototypeOf ? <span class="built_in">Object</span>.getPrototypeOf : <span class="function"><span class="keyword">function</span> <span class="title">_getPrototypeOf</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> o.__proto__ || <span class="built_in">Object</span>.getPrototypeOf(o);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _getPrototypeOf(o);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_inherits</span>(<span class="params">subClass, superClass</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> superClass !== <span class="string">"function"</span> &amp;&amp; superClass !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Super expression must either be null or a function"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    subClass.prototype = <span class="built_in">Object</span>.create(superClass &amp;&amp; superClass.prototype, &#123;</span><br><span class="line">        <span class="keyword">constructor</span>: &#123;</span><br><span class="line">            value: subClass,</span><br><span class="line">            writable: <span class="literal">true</span>,</span><br><span class="line">            configurable: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (superClass) _setPrototypeOf(subClass, superClass);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_setPrototypeOf</span>(<span class="params">o, p</span>) </span>&#123;</span><br><span class="line">    _setPrototypeOf = <span class="built_in">Object</span>.setPrototypeOf || <span class="function"><span class="keyword">function</span> <span class="title">_setPrototypeOf</span>(<span class="params">o, p</span>) </span>&#123;</span><br><span class="line">        o.__proto__ = p;</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _setPrototypeOf(o, p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> App =</span><br><span class="line">    <span class="comment">/*#__PURE__*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">_React$Component</span>) </span>&#123;</span><br><span class="line">        _inherits(App, _React$Component);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">            _classCallCheck(<span class="keyword">this</span>, App);</span><br><span class="line"></span><br><span class="line">            _this = _possibleConstructorReturn(<span class="keyword">this</span>, _getPrototypeOf(App).call(<span class="keyword">this</span>, props));</span><br><span class="line">            _this.state = &#123;</span><br><span class="line">                name: <span class="string">'Hello World'</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> _this;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        _createClass(App, [&#123;</span><br><span class="line">            key: <span class="string">"componentDidMount"</span>,</span><br><span class="line">            value: <span class="function"><span class="keyword">function</span> <span class="title">componentDidMount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'component did mount'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            key: <span class="string">"render"</span>,</span><br><span class="line">            value: <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> _react[<span class="string">"default"</span>].createElement(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="keyword">this</span>.state.name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> App;</span><br><span class="line">    &#125;(_react[<span class="string">"default"</span>].Component);</span><br><span class="line"></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">_reactDom[<span class="string">"default"</span>].render(_react[<span class="string">"default"</span>].createElement(App, <span class="literal">null</span>), <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯ <code>var App</code> å¼€å§‹çš„ä¸œè¥¿ï¼Œå¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°æ˜¯<code>React.Componnet</code>ï¼Œå‡½æ•°å†…éƒ¨å†™äº†ä¸€ä¸ªåä¸º<code>App</code>çš„æ„é€ å‡½æ•°ï¼Œæœ€åè¿”å›å‡ºè¿™ä¸ªæ„é€ å‡½æ•°ã€‚</p><p>å…¶ä¸­çš„<code>_inherits(App, _React$Component);</code>è¿™ä¸ªå‡½æ•°æ˜¯<code>babel</code>è‡ªè¡Œå°è£…çš„ç»§æ‰¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">_createClass(App, [&#123;</span><br><span class="line">    key: <span class="string">"componentDidMount"</span>,</span><br><span class="line">    value: <span class="function"><span class="keyword">function</span> <span class="title">componentDidMount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'component did mount'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    key: <span class="string">"render"</span>,</span><br><span class="line">    value: <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> _react[<span class="string">"default"</span>].createElement(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="keyword">this</span>.state.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯å°†ç¬¬äºŒä¸ªå‚æ•°é‚£ä¸ªæ•°ç»„ä¸­çš„ä¸œè¥¿ä¸€ä¸ªä¸€ä¸ªæ·»åŠ åˆ°æ„é€ <code>App</code>æ„é€ å‡½æ•°çš„åŸå‹é“¾ä¸Šã€‚</p><p>æœ€åè°ƒç”¨<code>ReactDOM</code>çš„<code>render</code>æ–¹æ³•ï¼Œå¯ä»¥çœ‹å‡ºè¿™å…¶ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è°ƒç”¨äº†<code>React.createElement</code>æ–¹æ³•ï¼ŒåŒ…æ‹¬åœ¨Appç»„ä»¶ä¸­çš„renderä¹Ÿæ˜¯è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ã€‚é‚£ä¹ˆé‡ç‚¹æ¥äº†ï¼Œçœ‹ä¸€ä¸‹è¿™ä¸ª<code>React.createElement</code>æ–¹æ³•</p><h2 id="React-createElement"><a href="#React-createElement" class="headerlink" title="React.createElement"></a>React.createElement</h2><p>å¤§å®¶éƒ½çŸ¥é“ï¼ŒReactä¸­çš„ä¸€ä¸ªå…³é”®è¯å°±æ˜¯<code>jsx</code>ï¼Œbabelåœ¨è§£æjsxè¯­æ³•æ—¶ï¼Œå°±ä¼šè°ƒç”¨<code>React.createElement</code>æ–¹æ³•å°†jsxè½¬æ¢ä¸ºä¸€ä¸ª<code>ReactElement</code>å¯¹è±¡ã€‚åœ¨æºç <code>/packages/react/src/ReactElement.js</code>æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Create and return a new ReactElement of the given type.</span></span><br><span class="line"><span class="comment"> * See https://reactjs.org/docs/react-api.html#createelement</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> createElement(<span class="keyword">type</span>, <span class="keyword">config</span>, children) &#123;</span><br><span class="line">  <span class="keyword">let</span> propName;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Reserved names are extracted</span></span><br><span class="line">  <span class="keyword">const</span> props = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> key = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">ref</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> self = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">let</span> source = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å°† config ä¸­çš„é…ç½®æ·»åŠ åˆ° props ä¸­</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">config</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hasValidRef(<span class="keyword">config</span>)) &#123;</span><br><span class="line">      <span class="keyword">ref</span> = <span class="keyword">config</span><span class="variable">.ref</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hasValidKey(<span class="keyword">config</span>)) &#123;</span><br><span class="line">      key = '' + <span class="keyword">config</span><span class="variable">.key</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    self = <span class="keyword">config</span><span class="variable">.__self</span> === undefined ? <span class="literal">null</span> : <span class="keyword">config</span><span class="variable">.__self</span>;</span><br><span class="line">    source = <span class="keyword">config</span><span class="variable">.__source</span> === undefined ? <span class="literal">null</span> : <span class="keyword">config</span><span class="variable">.__source</span>;</span><br><span class="line">    <span class="comment">// Remaining properties are added to a new props object</span></span><br><span class="line">    <span class="keyword">for</span> (propName in <span class="keyword">config</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        hasOwnProperty<span class="variable">.call</span>(<span class="keyword">config</span>, propName) &amp;&amp;</span><br><span class="line">        !RESERVED_PROPS<span class="variable">.hasOwnProperty</span>(propName)</span><br><span class="line">      ) &#123;</span><br><span class="line">        props[propName] = <span class="keyword">config</span>[propName];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ·»åŠ å­èŠ‚ç‚¹</span></span><br><span class="line">  <span class="comment">// Children can be more than one argument, and those are transferred onto</span></span><br><span class="line">  <span class="comment">// the newly allocated props object.</span></span><br><span class="line">  <span class="keyword">const</span> childrenLength = arguments<span class="variable">.length</span> - <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123;</span><br><span class="line">    props<span class="variable">.children</span> = children;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> childArray = Array(childrenLength);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; childrenLength; i++) &#123;</span><br><span class="line">      childArray[i] = arguments[i + <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">__</span>DEV__) &#123;</span><br><span class="line">      <span class="keyword">if</span> (Object<span class="variable">.freeze</span>) &#123;</span><br><span class="line">        Object<span class="variable">.freeze</span>(childArray);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    props<span class="variable">.children</span> = childArray;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Resolve default props</span></span><br><span class="line">  <span class="comment">// æ·»åŠ é»˜è®¤çš„props</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">type</span> &amp;&amp; <span class="keyword">type</span><span class="variable">.defaultProps</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> defaultProps = <span class="keyword">type</span><span class="variable">.defaultProps</span>;</span><br><span class="line">    <span class="keyword">for</span> (propName in defaultProps) &#123;</span><br><span class="line">      <span class="keyword">if</span> (props[propName] === undefined) &#123;</span><br><span class="line">        props[propName] = defaultProps[propName];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="number">__</span>DEV__) &#123;</span><br><span class="line">    <span class="comment">/**/</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ReactElement(</span><br><span class="line">    <span class="keyword">type</span>,</span><br><span class="line">    key,</span><br><span class="line">    <span class="keyword">ref</span>,</span><br><span class="line">    self,</span><br><span class="line">    source,</span><br><span class="line">    ReactCurrentOwner<span class="variable">.current</span>,</span><br><span class="line">    props,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">config</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (hasValidRef(<span class="keyword">config</span>)) &#123;</span><br><span class="line">    <span class="keyword">ref</span> = <span class="keyword">config</span><span class="variable">.ref</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (hasValidKey(<span class="keyword">config</span>)) &#123;</span><br><span class="line">    key = '' + <span class="keyword">config</span><span class="variable">.key</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  self = <span class="keyword">config</span><span class="variable">.__self</span> === undefined ? <span class="literal">null</span> : <span class="keyword">config</span><span class="variable">.__self</span>;</span><br><span class="line">  source = <span class="keyword">config</span><span class="variable">.__source</span> === undefined ? <span class="literal">null</span> : <span class="keyword">config</span><span class="variable">.__source</span>;</span><br><span class="line">  <span class="comment">// Remaining properties are added to a new props object</span></span><br><span class="line">  <span class="keyword">for</span> (propName in <span class="keyword">config</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      hasOwnProperty<span class="variable">.call</span>(<span class="keyword">config</span>, propName) &amp;&amp;</span><br><span class="line">      !RESERVED_PROPS<span class="variable">.hasOwnProperty</span>(propName)</span><br><span class="line">    ) &#123;</span><br><span class="line">      props[propName] = <span class="keyword">config</span>[propName];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å°†ä¼ å…¥çš„<code>config</code>å‚æ•°æ·»åŠ åˆ°<code>props</code>ä¸­.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> childrenLength = <span class="built_in">arguments</span>.length - <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123;</span><br><span class="line">  props.children = children;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> childArray = <span class="built_in">Array</span>(childrenLength);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; childrenLength; i++) &#123;</span><br><span class="line">    childArray[i] = <span class="built_in">arguments</span>[i + <span class="number">2</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Object</span>.freeze) &#123;</span><br><span class="line">      <span class="built_in">Object</span>.freeze(childArray);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  props.children = childArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>arguments</code>æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œå­˜å‚¨ç€å‡½æ•°çš„å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›åŸºæœ¬çš„æ•°ç»„apiä½†æ˜¯ä»–æœ¬è´¨ä¸Šä¸æ˜¯ä¸€ä¸ªæ•°ç»„è€Œæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ä½¿ç”¨<code>arguments.length - 2</code>é™¤å»å‰ä¸¤ä¸ªå‚æ•°å‰©ä¸‹çš„å°±éƒ½æ˜¯å­èŠ‚ç‚¹äº†ã€‚è¿™è¾¹å¯¹æ•°ç»„çš„é•¿åº¦è¿›è¡Œäº†åˆ¤æ–­ï¼Œå¯ä»¥å‘ç°åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„æ—¶å€™<code>props.children</code>å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¤šä¸ªå­èŠ‚ç‚¹æ—¶ï¼Œå€¼ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¸Šé¢çš„é‚£ä¸ªä¾‹å­ä½“ç°ä¸å‡ºè¿™ä¸ªï¼Œæ¢æˆä¸‹é¢çš„ä¾‹å­ç„¶ååœ¨babelä¸€ä¸‹å°±å¯ä»¥çœ‹å‡ºè¿™ä¸ªå‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ ä¸€ä¸ªdivèŠ‚ç‚¹</span></span><br><span class="line">ReactDom.render(</span><br><span class="line">    &lt;App&gt;</span><br><span class="line">        &lt;div&gt;Hello World&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>App&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">// è½¬æ¢æˆbabelä¹‹åçš„ç»“æœ</span></span><br><span class="line">_reactDom[<span class="string">"default"</span>].render(</span><br><span class="line">    _react[<span class="string">"default"</span>].createElement(</span><br><span class="line">        App,</span><br><span class="line">        <span class="literal">null</span>,</span><br><span class="line">        _react[<span class="string">"default"</span>].createElement(<span class="string">"div"</span>, <span class="literal">null</span>, <span class="string">"Hello World"</span>)</span><br><span class="line">    ),</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>è¿™è¾¹å¯ä»¥çœ‹å‡ºåˆæ–°åŠ äº†ä¸€ä¸ª<code>createElement</code>ã€‚</p><p>è§£æå®Œchildrenä¹‹åï¼Œæ·»åŠ è¿›<code>props</code>å¯¹è±¡é‡Œï¼Œåœ¨å¾€ä¸‹èµ°ï¼Œ</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">type</span> &amp;&amp; <span class="keyword">type</span>.defaultProps) &#123;</span><br><span class="line">  <span class="keyword">const</span> defaultProps = <span class="keyword">type</span>.defaultProps;</span><br><span class="line">  <span class="keyword">for</span> (propName <span class="keyword">in</span> defaultProps) &#123;</span><br><span class="line">    <span class="keyword">if</span> (props[propName] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      props[propName] = defaultProps[propName];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€å—æ˜¯æ¥è§£æ<code>defaultProps</code></p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> ReactElement(</span><br><span class="line"><span class="built_in">    type,</span></span><br><span class="line"><span class="built_in">    key,</span></span><br><span class="line"><span class="built_in">    ref,</span></span><br><span class="line"><span class="built_in">    self,</span></span><br><span class="line"><span class="built_in">    source,</span></span><br><span class="line">    ReactCurrentOwner.current,</span><br><span class="line"><span class="built_in">    props,</span></span><br><span class="line">  )<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>æœ€ç»ˆè¿™ä¸ª<code>createElement</code>æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª<code>ReactElement</code>å¯¹è±¡ã€‚</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ReactElement = <span class="keyword">function</span>(<span class="keyword">type</span>, key, <span class="keyword">ref</span>, self, source, owner, props) &#123;</span><br><span class="line">  <span class="keyword">const</span> element = &#123;</span><br><span class="line">    <span class="comment">// This tag allows us to uniquely identify this as a React Element</span></span><br><span class="line">    <span class="comment">// ç‹¬ç‰¹çš„å”¯ä¸€æ ‡ç¤º è¡¨æ˜è¿™ä¸€ä¸ªreactå…ƒç´ </span></span><br><span class="line">    $$typeof: REACT_ELEMENT_TYPE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Built-in properties that belong on the element</span></span><br><span class="line">    <span class="keyword">type</span>: <span class="keyword">type</span>,</span><br><span class="line">    key: key,</span><br><span class="line">    <span class="keyword">ref</span>: <span class="keyword">ref</span>,</span><br><span class="line">    props: props,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Record the component responsible for creating this element.</span></span><br><span class="line">    <span class="comment">// è®°å½•è´Ÿè´£åˆ›å»ºæ­¤èŠ‚ç‚¹çš„ç»„ä»¶</span></span><br><span class="line">    <span class="number">_</span>owner: owner,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="number">__</span>DEV__) &#123;</span><br><span class="line">    <span class="comment">/**/</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> element;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿”å›ä¸€ä¸ªelementå¯¹è±¡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™è¾¹æœ‰ä¸€ä¸ªæ ‡ç¤ºç¬¦<code>$$typeof</code>ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªReact.Elementå¯¹è±¡ï¼Œæºç ä¸­åœ¨è‹±æ–‡æ³¨é‡Š</p><blockquote><p>  Factory method to create a new React element. This no longer adheres to<br> the class pattern, so do not use new to call it. Also, no instanceof check<br>  will work. Instead test $$typeof field against Symbol.for(â€˜react.elementâ€™) to check<br>  if something is a React Element.</p></blockquote><p>å¤§æ¦‚æ„æ€å°±æ˜¯è¯´ä»¥åä¸åœ¨åšæŒä½¿ç”¨classæ¥åˆ›å»ºäº†ï¼Œæ‰€ä»¥ä¸è¦newè°ƒç”¨å®ƒï¼ŒåŒæ ·çš„instancofä¹Ÿæ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä½¿ç”¨ä¸€ä¸ªæ ‡è¯†ç¬¦<code>$$typeof</code>å€¼ä¸ºä¸€ä¸ªsybmolå¯¹è±¡<code>Symbol.for(&#39;react.element&#39;)</code></p><p>åœ¨è¿™ä¸ªæ–‡ä»¶çš„ä¸‹æ–¹è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ç”¨æ¥æ ¡éªŒä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯<code>React.Element</code></p><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * <span class="type">Verifies</span> the <span class="keyword">object</span> <span class="keyword">is</span> a <span class="type">ReactElement</span>.</span><br><span class="line"> * <span class="type">See</span> https://reactjs.org/docs/react-api.html<span class="comment">#isvalidelement</span></span><br><span class="line"> * @param &#123;?<span class="keyword">object</span>&#125; <span class="keyword">object</span></span><br><span class="line"> * @<span class="keyword">return</span> &#123;boolean&#125; <span class="type">True</span> <span class="keyword">if</span> `<span class="keyword">object</span>` <span class="keyword">is</span> a <span class="type">ReactElement</span>.</span><br><span class="line"> * @final</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">export</span> function isValidElement(<span class="keyword">object</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    typeof <span class="keyword">object</span> === '<span class="keyword">object</span>' &amp;&amp;</span><br><span class="line">    <span class="keyword">object</span> !== null &amp;&amp;</span><br><span class="line">    <span class="keyword">object</span>.$$typeof === <span class="type">REACT_ELEMENT_TYPE</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ¯”å¯¹çš„<code>$$typeof</code>å±æ€§</p><h2 id="Component-PureComponent"><a href="#Component-PureComponent" class="headerlink" title="Component PureComponent"></a>Component PureComponent</h2><p>å†™ä¸€ä¸ªReactç»„ä»¶æ—¶ï¼Œéœ€è¦ç»§æ‰¿<code>React.Component</code>ï¼Œè€Œ<code>PureComponent</code>å’Œ<code>Component</code>çš„åŒºåˆ«åœ¨äºï¼Œä½¿ç”¨<code>PureComponent</code>å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼˜åŒ–<code>React</code>çš„æ€§èƒ½ï¼Œå› ä¸º<code>PureComponent</code>å†…éƒ¨æ˜¯å¯¹<code>preProps nextProps</code>åšäº†æµ…å¯¹æ¯”ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function Component(props, context, updater) &#123;</span><br><span class="line">  <span class="keyword">this</span>.props = props;</span><br><span class="line">  <span class="keyword">this</span>.context = context;</span><br><span class="line">  <span class="comment">// If a component has string refs, we will assign a different object later.</span></span><br><span class="line">  <span class="keyword">this</span>.refs = emptyObject;</span><br><span class="line">  <span class="comment">// We initialize the default updater but the real one gets injected by the</span></span><br><span class="line">  <span class="comment">// renderer.</span></span><br><span class="line">  <span class="keyword">this</span>.updater = updater || ReactNoopUpdateQueue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™è¾¹ä¸»è¦æ˜¯<code>updater</code>æœ‰ä¸€ä¸ªæ›´æ–°é˜Ÿåˆ—çš„ä¸œè¥¿ï¼Œä¸‹æ¬¡å†è¯´ï¼Œä¹‹ååœ¨<code>Component</code>çš„åŸå‹ä¸Šé™„åŠ ä¸€ç³»åˆ—çš„æ–¹æ³•ã€‚è€Œ<code>PureComponent</code>æ˜¯ç»§æ‰¿çš„<code>Component</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PureComponent</span>(<span class="params">props, context, updater</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.props = props;</span><br><span class="line">  <span class="keyword">this</span>.context = context;</span><br><span class="line">  <span class="comment">// If a component has string refs, we will assign a different object later.</span></span><br><span class="line">  <span class="keyword">this</span>.refs = emptyObject;</span><br><span class="line">  <span class="keyword">this</span>.updater = updater || ReactNoopUpdateQueue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pureComponentPrototype = (PureComponent.prototype = <span class="keyword">new</span> ComponentDummy());</span><br><span class="line">pureComponentPrototype.constructor = PureComponent;</span><br><span class="line"><span class="comment">// Avoid an extra prototype jump for these methods.</span></span><br><span class="line"><span class="built_in">Object</span>.assign(pureComponentPrototype, Component.prototype);</span><br><span class="line">pureComponentPrototype.isPureReactComponent = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>ä¸åŒçš„åœ°æ–¹åœ¨äº<code>PureComponent</code>æ·»åŠ äº†ä¸€ä¸ªå±æ€§ç”¨æ¥è¡¨è¯†è¯¥å®ä¾‹æ˜¯ä¸€ä¸ª<code>PureComponent</code><br><code>pureComponentPrototype.isPureReactComponent = true;</code></p><p>ä¸‹ä¸€ç¯‡åº”è¯¥æ˜¯è®°å½•<code>ReactDom.render</code>æ–¹æ³•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æºç  </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Reactæºç è§£æ----APIæ¦‚è§ˆ + React.Children è§£æ</title>
      <link href="/2019/09/15/React%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90----API%E6%A6%82%E8%A7%88%20+%20React.Children%20%E8%A7%A3%E6%9E%90/"/>
      <url>/2019/09/15/React%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90----API%E6%A6%82%E8%A7%88%20+%20React.Children%20%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ€è¿‘é—²æ¥æ— äº‹ï¼Œç ”ç©¶ä¸€æ³¢Reactæºç ï¼Œä¸€å¼€å§‹æ˜¯ä»¥Vueæºç èµ·æ­¥çš„ï¼Œç»“æœå‘ç°æˆ‘å¯¹Vueå®åœ¨æ˜¯ä¸ç†Ÿæ‚‰ï¼Œçœ‹Vueæºç è¿˜ä¸å¤Ÿæ ¼ï¼Œç›¸æ¯”è€Œè¨€ï¼Œæˆ‘æ›´å–œæ¬¢Reactï¼Œå¯èƒ½æ˜¯å› ä¸ºç¬¬ä¸€ä¸ªå­¦çš„æ¡†æ¶å­¦çš„å°±æ˜¯Reactï¼Œæ‰€ä»¥å¯¹Reactæ›´åŠ çš„å……æ»¡çƒ­æƒ…ï¼Œä¹Ÿæ›´åŠ çš„ç†Ÿç»ƒï¼Œä¸ªäººè§‚ç‚¹ï¼ŒReactè¿˜æ˜¯è¦æ¯”Vueç‰›é€¼ä¸€ç‚¹å¥½çœ‹ä¸€ç‚¹çš„ã€‚</p><p>Reactæœ¬èº«çš„æºç æ˜¯å¾ˆå°‘çš„ï¼Œæ ¹æ®æ‰“åŒ…å‡ºæ¥çš„Commonjsç‰ˆæœ¬çœ‹æ¥ï¼ŒReactåªæœ‰ä¸¤åƒå¤šè¡Œä»£ç ï¼Œä½†æ˜¯ReactDomæ®è¯´æœ‰ä¸¤ä¸‡å¤šè¡Œï¼Œæ¡†æ¶å¼€å‘è€…å®å±ä¼Ÿå¤§ï¼è‡´æ•¬ï¼ï¼ï¼</p><p>é‚£ä¹ˆè¿™ä¸€ç¯‡æ˜¯Reactä¸€äº›é€šç”¨çš„APIæ¦‚å†µå’ŒReact.Childrenæ–¹æ³•çš„è§£æï¼Œå¦‚æœ‰ä¸åˆ°ä½æˆ–é”™è¯¯çš„åœ°æ–¹æ¬¢è¿æŒ‡æ•™ï¼Œæˆ‘çš„é‚®ç®± <a href="mailto:1103107216@qq.com" target="_blank" rel="noopener">1103107216@qq.com</a> æ‚¨ä¹Ÿå¯ä»¥ä¸‹æ–¹è¯„è®ºã€‚</p></blockquote><h2 id="Reactæºç è·å–"><a href="#Reactæºç è·å–" class="headerlink" title="Reactæºç è·å–"></a>Reactæºç è·å–</h2><p>æˆ‘å‘ç°æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§å‘¢å°±æ˜¯ä»<code>github</code>ä¸Šæ‹‰å–<code>react</code>é¡¹ç›®çš„æºç ï¼Œgithubåœ°å€å¤§å®¶å¯ä»¥è‡ªå·±æ‰¾ï¼Œ<code>git clone</code>ä¸‹æ¥ä¹‹åï¼Œåœ¨<code>/packages/react</code>ä¸‹é¢å°±æ˜¯<code>react</code>çš„æºç äº†ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢æ˜¯åˆ†æˆäº†å¾ˆå¤šä¸ªå°æ–‡ä»¶çš„ï¼Œè¿™ä¸ªæˆ‘ä¸€èˆ¬ç”¨æ¥çœ‹çš„ä¸æ˜¯ç”¨æ¥è°ƒè¯•çš„ã€‚</p><p>å¦ä¸€ä¸ªå‘¢å°±æ˜¯å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå®‰è£…ä¸€ä¸‹<code>cnpm i react react-dom -S</code>ä¹‹ååœ¨<code>node_modules</code>é‡Œé¢æ‰¾åˆ°<code>react</code>çš„æºç ï¼Œå»ºä¸€ä¸ªé¡¹ç›®ï¼Œç”¨<code>webpack</code>æ‰“åŒ…ï¼Œè£…ä¸ª<code>babel</code>ä¸€å¥—ï¼Œæ¯•ç«Ÿes6æ¯”es5å¥½ä½¿å¤šäº†ï¼Œå¼€ä¸ªçƒ­æ›´æ–°ï¼Œä¹‹åå°±ç›´æ¥ä¿®æ”¹è¿™ä¸ª<code>node_modules</code>é‡Œé¢çš„æºç è¿›è¡Œæ‰“å°è°ƒè¯•äº†ï¼Œæˆ‘ä¸ªäººå–œæ¬¢<code>console.log</code>ä¸è§£é‡Šï¼Œåªæœ‰åœ¨è°ƒè¯•ä¸€äº›ç®—æ³•é—®é¢˜æ—¶æˆ‘æ‰ä¼šå¼€Debugæ¨¡å¼ã€‚</p><a id="more"></a><h2 id="é€šç”¨API"><a href="#é€šç”¨API" class="headerlink" title="é€šç”¨API"></a>é€šç”¨API</h2><p>é¦–å…ˆå…ˆæ¥ä¸€ä¸ªç®€å•çš„ React åº”ç”¨,è¿™è¾¹ä½¿ç”¨es6çš„classå†™æ³•ï¼Œä¸ªäººå»ºè®®å¤šç»ƒç»ƒå‡½æ•°å¼ç¼–ç¨‹ï¼Œå†™å‡½æ•°ç»„ä»¶æ¯”å†™classèˆ’æœå¤šäº†ï¼Œæ¯•ç«ŸReact16æä¾›äº†è¿™ä¹ˆå¤šå¼ºå¤§çš„Hook</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">React</span> from <span class="symbol">'reac</span>t';</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                <span class="type">Hello</span> <span class="type">World</span></span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OK, Hello World è‡´æ•¬ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å¹²æ´»äº†ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹Reactçš„æºç ï¼Œåœ¨<code>/packages/react/src/React.js</code>è¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå¯ä»¥çœ‹åˆ°Reactçš„å®šä¹‰ï¼Œä½ ä¼šå‘ç°å’ŒVueçš„æºç å¾ˆä¸ä¸€æ ·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æ›´å–œæ¬¢Reactçš„åŸå› ï¼Œæ…¢æ…¢çš„äº²åˆ‡æ„Ÿã€‚</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">const React = &#123;</span><br><span class="line"><span class="symbol">  Children:</span> &#123;</span><br><span class="line"><span class="built_in">    map,</span></span><br><span class="line"><span class="built_in">    forEach,</span></span><br><span class="line"><span class="built_in">    count,</span></span><br><span class="line"><span class="built_in">    toArray,</span></span><br><span class="line"><span class="built_in">    only,</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"><span class="built_in">  createRef,</span></span><br><span class="line"><span class="built_in">  Component,</span></span><br><span class="line"><span class="built_in">  PureComponent,</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">  createContext,</span></span><br><span class="line"><span class="built_in">  forwardRef,</span></span><br><span class="line"><span class="built_in">  lazy,</span></span><br><span class="line"><span class="built_in">  memo,</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">  useCallback,</span></span><br><span class="line"><span class="built_in">  useContext,</span></span><br><span class="line"><span class="built_in">  useEffect,</span></span><br><span class="line"><span class="built_in">  useImperativeHandle,</span></span><br><span class="line"><span class="built_in">  useDebugValue,</span></span><br><span class="line"><span class="built_in">  useLayoutEffect,</span></span><br><span class="line"><span class="built_in">  useMemo,</span></span><br><span class="line"><span class="built_in">  useReducer,</span></span><br><span class="line"><span class="built_in">  useRef,</span></span><br><span class="line"><span class="built_in">  useState,</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">  Fragment:</span> REACT_FRAGMENT_TYPE,</span><br><span class="line"><span class="symbol">  StrictMode:</span> REACT_STRICT_MODE_TYPE,</span><br><span class="line"><span class="symbol">  Suspense:</span> REACT_SUSPENSE_TYPE,</span><br><span class="line"></span><br><span class="line"><span class="symbol">  createElement: __DEV__ ? createElementWithValidation :</span> createElement,</span><br><span class="line"><span class="symbol">  cloneElement: __DEV__ ? cloneElementWithValidation :</span> cloneElement,</span><br><span class="line"><span class="symbol">  createFactory: __DEV__ ? createFactoryWithValidation :</span> createFactory,</span><br><span class="line"><span class="symbol">  isValidElement:</span> isValidElement,</span><br><span class="line"></span><br><span class="line"><span class="symbol">  version:</span> ReactVersion,</span><br><span class="line"></span><br><span class="line"><span class="symbol">  unstable_ConcurrentMode:</span> REACT_CONCURRENT_MODE_TYPE,</span><br><span class="line"><span class="symbol">  unstable_Profiler:</span> REACT_PROFILER_TYPE,</span><br><span class="line">  // è¿™ä¸€è¡Œè·³è¿‡</span><br><span class="line"><span class="symbol">  __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:</span> ReactSharedInternals,</span><br><span class="line">&#125;<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>è¿™è¾¹å®šä¹‰äº†Reacté‡Œé¢çš„æ‰€æœ‰çš„é€šç”¨æ–¹æ³•ï¼Œè¿™è¾¹åªåšä¸€ä¸ªæ¦‚è§ˆï¼Œæ¯ä¸€ä¸ªå…·ä½“çš„ç”¨å¤„ä¼šåœ¨åé¢è¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚</p><h3 id="Children"><a href="#Children" class="headerlink" title="Children"></a>Children</h3><p>è¿™ä¸ªé‡Œé¢å°è£…çš„æ˜¯å¯¹ä¸€ä¸ªç»„ä»¶çš„å­ç»„ä»¶è¿›è¡Œéå†ç­‰çš„ä¸€äº›æ“ä½œï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç”¨åˆ°ï¼Œè®²çœŸæˆ‘é™¤äº†çœ‹æºç ä¼šç”¨ä»–æ¥è¯•ä¸€è¯•å…¶ä»–çš„çœŸæ²¡è§åˆ°æœ‰äººç”¨å®ƒã€‚</p><ul><li><p>forEach,map ç±»ä¼¼äºæ•°ç»„çš„éå†å¯¹è±¡éå†å•¥çš„</p></li><li><p>count ç”¨æ¥è®¡ç®—å­ç»„ä»¶çš„æ•°é‡</p></li><li><p>only å®˜æ–¹è§£é‡Šï¼šéªŒè¯ children æ˜¯å¦åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼ˆä¸€ä¸ª React å…ƒç´ ï¼‰ï¼Œå¦‚æœæœ‰åˆ™è¿”å›å®ƒï¼Œå¦åˆ™æ­¤æ–¹æ³•ä¼šæŠ›å‡ºé”™è¯¯ã€‚ Tipsï¼šä¸å¯ä»¥ä½¿ç”¨<code>React.Children.map</code>æ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºå‚æ•°ï¼Œå› ä¸ºmapçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°ç»„è€Œä¸æ˜¯ä¸€ä¸ªReactå…ƒç´ </p></li><li><p>toArray å°†ChildrenæŒ‰ç…§æ•°ç»„çš„å½¢å¼æ‰å¹³å±•å¼€å¹¶è¿”å›</p></li></ul><p>æä¸æ‡‚æ²¡å…³ç³»ï¼Œåé¢ä¼šä»‹ç»ï¼Œæœ‰ä¸€ä¸ªå°è±¡å°±å¥½</p><h3 id="createRef"><a href="#createRef" class="headerlink" title="createRef"></a>createRef</h3><p>ref å±æ€§æ˜¯åœ¨å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„ï¼Œè¯´ç™½äº†å°±æ˜¯ç”¨æ¥è·å–çœŸå®Domçš„ï¼Œæ–°ç‰ˆçš„Reactä¸­ä½¿ç”¨refçš„æ“ä½œä¹Ÿå˜äº†</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.inputRef = <span class="type">React</span>.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿™æ˜¯ä¸€ç§</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"text"</span> ref=&#123;<span class="keyword">this</span>.inputRef&#125; /&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// è¿™æ˜¯å¦å¤–ä¸€ç§</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"text"</span> ref=&#123;node =&gt; <span class="keyword">this</span>.inputRef = node&#125;&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Component-PureComponent"><a href="#Component-PureComponent" class="headerlink" title="Component, PureComponent"></a>Component, PureComponent</h3><p>è¿™ä¸¤ä¸ªå¤§å®¶åº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰ï¼Œåˆ›å»ºä¸€ä¸ªReactç»„ä»¶ï¼ŒPureComponentåœ¨åˆ¤æ–­ç»„ä»¶æ˜¯å¦æ”¹æ›´æ–°çš„æ—¶å€™æ›´åŠ çš„æ–¹ä¾¿ã€‚</p><h3 id="createContext"><a href="#createContext" class="headerlink" title="createContext"></a>createContext</h3><p>åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œè¿”å›ä¸€ä¸ª<code>Context</code>å¯¹è±¡ï¼Œé‡Œé¢åŒ…å«äº†<code>Providerï¼ŒConsumer</code>å±æ€§ï¼Œä¸€èˆ¬ç”¨æ¥å¾€ç»„ä»¶æ ‘çš„æ›´æ·±å¤„ä¼ é€’æ•°æ®ï¼Œé¿å…ä¸€ä¸ªç»„ä»¶ä¸€ä¸ªç»„ä»¶çš„å¾€ä¸‹ä¼ ï¼Œä¸æ–¹ä¾¿è§£è—•</p><h3 id="forwardRef"><a href="#forwardRef" class="headerlink" title="forwardRef"></a>forwardRef</h3><p>åˆ›å»ºä¸€ä¸ªReactç»„ä»¶,è¿™ä¸ªç»„ä»¶èƒ½å¤Ÿå°†å…¶æ¥å—çš„ ref å±æ€§è½¬å‘åˆ°å…¶ç»„ä»¶æ ‘ä¸‹çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­.<code>React.forwardRef</code> æ¥å—æ¸²æŸ“å‡½æ•°ä½œä¸ºå‚æ•°ã€‚React å°†ä½¿ç”¨ props å’Œ ref ä½œä¸ºå‚æ•°æ¥è°ƒç”¨æ­¤å‡½æ•°ã€‚æ­¤å‡½æ•°åº”è¿”å› React èŠ‚ç‚¹ã€‚</p><h3 id="lazy"><a href="#lazy" class="headerlink" title="lazy"></a>lazy</h3><p>ç»„ä»¶æ‡’åŠ è½½</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const SomeComponent = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./SomeComponent'</span>));</span><br></pre></td></tr></table></figure><h3 id="memo"><a href="#memo" class="headerlink" title="memo"></a>memo</h3><p>ç”¨æ¥åˆ›å»ºä¸€ä¸ªHOCçš„</p><h3 id="useStateâ€¦"><a href="#useStateâ€¦" class="headerlink" title="useStateâ€¦"></a>useStateâ€¦</h3><p>æ¥ä¸‹æ¥è¿™å‡ ä¸ªå°±æ˜¯React16å¤§åé¼é¼çš„Hookå‡½æ•°ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œå‡½æ•°å¼ç»„ä»¶çš„ç¦éŸ³ï¼Œäº²åˆ‡æ„Ÿå€è¶³</p><h3 id="Fragment-StrictMode-Suspense-unstable-ConcurrentMode-unstable-Profiler"><a href="#Fragment-StrictMode-Suspense-unstable-ConcurrentMode-unstable-Profiler" class="headerlink" title="Fragment StrictMode Suspense unstable_ConcurrentMode unstable_Profiler"></a>Fragment StrictMode Suspense unstable_ConcurrentMode unstable_Profiler</h3><p>è¿™å››ä¸ªéƒ½æ˜¯Reactæä¾›çš„ç»„ä»¶ï¼Œä½†ä»–ä»¬å‘¢å…¶å®éƒ½åªæ˜¯å ä½ç¬¦ï¼Œéƒ½æ˜¯ä¸€ä¸ªSymbolï¼Œåœ¨Reactå®é™…æ£€æµ‹åˆ°ä»–ä»¬çš„æ—¶å€™ä¼šåšä¸€äº›ç‰¹æ®Šçš„å¤„ç†ï¼Œæ¯”å¦‚StrictModeå’ŒAsyncModeä¼šè®©ä»–ä»¬çš„å­èŠ‚ç‚¹å¯¹åº”çš„Fiberçš„modeéƒ½å˜æˆå’Œä»–ä»¬ä¸€æ ·çš„mode</p><h3 id="createElement"><a href="#createElement" class="headerlink" title="createElement"></a>createElement</h3><p>createElement è¿™æ˜¯Reactä¸­æœ€é‡è¦çš„æ–¹æ³•äº†ï¼Œç”¨æ¥åˆ›å»º<code>ReactElement</code></p><h3 id="cloneElement"><a href="#cloneElement" class="headerlink" title="cloneElement"></a>cloneElement</h3><p>é¡¾åæ€ä¹‰ï¼Œå…‹éš†ä¸€ä¸ª<code>ReactElement</code></p><h3 id="createFactory"><a href="#createFactory" class="headerlink" title="createFactory"></a>createFactory</h3><p>åˆ›å»ºä¸€ä¸ªå·¥å‚ï¼Œè¿™ä¸ªå·¥å‚ä¸“é—¨ç”¨æ¥åˆ›å»ºæŸä¸€ç±»<code>ReactElement</code></p><h3 id="isValidElement"><a href="#isValidElement" class="headerlink" title="isValidElement"></a>isValidElement</h3><p>ç”¨æ¥æ£€æµ‹æ˜¯å¦æ˜¯ä¸€ä¸ª<code>ReactElement</code></p><h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><p>è®°å½•Reactçš„å½“å‰ç‰ˆæœ¬å·</p><h2 id="React-Children-è¯¦è§£"><a href="#React-Children-è¯¦è§£" class="headerlink" title="React.Children è¯¦è§£"></a>React.Children è¯¦è§£</h2><blockquote><p>React.Children æä¾›äº†ç”¨äºå¤„ç† this.props.children ä¸é€æ˜æ•°æ®ç»“æ„çš„å®ç”¨æ–¹æ³•ã€‚</p></blockquote><p>è¿™ä¸€éƒ¨åˆ†çš„ä»£ç åœ¨ <code>packages/react/react/src/ReactChildren.js</code>é‡Œé¢ï¼Œä¸»è¦åˆ†è£…äº†<code>forEach map count only toArray</code>ï¼Œå‰ä¸¤è€…ç”¨äºéå†Reach Childrenã€‚</p><ul><li><p><code>count</code> ç”¨äºè¿”å›è¯¥ç»„ä»¶çš„childrenæ•°é‡</p></li><li><p><code>only</code> ç”¨äºåˆ¤æ–­è¯¥ç»„ä»¶æ˜¯ä¸æ˜¯åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹</p></li><li><p><code>toArray</code> å°†React.Childrenä»¥æ‰å¹³çš„å½¢å¼è¿”å›å‡ºæ¥ï¼Œå¹¶é™„åŠ <code>key</code></p></li></ul><p>åœ¨<code>React</code>ä¸­ï¼Œä¸€æ®µæ–‡æœ¬å¯ä»¥è¢«ç§°ä¸ºä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œä¸€æ®µæ ‡ç­¾ä¹Ÿå¯ä»¥è¢«æˆä¸ºä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// Hello World</span></span><br><span class="line">        console.log(<span class="keyword">this</span>.props.children);</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ReactDom</span>.render(</span><br><span class="line">    &lt;<span class="type">App</span>&gt;</span><br><span class="line">        <span class="comment">// ä¸€æ®µæ–‡æœ¬ä¹Ÿæ˜¯ä¸€ä¸ªå­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">Hello</span> <span class="type">World</span></span><br><span class="line">    &lt;/<span class="type">App</span>&gt; ,</span><br><span class="line">    document.getElementById(<span class="symbol">'roo</span>t')</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// è¢«æ ‡è®°ä¸ºä¸€ä¸ªReact.Element</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.props.children);</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDom.render(</span><br><span class="line">    &lt;App&gt;</span><br><span class="line">        <span class="comment">// ä¸€æ®µæ ‡ç­¾ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­èŠ‚ç‚¹</span></span><br><span class="line">        &lt;div&gt;Hello World&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>App&gt; ,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå¦‚æœä¼ é€’çš„å­èŠ‚ç‚¹æ˜¯ä¸€æ®µhtmlæ ‡ç­¾ï¼Œé‚£ä¹ˆæ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š</p><p><img src="http://static.zybuluo.com/shenweizheng/s26qv0gdxzzh7z46ri153dqa/image_1dkp91mf4199d1kds1ul615rklpr9.png" alt="image_1dkp91mf4199d1kds1ul615rklpr9.png-36.3kB"></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨<code>App</code>ç»„ä»¶ä¸­æ˜¾ç¤ºæˆ‘ä»¬ä¼ é€’çš„è¿™ä¸ªChildren</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        console.log(<span class="keyword">this</span>.props.children);</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;&#123; <span class="keyword">this</span>.props.children &#125;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/3mo8ztspn32aw1yv80rj3rrr/image_1dkp98tod16gl3u91q614tj1a7jm.png" alt="image_1dkp98tod16gl3u91q614tj1a7jm.png-2.4kB"></p><p>å¦‚æœä¼ é€’çš„æ˜¯å¤šä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è§£ææˆä¸€ä¸ªæ•°ç»„</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">App</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello China<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">App</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/pgtbpsapbp5zibhv8w8v493t/image_1dkp9bfcjqb5ptn1dt02dm8lp13.png" alt="image_1dkp9bfcjqb5ptn1dt02dm8lp13.png-22.8kB"></p><p>é‚£ä¹ˆ<code>Reach.Children</code>çš„æ–¹æ³•åº”è¯¥å°±æ˜¯åœ¨è¿™é‡Œè¿›è¡Œä½¿ç”¨ï¼Œå› ä¸ºæˆ‘å®é™…ä¸Šä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œåšä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å°ä¸€ä¸‹<code>App</code>è¿™ä¸ªç»„ä»¶çš„å­èŠ‚ç‚¹ï¿½æ•°ï¼Œä½¿ç”¨<code>count</code>æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">// 2</span></span><br><span class="line">        <span class="built_in">console</span>.log(React.Children.count(<span class="keyword">this</span>.props.children));</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;&#123; <span class="keyword">this</span>.props.children &#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDom.render(</span></span><br><span class="line"><span class="regexp">    &lt;App&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div&gt;Hello World&lt;/</span>div&gt;</span><br><span class="line">        &lt;div&gt;Hello China&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>App&gt; ,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>è¿™è¾¹ä¼šæ‰“å°å‡ºæ¥ä¸€ä¸ª 2 å› ä¸ºæˆ‘ä»¬ä¼ é€’çš„æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹</p><p>ç¤ºä¾‹çœ‹å®Œäº†æˆ‘ä»¬å¯ä»¥æ¥åˆ†æä¸€ä¸‹æºç äº†ï¼Œä»‹ç»ä¸€ä¸‹<code>map</code>çš„æºç </p><p>æ‰¾åˆ°<code>ReactChildren.js</code>ï¼ˆè¿™æ˜¯åœ¨Reactæºç é‡Œï¼Œä¸æ˜¯åœ¨node_modulesé‡Œï¼‰ï¼Œæ‰¾åˆ°æœ€ä¸‹é¢æ¨¡å—å¯¼å‡ºè¯­å¥</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export &#123;</span><br><span class="line">  forEachChildren <span class="keyword">as</span> <span class="keyword">forEach</span>,</span><br><span class="line">  mapChildren <span class="keyword">as</span> map,</span><br><span class="line">  countChildren <span class="keyword">as</span> <span class="keyword">count</span>,</span><br><span class="line">  onlyChild <span class="keyword">as</span> only,</span><br><span class="line">  toArray,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°<code>map</code>æ˜¯<code>mapChildren</code>çš„ä¸€ä¸ªåˆ«åï¼Œä¸‹é¢æ‰¾åˆ°è¿™ä¸ªå‡½æ•°</p><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Maps children that are typically specified as `props.children`.</span><br><span class="line"> *</span><br><span class="line"> * See https://reactjs.org/docs/react-api.html<span class="comment">#reactchildrenmap</span></span><br><span class="line"> *</span><br><span class="line"> * The provided mapFunction(child, key, index) will be called for each</span><br><span class="line"> * leaf child.</span><br><span class="line"> *</span><br><span class="line"> * @<span class="keyword">param</span> &#123;?*&#125; <span class="keyword">children</span> <span class="keyword">Children</span> <span class="keyword">tree</span> <span class="keyword">container</span>.</span><br><span class="line"> * @<span class="keyword">param</span> &#123;function(*, int)&#125; <span class="keyword">func</span> <span class="keyword">The</span> <span class="keyword">map</span> <span class="keyword">function</span>.</span><br><span class="line"> * @<span class="keyword">param</span> &#123;*&#125; <span class="keyword">context</span> <span class="keyword">Context</span> <span class="keyword">for</span> <span class="keyword">mapFunction</span>.</span><br><span class="line"> * @<span class="keyword">return</span> &#123;object&#125; <span class="keyword">Object</span> <span class="keyword">containing</span> <span class="keyword">the</span> <span class="keyword">ordered</span> <span class="keyword">map</span> <span class="keyword">of</span> <span class="keyword">results</span>.</span><br><span class="line"> */</span><br><span class="line">function mapChildren(children, func, context) &#123;</span><br><span class="line">  if (children == null) &#123;</span><br><span class="line">    return children;</span><br><span class="line">  &#125;</span><br><span class="line">  const result = [];</span><br><span class="line">  mapIntoWithKeyPrefixInternal(children, result, null, func, context);</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬ä¼ é€’çš„<code>this.props.children</code>,ä¹Ÿæ˜¯å¿…é€‰å‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªfunctionï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä½¿ç”¨è¿™ä¸ªfunctionï¼Œè¿™ä¸ªfunctionæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå‚æ•°å°±æ˜¯å½“å‰éå†çš„èŠ‚ç‚¹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œä¸€èˆ¬ä¸ç”¨ä¼ ã€‚<br>å¯ä»¥çœ‹å‡ºé‡ç‚¹æ˜¯<code>mapIntoWithKeyPrefixInternal</code>è¿™ä¸ªæ–¹æ³•ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    constructor(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="type">React</span>.<span class="type">Children</span>.map(<span class="keyword">this</span>.props.children, (item) =&gt; &#123;</span><br><span class="line">            console.log(item);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;&#123; <span class="keyword">this</span>.props.children &#125;&lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function mapIntoWithKeyPrefixInternal(children, array, <span class="keyword">prefix</span>, <span class="function"><span class="keyword">func</span>, <span class="title">context</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¢«å¿½è§†çš„å‰ç¼€</span></span><br><span class="line">  <span class="keyword">let</span> escapedPrefix = '';</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">prefix</span> != null) &#123;</span><br><span class="line">    escapedPrefix = escapeUserProvidedKey(<span class="keyword">prefix</span>) + '/';</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// éå†ä¸Šä¸‹æ–‡</span></span><br><span class="line">  const traverseContext = getPooledTraverseContext(</span><br><span class="line">    array,</span><br><span class="line">    escapedPrefix,</span><br><span class="line">    <span class="function"><span class="keyword">func</span>,</span></span><br><span class="line"><span class="function">    <span class="title">context</span>,</span></span><br><span class="line"><span class="function">  );</span></span><br><span class="line"><span class="function">  <span class="title">traverseAllChildren</span><span class="params">(children, mapSingleChildIntoContext, traverseContext)</span></span>;</span><br><span class="line">  releaseTraverseContext(traverseContext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯è·å–ä¸€ä¸‹éå†çš„ä¸Šä¸‹æ–‡ï¼Œè¿™ä¸ªåœ¨åé¢çš„æ–¹æ³•åº”è¯¥ä¼šç”¨åˆ°ï¼Œä¸‹é¢å°±æ˜¯å¼€å§‹éå†æ‰€æœ‰çš„Childrenäº†ï¼Œé‡ç‚¹æ˜¯<code>traverseAllChildren(children, mapSingleChildIntoContext, traverseContext);</code>ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¥½ç†è§£å°±æ˜¯æˆ‘ä»¬ä¼ é€’çš„<code>this.props.children</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯å‰é¢è·å–åˆ°çš„éå†ä¸Šä¸‹æ–‡ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ª<code>getPooledTraverseContext</code>æ–¹æ³•</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> POOL_SIZE = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> traverseContextPool = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPooledTraverseContext</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  mapResult,</span></span></span><br><span class="line"><span class="function"><span class="params">  keyPrefix,</span></span></span><br><span class="line"><span class="function"><span class="params">  mapFunction,</span></span></span><br><span class="line"><span class="function"><span class="params">  mapContext,</span></span></span><br><span class="line"><span class="function"><span class="params">)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (traverseContextPool.length) &#123;</span><br><span class="line">    <span class="keyword">const</span> traverseContext = traverseContextPool.pop();</span><br><span class="line">    traverseContext.result = mapResult;</span><br><span class="line">    traverseContext.keyPrefix = keyPrefix;</span><br><span class="line">    traverseContext.func = mapFunction;</span><br><span class="line">    traverseContext.context = mapContext;</span><br><span class="line">    traverseContext.count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> traverseContext;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      result: mapResult,</span><br><span class="line">      keyPrefix: keyPrefix,</span><br><span class="line">      func: mapFunction,</span><br><span class="line">      context: mapContext,</span><br><span class="line">      count: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨äº†ä¸€ä¸ªé—­åŒ…ï¼Œå¤–å±‚æœ‰ä¸€ä¸ª<code>traverseContextPool</code>è®°å½•è€…éå†ä¸Šä¸‹æ–‡çš„ä¸€ä¸ª<code>pool</code>ï¼Œæˆ‘è„‘æµ·ä¸­è¹¦å‡ºæ¥çš„è¯æ˜¯è¿æ¥æ± ï¼Œæ‰€ä»¥æš‚ä¸”å°±è¿™ä¹ˆç†è§£ä»–ï¼Œè¿™ä¸ªè¿æ¥æ± çš„å®¹é‡ä¸º10ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥æ± é‡Œæœ‰ä¸œè¥¿çš„è¯ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª<code>traverseContextPool.length !== 0</code>çš„è¯ï¼Œé‚£ä¹ˆä¼šå¼¹å‡ºæœ€åä¸€ä¸ªè¿›è¡Œèµ‹å€¼ç„¶åè¿”å›ï¼Œå¦‚æœæ± é‡Œæ²¡æœ‰ä¸œè¥¿çš„è¯å°±ç›´æ¥è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</p><p>ä¸‹é¢çœ‹é‡ç‚¹æ–¹æ³•<code>traverseAllChildren</code></p><figure class="highlight puppet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Traverses children that are typically specified as `props.children`, but</span><br><span class="line"> * might also be specified through attributes:</span><br><span class="line"> *</span><br><span class="line"> * - `traverseAllChildren(this.props.children, ...)`</span><br><span class="line"> * - `traverseAllChildren(this.props.leftPanelChildren, ...)`</span><br><span class="line"> *</span><br><span class="line"> * The `traverseContext` is an optional argument that is passed through the</span><br><span class="line"> * entire traversal. It can be used to store accumulations or anything else that</span><br><span class="line"> * the callback might find relevant.</span><br><span class="line"> *</span><br><span class="line"> * @<span class="keyword">param</span> &#123;?*&#125; <span class="keyword">children</span> <span class="keyword">Children</span> <span class="keyword">tree</span> <span class="keyword">object</span>.</span><br><span class="line"> * @<span class="keyword">param</span> &#123;!function&#125; <span class="keyword">callback</span> <span class="keyword">To</span> <span class="keyword">invoke</span> <span class="keyword">upon</span> <span class="keyword">traversing</span> <span class="keyword">each</span> <span class="keyword">child</span>.</span><br><span class="line"> * @<span class="keyword">param</span> &#123;?*&#125; <span class="keyword">traverseContext</span> <span class="keyword">Context</span> <span class="keyword">for</span> <span class="keyword">traversal</span>.</span><br><span class="line"> * @<span class="keyword">return</span> &#123;!number&#125; <span class="keyword">The</span> <span class="keyword">number</span> <span class="keyword">of</span> <span class="keyword">children</span> <span class="keyword">in</span> <span class="keyword">this</span> <span class="keyword">subtree</span>.</span><br><span class="line"> */</span><br><span class="line">function traverseAllChildren(children, callback, traverseContext) &#123;</span><br><span class="line">  if (children == null) &#123;</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return traverseAllChildrenImpl(children, <span class="string">''</span>, callback, traverseContext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦çœ‹è¿™ä¸ªæ–¹æ³•çš„å®ç°<code>traverseAllChildrenImpl</code></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @param &#123;?*&#125; children Children tree container.</span></span><br><span class="line"><span class="comment"> * @param &#123;!string&#125; nameSoFar Name of the key path so far.</span></span><br><span class="line"><span class="comment"> * @param &#123;!function&#125; callback Callback to invoke with each child found.</span></span><br><span class="line"><span class="comment"> * @param &#123;?*&#125; traverseContext Used to pass information throughout the traversal</span></span><br><span class="line"><span class="comment"> * process.</span></span><br><span class="line"><span class="comment"> * @return &#123;!number&#125; The number of children in this subtree.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">traverseAllChildrenImpl</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  children,</span></span></span><br><span class="line"><span class="function"><span class="params">  nameSoFar,</span></span></span><br><span class="line"><span class="function"><span class="params">  callback,</span></span></span><br><span class="line"><span class="function"><span class="params">  traverseContext,</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">type</span> = <span class="keyword">typeof</span> children;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">type</span> === <span class="string">'undefined'</span> || <span class="keyword">type</span> === <span class="string">'boolean'</span>) &#123;</span><br><span class="line">    <span class="comment">// All of the above are perceived as null.</span></span><br><span class="line">    children = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> invokeCallback = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (children === <span class="literal">null</span>) &#123;</span><br><span class="line">    invokeCallback = <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'string'</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'number'</span>:</span><br><span class="line">        invokeCallback = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'object'</span>:</span><br><span class="line">        <span class="keyword">switch</span> (children.$$<span class="keyword">typeof</span>) &#123;</span><br><span class="line">          <span class="keyword">case</span> REACT_ELEMENT_TYPE:</span><br><span class="line">          <span class="keyword">case</span> REACT_PORTAL_TYPE:</span><br><span class="line">            invokeCallback = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (invokeCallback) &#123;</span><br><span class="line">    callback(</span><br><span class="line">      traverseContext,</span><br><span class="line">      children,</span><br><span class="line">      <span class="comment">// If it's the only child, treat the name as if it was wrapped in an array</span></span><br><span class="line">      <span class="comment">// so that it's consistent if the number of children grows.</span></span><br><span class="line">      nameSoFar === <span class="string">''</span> ? SEPARATOR + getComponentKey(children, <span class="number">0</span>) : nameSoFar,</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> child;</span><br><span class="line">  <span class="keyword">let</span> nextName;</span><br><span class="line">  <span class="keyword">let</span> subtreeCount = <span class="number">0</span>; <span class="comment">// Count of children found in the current subtree.</span></span><br><span class="line">  <span class="keyword">const</span> nextNamePrefix =</span><br><span class="line">    nameSoFar === <span class="string">''</span> ? SEPARATOR : nameSoFar + SUBSEPARATOR;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(children)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; children.length; i++) &#123;</span><br><span class="line">      child = children[i];</span><br><span class="line">      nextName = nextNamePrefix + getComponentKey(child, i);</span><br><span class="line">      subtreeCount += traverseAllChildrenImpl(</span><br><span class="line">        child,</span><br><span class="line">        nextName,</span><br><span class="line">        callback,</span><br><span class="line">        traverseContext,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> iteratorFn = getIteratorFn(children);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> iteratorFn === <span class="string">'function'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">        <span class="comment">// Warn about using Maps as children</span></span><br><span class="line">        <span class="keyword">if</span> (iteratorFn === children.entries) &#123;</span><br><span class="line">          warning(</span><br><span class="line">            didWarnAboutMaps,</span><br><span class="line">            <span class="string">'Using Maps as children is unsupported and will likely yield '</span> +</span><br><span class="line">              <span class="string">'unexpected results. Convert it to a sequence/iterable of keyed '</span> +</span><br><span class="line">              <span class="string">'ReactElements instead.'</span>,</span><br><span class="line">          );</span><br><span class="line">          didWarnAboutMaps = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> iterator = iteratorFn.call(children);</span><br><span class="line">      <span class="keyword">let</span> step;</span><br><span class="line">      <span class="keyword">let</span> ii = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span> (!(step = iterator.next()).done) &#123;</span><br><span class="line">        child = step.value;</span><br><span class="line">        nextName = nextNamePrefix + getComponentKey(child, ii++);</span><br><span class="line">        subtreeCount += traverseAllChildrenImpl(</span><br><span class="line">          child,</span><br><span class="line">          nextName,</span><br><span class="line">          callback,</span><br><span class="line">          traverseContext,</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">type</span> === <span class="string">'object'</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> addendum = <span class="string">''</span>;</span><br><span class="line">      <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">        addendum =</span><br><span class="line">          <span class="string">' If you meant to render a collection of children, use an array '</span> +</span><br><span class="line">          <span class="string">'instead.'</span> +</span><br><span class="line">          ReactDebugCurrentFrame.getStackAddendum();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> childrenString = <span class="string">''</span> + children;</span><br><span class="line">      invariant(</span><br><span class="line">        <span class="literal">false</span>,</span><br><span class="line">        <span class="string">'Objects are not valid as a React child (found: %s).%s'</span>,</span><br><span class="line">        childrenString === <span class="string">'[object Object]'</span></span><br><span class="line">          ? <span class="string">'object with keys &#123;'</span> + <span class="built_in">Object</span>.keys(children).join(<span class="string">', '</span>) + <span class="string">'&#125;'</span></span><br><span class="line">          : childrenString,</span><br><span class="line">        addendum,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> subtreeCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æ­¥è§£æ<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">let invokeCallback = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (children === <span class="literal">null</span>) &#123;</span><br><span class="line">    invokeCallback = <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'string'</span>:</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'number'</span>:</span><br><span class="line">        invokeCallback = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'object'</span>:</span><br><span class="line">        <span class="keyword">switch</span> (children.$$typeof) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">REACT_ELEMENT_TYPE:</span></span><br><span class="line">          <span class="keyword">case</span> <span class="string">REACT_PORTAL_TYPE:</span></span><br><span class="line">            invokeCallback = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (invokeCallback) &#123;</span><br><span class="line">    callback(</span><br><span class="line">      traverseContext,</span><br><span class="line">      children,</span><br><span class="line">      <span class="comment">// If it's the only child, treat the name as if it was wrapped in an array</span></span><br><span class="line">      <span class="comment">// so that it's consistent if the number of children grows.</span></span><br><span class="line">      nameSoFar === <span class="string">''</span> ? SEPARATOR + getComponentKey(children, 0) : nameSoFar,</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸€å—æ˜¯ç”¨æ¥åˆ¤æ–­ children ç±»å‹çš„ï¼Œå¦‚æœæ˜¯<code>string</code>æ¯”å¦‚è¯´ä¼ é€’ä¸€ä¸ªæ–‡æœ¬ï¼Œ<code>number</code>,<code>object</code>æ¯”å¦‚è¯´ä¸€ä¸ªdomèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¡¨æ˜ children åªæ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ‰§è¡Œ <code>callback</code> è¿”å›ä¸€ä¸ª 1</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Array.isArray(children)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (let <span class="built_in">i</span> = <span class="number">0</span>; <span class="built_in">i</span> &lt; children.<span class="built_in">length</span>; <span class="built_in">i</span>++) &#123;</span><br><span class="line">      child = children[<span class="built_in">i</span>];</span><br><span class="line">      nextName = nextNamePrefix + getComponentKey(child, <span class="built_in">i</span>);</span><br><span class="line">      subtreeCount += traverseAllChildrenImpl(</span><br><span class="line">        child,</span><br><span class="line">        nextName,</span><br><span class="line">        callback,</span><br><span class="line">        traverseContext,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬ä¼ é€’çš„æ˜¯å¤šä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆä¼šéå†childrenæ•°ç»„ï¼Œè¿›è¡Œé€’å½’éå†ï¼Œç›´åˆ°è¿”å›çš„æ˜¯ä¸Šé¢æ˜¾ç¤ºçš„å‡ ä¸ªç±»å‹ã€‚</p><p>ä¸Šè¾¹æåˆ°çš„<code>callback</code>å°±æ˜¯ä¼ é€’çš„<code>mapSingleChildIntoContext</code>,è¿™è¾¹å°±æ˜¯åˆ©ç”¨åˆ°ä¹‹å‰çš„<code>traverseContextPool</code>è¢«æˆ‘ç§°ä¹‹ä¸ºè¿æ¥æ± çš„ä¸œè¥¿.</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function mapSingleChildIntoContext(bookKeeping, child, childKey) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;result, keyPrefix, <span class="function"><span class="keyword">func</span>, <span class="title">context</span>&#125; = <span class="title">bookKeeping</span>;</span></span><br><span class="line"></span><br><span class="line">  let mappedChild = <span class="function"><span class="keyword">func</span>.<span class="title">call</span><span class="params">(context, child, bookKeeping.count++)</span>;</span></span><br><span class="line">  <span class="keyword">if</span> (Array.<span class="built_in">isArray</span>(mappedChild)) &#123;</span><br><span class="line">    mapIntoWithKeyPrefixInternal(mappedChild, result, childKey, c =&gt; c)<span class="comment">;</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mappedChild != <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isValidElement(mappedChild)) &#123;</span><br><span class="line">      mappedChild = cloneAndReplaceKey(</span><br><span class="line">        mappedChild,</span><br><span class="line">        // Keep both the (mapped) <span class="literal">and</span> old keys <span class="keyword">if</span> they differ, just as</span><br><span class="line">        // traverseAllChildren used <span class="keyword">to</span> <span class="keyword">do</span> <span class="keyword">for</span> objects as children</span><br><span class="line">        keyPrefix +</span><br><span class="line">          (mappedChild.key &amp;&amp; (!child || child.key !== mappedChild.key)</span><br><span class="line">            ? escapeUserProvidedKey(mappedChild.key) + <span class="string">'/'</span></span><br><span class="line">            : <span class="string">''</span>) +</span><br><span class="line">          childKey,</span><br><span class="line">      )<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">    result.push(mappedChild)<span class="comment">;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™è¾¹çš„<code>mappedChild</code>å°±æ˜¯æˆ‘ä»¬ä¼ é€’çš„funcionçš„è¿”å›å€¼ï¼Œfunctionå‘¢å°±æ˜¯è°ƒç”¨<code>React.Children.map(children,callback)</code>è¿™é‡Œçš„callbackäº†ï¼Œå¦‚æœè¿™ä¸ªè¿”å›å€¼è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„çš„è¯ï¼Œé‚£ä¹ˆå°±è¿›è¡Œé€’å½’è°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°ä¹‹å‰çš„è¿æ¥æ± äº†ã€‚</p><p>é‡‡ç”¨è¿™ä¸ªè¿æ¥æ± çš„ç›®çš„æˆ‘ä¹Ÿæ˜¯åœ¨å…¶ä»–çš„åœ°æ–¹çœ‹åˆ°äº†</p><blockquote><p>å› ä¸ºå¯¹Childrençš„å¤„ç†ä¸€èˆ¬åœ¨renderé‡Œé¢ï¼Œæ‰€ä»¥ä¼šæ¯”è¾ƒé¢‘ç¹ï¼Œæ‰€ä»¥è®¾ç½®ä¸€ä¸ªpoolå‡å°‘å£°æ˜å’Œgcçš„å¼€é”€</p></blockquote><p>è¿™å°±æ˜¯<code>React.Children.map</code>çš„å®ç°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æºç  </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>void (0) ??? undefined ???</title>
      <link href="/2019/09/10/void%20(0)%20???%20undefined%20???/"/>
      <url>/2019/09/10/void%20(0)%20???%20undefined%20???/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä»Šå¤©çœ‹Reactçš„æºç ï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„å†™æ³•ï¼Œåœ¨<code>ReactChildren.js</code>ä¸­çœ‹è§äº†è¿™ä¹ˆä¸€è¡Œä»£ç <code>var child = void 0</code>,è¿™ä¸ªæ˜¯å‡ºç°åœ¨Reactç¼–è¯‘ä¹‹åçš„<code>cjs/react.development.js</code>ä¸­ã€‚åœ¨æˆ‘çš„è®¤çŸ¥é‡Œï¼Œ<code>void</code>æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼çš„ã€‚å°½ç„¶è¿˜æœ‰è¿™ç§å†™æ³•ï¼Œæ˜¯JSçš„ç¥å¥‡çš„magicå˜›</p></blockquote><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>é¦–å…ˆçœ‹å‡ ä¸ªç¤ºä¾‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">void</span> <span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">void</span> <span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">void</span> <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">void</span> alert(<span class="string">'test'</span>));</span><br></pre></td></tr></table></figure><p>åœ¨çœ‹æ‰“å°çš„ç»“æœ</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">undefined</span></span><br><span class="line"><span class="literal">undefined</span></span><br><span class="line"><span class="literal">undefined</span></span><br><span class="line"><span class="literal">undefined</span></span><br></pre></td></tr></table></figure><p>ç»“æœéƒ½æ˜¯<code>undefined</code></p><p>é‚£ä¹ˆå’Œ<code>undefined</code> åšä¸€ä¸ªæ¯”è¾ƒ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log((<span class="keyword">void</span> <span class="number">0</span>) === <span class="literal">undefined</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç° <code>void 0</code> æ˜¯å¯ä»¥ä½œä¸º<code>undefined</code> çš„ä¸€ä¸ªæ›¿ä»£</p><a id="more"></a><h2 id="void-è¿ç®—ç¬¦"><a href="#void-è¿ç®—ç¬¦" class="headerlink" title="void è¿ç®—ç¬¦"></a>void è¿ç®—ç¬¦</h2><p>æŸ¥çœ‹ MDN çš„è§£é‡Š</p><blockquote><p>void è¿ç®—ç¬¦ å¯¹ç»™å®šçš„è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ï¼Œç„¶åè¿”å› undefinedã€‚</p><p>è¿™ä¸ªè¿ç®—ç¬¦èƒ½å‘æœŸæœ›ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼æ˜¯undefinedçš„åœ°æ–¹æ’å…¥ä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„è¡¨è¾¾å¼ã€‚<br>void è¿ç®—ç¬¦é€šå¸¸åªç”¨äºè·å– undefinedçš„åŸå§‹å€¼ï¼Œä¸€èˆ¬ä½¿ç”¨void(0)ï¼ˆç­‰åŒäºvoid 0ï¼‰ã€‚åœ¨ä¸Šè¿°æƒ…å†µä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡undefined æ¥ä»£æ›¿ï¼ˆå‡å®šå…¶ä»æ˜¯é»˜è®¤å€¼ï¼‰ã€‚</p></blockquote><p>ç›´ç™½çš„è®²å°±æ˜¯ä¼šè°ƒç”¨åé¢çš„è¡¨è¾¾å¼ç„¶åè¿”å›ä¸€ä¸ª<code>undefined</code></p><p>åšä¸ªç¤ºä¾‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">void</span> (<span class="built_in">console</span>.log(<span class="string">'test console'</span>)));</span><br><span class="line"></span><br><span class="line"><span class="comment">// test console</span></span><br><span class="line"><span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p>å¦‚æœç›´æ¥å†™æˆ <code>void 0</code> åé¢çš„è¡¨è¾¾å¼æ²¡æœ‰ä»»ä½•æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯æ— å‰¯ä½œç”¨çš„ã€‚</p><h2 id="void-å’Œ-undefined-çš„åŒºåˆ«"><a href="#void-å’Œ-undefined-çš„åŒºåˆ«" class="headerlink" title="void å’Œ undefined çš„åŒºåˆ«"></a>void å’Œ undefined çš„åŒºåˆ«</h2><p><code>undefined</code>ä¸æ˜¯ä¿ç•™å­—ï¼Œåªæ˜¯å…¨å±€å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œåœ¨ä½ç‰ˆæœ¬çš„ieä¸Šæ˜¯å¯ä»¥æ”¹å†™çš„,ä½†æ˜¯æˆ‘å‘ç°åœ¨chromeä¸Šä¹Ÿå¯ä»¥æ”¹å†™ï¼Œç¥å¥‡ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> magic </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Nginx åå‘ä»£ç† + ç¼“å­˜ + é™æ€èµ„æºæœåŠ¡å™¨ + è´Ÿè½½å‡è¡¡</title>
      <link href="/2019/08/23/Nginx%20%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%20+%20%E7%BC%93%E5%AD%98%20+%20%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E5%99%A8%20+%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
      <url>/2019/08/23/Nginx%20%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%20+%20%E7%BC%93%E5%AD%98%20+%20%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E5%99%A8%20+%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>nginxç»å¸¸æŒ‚åœ¨å˜´è¾¹çš„å°±æ˜¯åå‘ä»£ç†ï¼Œä¸è¿‡ä»–è¿˜å¯ä»¥å¹²å¾ˆå¤šäº‹ï¼Œæˆ‘æ‰€äº†è§£çš„åªæ˜¯åå‘ä»£ç†ã€é™æ€æ–‡ä»¶ç¼“å­˜ã€é™æ€èµ„æºæœåŠ¡å™¨ï¼Œå¯¹äºè´Ÿè½½å‡è¡¡åªæ˜¯ç•¥æœ‰æ¶‰åŠã€‚</p></blockquote><blockquote><p>Nginx (â€œengine xâ€) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ HTTP å’Œ åå‘ä»£ç† æœåŠ¡å™¨ ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª IMAP/POP3/SMTP ä»£ç† æœåŠ¡å™¨ ã€‚ Nginx æ˜¯ç”± Igor Sysoev ä¸ºä¿„ç½—æ–¯è®¿é—®é‡ç¬¬äºŒçš„ Rambler.ru ç«™ç‚¹å¼€å‘çš„ï¼Œç¬¬ä¸€ä¸ªå…¬å¼€ç‰ˆæœ¬0.1.0å‘å¸ƒäº2004å¹´10æœˆ4æ—¥ã€‚å…¶å°†æºä»£ç ä»¥ç±»BSDè®¸å¯è¯çš„å½¢å¼å‘å¸ƒï¼Œå› å®ƒçš„ç¨³å®šæ€§ã€ä¸°å¯Œçš„åŠŸèƒ½é›†ã€ç¤ºä¾‹é…ç½®æ–‡ä»¶å’Œä½ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—è€Œé—»å</p></blockquote><blockquote><p>å¼•ç”¨ä¸€ä¸‹èœé¸Ÿæ•™ç¨‹çš„ç®€ä»‹ï¼šNginxåŠŸèƒ½ä¸°å¯Œï¼Œå¯ä½œä¸ºHTTPæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œé‚®ä»¶æœåŠ¡å™¨ã€‚æ”¯æŒFastCGIã€SSLã€Virtual Hostã€URL Rewriteã€Gzipç­‰åŠŸèƒ½ã€‚å¹¶ä¸”æ”¯æŒå¾ˆå¤šç¬¬ä¸‰æ–¹çš„æ¨¡å—æ‰©å±•ã€‚Nginxçš„ç¨³å®šæ€§ã€åŠŸèƒ½é›†ã€ç¤ºä¾‹é…ç½®æ–‡ä»¶å’Œä½ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—è®©ä»–åæ¥å±…ä¸Šï¼Œåœ¨å…¨çƒæ´»è·ƒçš„ç½‘ç«™ä¸­æœ‰12.18%çš„ä½¿ç”¨æ¯”ç‡ï¼Œå¤§çº¦ä¸º2220ä¸‡ä¸ªç½‘ç«™ã€‚</p></blockquote><blockquote><p>ç‰¹ç‚¹<br>(1)ï¼šä»£ç†æœåŠ¡å™¨ï¼Œå¿«é€Ÿé«˜æ•ˆåå‘ä»£ç†ï¼Œæå‡ç½‘ç«™æ€§èƒ½ã€‚<br>(2)ï¼šè´Ÿè½½å‡è¡¡å™¨ï¼Œå†…éƒ¨æ”¯æŒRailså’ŒPHP,ä¹Ÿå¯æ”¯æŒHTTPä»£ç†æœåŠ¡å™¨ï¼Œå¯¹å¤–è¿›è¡ŒæœåŠ¡ã€‚åŒæ—¶æ”¯æŒç®€å•å®¹é”™å’Œåˆ©ç”¨ç®—æ³•è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚<br>(3)ï¼šæ€§èƒ½æ–¹é¢ï¼ŒNginxä¸“é—¨ä¸ºæ€§èƒ½è®¾è®¡ï¼Œå®ç°æ³¨é‡æ•ˆç‡ã€‚é‡‡ç”¨Pollæ¨¡å‹ï¼Œå¯ä»¥æ”¯æŒæ›´å¤šçš„å¹¶å‘è¿æ¥ï¼Œå¹¶åœ¨å¤§å¹¶å‘æ—¶å ç”¨å¾ˆä½å†…å­˜ã€‚<br>(4)ï¼šç¨³å®šæ€§æ–¹é¢ï¼Œé‡‡ç”¨åˆ†é˜¶æ®µèµ„æºåˆ†é…æŠ€æœ¯ï¼Œä½¿CPUèµ„æºå ç”¨ç‡ä½ã€‚<br>(5)ï¼šé«˜å¯ç”¨æ€§æ–¹é¢ï¼Œæ”¯æŒçƒ­å¤‡ï¼Œå¯åŠ¨è¿…é€Ÿã€‚</p></blockquote><a id="more"></a><h2 id="nginxå®‰è£…"><a href="#nginxå®‰è£…" class="headerlink" title="nginxå®‰è£…"></a>nginxå®‰è£…</h2><p>mac ä¸‹å®‰è£…</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span>nginx</span><br></pre></td></tr></table></figure><p>å®‰è£…ç›®å½•ä¸º <code>/usr/local/Cellar/nginx/1.17.2/</code><br>é…ç½®æ–‡ä»¶ç›®å½•ä¸º <code>/usr/local/etc/nginx/nginx.conf</code><br>æœåŠ¡å™¨é»˜è®¤è·¯å¾„ <code>/usr/local/var/www</code></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><p>mac ä¸‹çš„å¯åŠ¨å‘½ä»¤</p><ul><li><p>å¯åŠ¨ <code>nginx</code></p></li><li><p>å¿«é€Ÿåœæ­¢å…³é—­ <code>nignx -s stop</code></p></li><li><p>ä¼˜é›…çš„å…³é—­ <code>nginx -s quit</code></p></li><li><p>æ‰¿è½½é…ç½®æ–‡ä»¶ <code>nginx -s reload</code></p></li><li><p>æŸ¥çœ‹nginxè¿›ç¨‹ <code>ps -ef | grep nginx</code></p></li><li><p>æŸ¥çœ‹é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡® <code>nginx -t</code></p></li><li><p>ä¼˜é›…çš„æ€æ­»nginxè¿›ç¨‹ <code>kill -quit è¿›ç¨‹å·</code></p></li><li><p>å¿«é€Ÿçš„æ€æ­»nginxè¿›ç¨‹ <code>kill -term è¿›ç¨‹å·</code></p></li></ul><h2 id="nginxé…ç½®"><a href="#nginxé…ç½®" class="headerlink" title="nginxé…ç½®"></a>nginxé…ç½®</h2><p>nginx æ–‡ä»¶çš„é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½® <code>/usr/local/etc/nginx/nginx.conf</code></p><p>æ‰“å¼€ <code>/usr/local/etc/nginx/</code> ç›®å½•å¯ä»¥çœ‹åˆ°ï¼Œé‡Œé¢æœ‰å¾ˆå¤šçš„é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨æœ‰ä¸€ä¸ª<code>nginx.conf</code> å’Œ <code>nginx.conf.default</code>ä¸¤ä¸ªé…ç½®æ–‡ä»¶,åˆšå¼€å§‹å®‰è£…çš„æ—¶å€™ï¼Œä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‚†æ„çš„ä¿®æ”¹<code>nginx.conf</code>æå´©çš„è¯å°±ç›´æ¥æŠŠ<code>nginx.conf.default</code>ä¸­çš„å†…å®¹å¤åˆ¶è¿‡æ¥å°±è¡Œäº†åˆæ˜¯ä¸€ä¸ªæ–°çš„nginxã€‚</p><h3 id="é…ç½®æ–‡ä»¶æ¶æ„"><a href="#é…ç½®æ–‡ä»¶æ¶æ„" class="headerlink" title="é…ç½®æ–‡ä»¶æ¶æ„"></a>é…ç½®æ–‡ä»¶æ¶æ„</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nginxå…¨å±€å—</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// eventså—</span></span><br><span class="line">events &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// http å—</span></span><br><span class="line">http &#123;</span><br><span class="line">    <span class="comment">// httpå…¨å±€å—</span></span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// serverå—</span></span><br><span class="line">    server &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// httpå…¨å±€å—</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é…ç½®æ–‡ä»¶åŠ æ³¨é‡Šè¯´æ˜"><a href="#é…ç½®æ–‡ä»¶åŠ æ³¨é‡Šè¯´æ˜" class="headerlink" title="é…ç½®æ–‡ä»¶åŠ æ³¨é‡Šè¯´æ˜"></a>é…ç½®æ–‡ä»¶åŠ æ³¨é‡Šè¯´æ˜</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># é…ç½®nginxçš„ç”¨æˆ·ç»„ é»˜è®¤ä¸ºnobody</span></span><br><span class="line"><span class="meta">#user  nobody;</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># é…ç½®nginxçš„ä¸»çº¿ç¨‹æ•°é‡ nginxæ˜¯ä¸€ä¸ªä¸»çº¿ç¨‹ä¸‹é¢å¤šä¸ªå­çº¿ç¨‹</span></span><br><span class="line">worker_processes  <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta"># é…ç½®nginxçš„é”™è¯¯æ—¥å¿— æ ¼å¼ä¸º logè·¯å¾„ logçº§åˆ«</span></span><br><span class="line"><span class="meta"># error_log çš„æ—¥å¿—çº§åˆ«ä¸ºï¼š debug info notice warn <span class="meta-keyword">error</span> crit alert emerg ç´§æ€¥ç”±ä½åˆ°é«˜</span></span><br><span class="line"><span class="meta"># error_logçš„é»˜è®¤æ—¥å¿—çº§åˆ«ä¸º<span class="meta-keyword">error</span>ï¼Œé‚£ä¹ˆå°±åªæœ‰ç´§æ€¥ç¨‹åº¦å¤§äºç­‰äº<span class="meta-keyword">error</span>çš„æ‰ä¼šè®°å½•åœ¨æ—¥å¿—</span></span><br><span class="line"><span class="meta"># error_log çš„ä½œç”¨åŸŸä¸º main http mail stream server location</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#error_log  logs/<span class="meta-keyword">error</span>.log;</span></span><br><span class="line"><span class="meta">#error_log  logs/<span class="meta-keyword">error</span>.log  notice;</span></span><br><span class="line"><span class="meta">#error_log  logs/<span class="meta-keyword">error</span>.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># æŒ‡å®šnginxè¿›ç¨‹è¿è¡Œæ–‡ä»¶å­˜æ”¾åœ°å€</span></span><br><span class="line"><span class="meta">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    <span class="meta"># pollæ˜¯å¤šè·¯å¤ç”¨IOä¸­çš„ä¸€ç§æ–¹å¼,ä½†æ˜¯ä»…ç”¨äºlinux2.6ä»¥ä¸Šå†…æ ¸,å¯ä»¥å¤§å¤§æé«˜nginxçš„æ€§èƒ½</span></span><br><span class="line">    <span class="meta"># use poll</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta"># è®¾ç½®ç½‘ç»œçš„è¿æ¥åºåˆ—åŒ– é˜²æ­¢æƒŠç¾¤ç°è±¡å‘ç”Ÿ é»˜è®¤ä¸º on</span></span><br><span class="line">    <span class="meta"># accept_mutex on;</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta"># è®¾ç½®ä¸€ä¸ªè¿›ç¨‹æ˜¯å¦åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ é»˜è®¤ä¸º off</span></span><br><span class="line">    <span class="meta"># multi_accept off</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta"># æœ€å¤§è¿æ¥æ•° é»˜è®¤ä¸º 512</span></span><br><span class="line">    worker_connections  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    <span class="meta"># æ–‡ä»¶æ‰©å±•åå’Œæ–‡ä»¶ç±»å‹æ˜ å°„è¡¨</span></span><br><span class="line">    include       mime.types;</span><br><span class="line">    </span><br><span class="line">    <span class="meta"># é»˜è®¤æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    </span><br><span class="line">    <span class="meta"># æ—¥å¿—æ ¼å¼ æ–‡ç« åé¢ä¼šä»‹ç»</span></span><br><span class="line">    <span class="meta">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">    <span class="meta">#                  '$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">    <span class="meta">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…è®¸é€šè¿‡æ—¥å¿—é…ç½®</span></span><br><span class="line">    <span class="meta">#access_log  logs/access.log  main;</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta"># sendfile æŒ‡å®šä½¿ç”¨ sendfile ç³»ç»Ÿè°ƒç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚ä¼˜ç‚¹åœ¨äºåœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´ä¼ é€’æ•°æ®ï¼ˆå®Œå…¨åœ¨å†…æ ¸ä¸­æ“ä½œï¼‰ï¼Œä»è€Œé¿å…äº†æ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºå’Œç”¨æˆ·ç¼“å†²åŒºä¹‹é—´çš„æ‹·è´ï¼Œæ•ˆç‡é«˜ï¼Œç§°ä¹‹ä¸ºé›¶æ‹·è´ï¼Œè¿™ä¸ªä¸œè¥¿æœ‰ç‚¹è®²ç©¶ï¼Œè‡ªè¡Œç™¾åº¦</span></span><br><span class="line">    <span class="meta"># sendfile ä½œç”¨åŸŸ location server http</span></span><br><span class="line">    sendfile        <span class="keyword">on</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">#tcp_nopush     on;</span></span><br><span class="line">    </span><br><span class="line">    <span class="meta"># é“¾æ¥è¶…æ—¶æ—¶é—´ é»˜è®¤ 75s ä½œç”¨åŸŸ http server location</span></span><br><span class="line">    <span class="meta">#keepalive_timeout  0;</span></span><br><span class="line">    keepalive_timeout  <span class="number">65</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta"># å¼€å§‹gzipå‹ç¼©</span></span><br><span class="line">    <span class="meta">#gzip  on;</span></span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        <span class="meta"># ç«¯å£å·</span></span><br><span class="line">        listen       <span class="number">8080</span>;</span><br><span class="line">        <span class="meta"># åŸŸåæˆ–ip</span></span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        <span class="meta">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#access_log  logs/host.access.log  main;</span></span><br><span class="line">        </span><br><span class="line">        <span class="meta"># å¯¹è¯·æ±‚çš„è·¯ç”±è¿›è¡Œè¿‡æ»¤ æ­£åˆ™åŒ¹é…</span></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    include servers<span class="comment">/*;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="nginx-æ—¥å¿—"><a href="#nginx-æ—¥å¿—" class="headerlink" title="nginx æ—¥å¿—"></a>nginx æ—¥å¿—</h2><p>nginxçš„æ—¥å¿—å¤§è‡´åˆ†ä¸º <code>access_log</code> å’Œ <code>error_log</code>ã€‚error_log è®°å½•çš„æ˜¯nginxçš„é”™è¯¯æ—¥å¿—ã€‚ï¼ˆä»¥ä¸‹å¯¹æ—¥å¿—çš„ç†è§£ä¸æ˜¯å¾ˆå…¨é¢ï¼Œè¿˜åªæ˜¯åŸºç¡€çš„ï¼‰</p><h3 id="error-log"><a href="#error-log" class="headerlink" title="error_log"></a>error_log</h3><ul><li>è®°å½•nginxé”™è¯¯æ—¥å¿—</li><li>ä½œç”¨åŸŸä¸º <code>main http mail stream server location</code></li><li>æ—¥å¿—çº§åˆ« <code>debug info notice warn error crit alert emerg</code></li><li>æ—¥å¿—çº§åˆ«é»˜è®¤ä¸º error å½“çº§åˆ«é«˜äºæˆ–ç­‰äºæŒ‡å®šçº§åˆ«æ—¶æ‰ä¼šè®°å½•</li></ul><h3 id="access-log"><a href="#access-log" class="headerlink" title="access_log"></a>access_log</h3><ul><li>è®°å½•è¯·æ±‚é€šè¿‡çš„æ—¥å¿—</li><li>ä½œç”¨åŸŸä¸º <code>http server location limit_except</code></li><li>æ—¥å¿—æ ¼å¼é»˜è®¤ä¸º <code>combined</code></li><li>æ—¥å¿—æ ¼å¼æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„</li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªä¸º main çš„æ—¥å¿—æ ¼å¼</span></span><br><span class="line"><span class="attribute">log_format</span>  main  <span class="string">'<span class="variable">$remote_addr</span> - <span class="variable">$remote_user</span> [<span class="variable">$time_local</span>] "<span class="variable">$request</span>" '</span></span><br><span class="line">                      <span class="string">'<span class="variable">$status</span> <span class="variable">$body_bytes_sent</span> "<span class="variable">$http_referer</span>" '</span></span><br><span class="line">                      <span class="string">'"<span class="variable">$http_user_agent</span>" "<span class="variable">$http_x_forwarded_for</span>"'</span>;</span><br><span class="line">                      </span><br><span class="line"><span class="attribute">access_log</span>  logs/access.log  main;</span><br></pre></td></tr></table></figure><p>ä¸Šæ–¹çš„ <code>log_format</code> åé¢ç±»ä¼¼ <code>$remote_addr</code> æ˜¯nginxçš„å†…ç½®å˜é‡ï¼Œå–å€¼å¦‚ä¸‹<br><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">$remote</span>_addr, $http_x_forwarded_forï¼ˆåå‘ï¼‰ è®°å½•å®¢æˆ·ç«¯IPåœ°å€</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$remote</span>_user è®°å½•å®¢æˆ·ç«¯ç”¨æˆ·åç§°</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$request</span> è®°å½•è¯·æ±‚çš„URLå’ŒHTTPåè®®</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$status</span> è®°å½•è¯·æ±‚çŠ¶æ€</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$body</span>_bytes_sent å‘é€ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•°ï¼Œä¸åŒ…æ‹¬å“åº”å¤´çš„å¤§å°ï¼› è¯¥å˜é‡ä¸Apacheæ¨¡å—mod_log_configé‡Œçš„â€œ%Bâ€å‚æ•°å…¼å®¹ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$bytes</span>_sent å‘é€ç»™å®¢æˆ·ç«¯çš„æ€»å­—èŠ‚æ•°ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$connection</span> è¿æ¥çš„åºåˆ—å·ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$connection</span>_requests å½“å‰é€šè¿‡ä¸€ä¸ªè¿æ¥è·å¾—çš„è¯·æ±‚æ•°é‡ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$msec</span> æ—¥å¿—å†™å…¥æ—¶é—´ã€‚å•ä½ä¸ºç§’ï¼Œç²¾åº¦æ˜¯æ¯«ç§’ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$pipe</span> å¦‚æœè¯·æ±‚æ˜¯é€šè¿‡HTTPæµæ°´çº¿(pipelined)å‘é€ï¼Œpipeå€¼ä¸ºâ€œpâ€ï¼Œå¦åˆ™ä¸ºâ€œ.â€ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$http</span>_referer è®°å½•ä»å“ªä¸ªé¡µé¢é“¾æ¥è®¿é—®è¿‡æ¥çš„</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$http</span>_user_agent è®°å½•å®¢æˆ·ç«¯æµè§ˆå™¨ç›¸å…³ä¿¡æ¯</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$request</span>_length è¯·æ±‚çš„é•¿åº¦ï¼ˆåŒ…æ‹¬è¯·æ±‚è¡Œï¼Œè¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡ï¼‰ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$request</span>_time è¯·æ±‚å¤„ç†æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œç²¾åº¦æ¯«ç§’ï¼› ä»è¯»å…¥å®¢æˆ·ç«¯çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹ï¼Œç›´åˆ°æŠŠæœ€åä¸€ä¸ªå­—ç¬¦å‘é€ç»™å®¢æˆ·ç«¯åè¿›è¡Œæ—¥å¿—å†™å…¥ä¸ºæ­¢ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$time</span>_iso8601 ISO8601æ ‡å‡†æ ¼å¼ä¸‹çš„æœ¬åœ°æ—¶é—´ã€‚</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$time</span>_local é€šç”¨æ—¥å¿—æ ¼å¼ä¸‹çš„æœ¬åœ°æ—¶é—´ã€‚</span></span><br></pre></td></tr></table></figure></p><h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><h3 id="æ­£å‘ä»£ç†-åå‘ä»£ç†"><a href="#æ­£å‘ä»£ç†-åå‘ä»£ç†" class="headerlink" title="æ­£å‘ä»£ç† åå‘ä»£ç†"></a>æ­£å‘ä»£ç† åå‘ä»£ç†</h3><ul><li>æ­£å‘ä»£ç†å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚åŒ…å«æœåŠ¡å™¨åœ°å€ï¼Œé‚£ä¹ˆä»£ç†æœåŠ¡å™¨æ”¶åˆ°äº†è¯·æ±‚åä¼šå°†è¯·æ±‚å‘é€åˆ°å®¢æˆ·ç«¯æŒ‡å®šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†å“åº”å†…å®¹ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯æ˜¯çŸ¥é“è¯·æ±‚çš„æœåŠ¡å™¨åœ°å€çš„ï¼Œä½†æ˜¯æœåŠ¡å™¨æ˜¯ä¸çŸ¥é“å“ªä¸ªå®¢æˆ·ç«¯è¯·æ±‚çš„ã€‚VPNåšçš„å°±æ˜¯è¿™ä¸ªäº‹ã€‚</li><li>åå‘ä»£ç†å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ç»™ä»£ç†æœåŠ¡å™¨ï¼Œç”±ä»£ç†æœåŠ¡å™¨æ¥å†³å®šè¿™ä¸ªè¯·æ±‚è¯¥äº¤ç»™å“ªä¸ªæœåŠ¡å™¨ï¼Œè¿™å°±æ˜¯å®ç°äº†æœåŠ¡å™¨è´Ÿè½½å‡è¡¡ï¼Œå¯ä»¥å°†è¯·æ±‚è½¬å‘åˆ°æ¯”è¾ƒç©ºé—²çš„æœåŠ¡å™¨æ¥å“åº”ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä»£ç†æœåŠ¡å™¨å°±æ˜¯ç›¸å¯¹äºå®¢æˆ·ç«¯çš„æœåŠ¡å™¨ï¼Œå› ä¸ºæ­¤æ—¶å®¢æˆ·ç«¯ä¹Ÿä¸çŸ¥é“è¯·æ±‚äº¤ç»™äº†å“ªä¸ªæœåŠ¡å™¨ã€‚</li></ul><p>æˆ‘æ‰€ç†è§£çš„æ­£å‘ä»£ç†å’Œåå‘ä»£ç†å°±æ˜¯è¿™ä¸ªæ„æ€ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿ä¸‹æ–¹è¯„è®ºã€‚</p><h3 id="proxy-pass"><a href="#proxy-pass" class="headerlink" title="proxy_pass"></a>proxy_pass</h3><p>é‚£ä¹ˆnginxä½¿ç”¨çš„å°±æ˜¯<code>proxy_pass</code>å±æ€§æ¥è¿›è¡Œåå‘ä»£ç†çš„å¤„ç†ï¼Œä½¿ç”¨ä¹Ÿæ˜¯å¾ˆç®€å•ã€‚ä¸‹é¢ä»¥nodejså¼€å¯ä¸€ä¸ªå»ºç«‹åœ¨ localhost:4000 çš„æœåŠ¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>)</span>&#123;</span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>&#125;);</span><br><span class="line">    res.end(<span class="string">'server 4000'</span>);</span><br><span class="line">&#125;).listen(<span class="number">4000</span>);</span><br></pre></td></tr></table></figure><p>è¯·æ±‚ <code>localhost:4000</code> å¯ä»¥æ‰“å¼€æˆ‘ä»¬çš„é¡µé¢</p><p><img src="http://static.zybuluo.com/shenweizheng/pdz5sg6oeac5ui35uf7oft28/image_1disp1dvl1fii1dhj1dlk1qrnbuj9.png" alt="image_1disp1dvl1fii1dhj1dlk1qrnbuj9.png-13.8kB"></p><p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å°† <code>localhost:5000</code>çš„æ‰€æœ‰è¯·æ±‚éƒ½ä»£ç†åˆ°4000è¿™ä¸ªserveré‡Œï¼Œè¿™æ ·å°±ä¼šå‡ºç°æˆ‘ä»¬è®¿é—®5000å’Œè®¿é—®4000ä¸€æ ·çš„æ•ˆæœã€‚å…·ä½“é…ç½®å¦‚ä¸‹</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="comment"># ç›‘å¬ localhost:5000</span></span><br><span class="line">        <span class="attribute">listen</span>     <span class="number">5000</span>;</span><br><span class="line">        <span class="attribute">server_name</span> localhost;</span><br><span class="line">        <span class="comment"># / è¡¨ç¤ºåŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šç»è¿‡è¿™ä¸ªè¿‡æ»¤å™¨</span></span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">            <span class="comment"># è®¾å®šè¯·æ±‚è½¬å‘çš„åœ°å€</span></span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:4000;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™è¾¹éœ€è¦æ³¨æ„çš„æ˜¯ <code>proxy_pass</code> çš„å†™æ³•ï¼Œå¿…é¡»æ˜¯<code>http://</code>æˆ–è€…<code>https://</code>å¼€å¤´çš„ï¼Œhttpå¤´æ˜¯ä¸èƒ½çœçš„ã€‚</p><p>è¯·æ±‚5000ç«¯å£æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="http://static.zybuluo.com/shenweizheng/ej0dbxfapbx9f29dhvknejxq/image_1dispgpetav110mb1tqkf718ufm.png" alt="image_1dispgpetav110mb1tqkf718ufm.png-15.9kB"></p><h3 id="æœ¬åœ°ä»£ç†è‡³ç™¾åº¦"><a href="#æœ¬åœ°ä»£ç†è‡³ç™¾åº¦" class="headerlink" title="æœ¬åœ°ä»£ç†è‡³ç™¾åº¦"></a>æœ¬åœ°ä»£ç†è‡³ç™¾åº¦</h3><p>ä¸Šæ–¹çš„ä¾‹å­è¿‡äºç®€å•ï¼Œé‚£ä¹ˆè¿™ä¸€ä¸ªå’Œä¸Šé¢çš„æœ‰ç‚¹ç±»ä¼¼ï¼Œè¿™æ¬¡æ˜¯å°†4000çš„ç«¯å£å·ä»£ç†åˆ°<code>www.baidu.com</code>ã€‚ä¿®æ”¹ä¸€ä¸‹<code>proxy_pass</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="comment"># ç›‘å¬ localhost:5000</span></span><br><span class="line">        <span class="attribute">listen</span>     <span class="number">5000</span>;</span><br><span class="line">        <span class="attribute">server_name</span> localhost;</span><br><span class="line">        <span class="comment"># / è¡¨ç¤ºåŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šç»è¿‡è¿™ä¸ªè¿‡æ»¤å™¨</span></span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">            <span class="comment"># è®¾å®šè¯·æ±‚è½¬å‘çš„åœ°å€</span></span><br><span class="line">        <span class="attribute">proxy_pass</span> https://www.baidu.com;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥äº†ï¼Œè‡³äºè¿™è¾¹å†™çš„æ˜¯<code>http</code> è¿˜æ˜¯ <code>https</code>ï¼Œè¿™ä¸ªå€’æ˜¯ä¸å½±å“ï¼Œå› ä¸ºç™¾åº¦å†…éƒ¨ä¼šè‡ªåŠ¨å°†<code>http</code>è½¬æˆ<code>https</code>æ¯•ç«Ÿå®‰å…¨å˜›ã€‚</p><h3 id="ç™¾åº¦ä»£ç†è‡³æœ¬åœ°"><a href="#ç™¾åº¦ä»£ç†è‡³æœ¬åœ°" class="headerlink" title="ç™¾åº¦ä»£ç†è‡³æœ¬åœ°"></a>ç™¾åº¦ä»£ç†è‡³æœ¬åœ°</h3><p>é‚£ä¹ˆæŒ‰ç…§åˆšåˆšçš„æ€è·¯å°±æ˜¯ç›‘å¬ <code>www.baidu.com</code> ç„¶åè®¾ç½®ä¸€ä¸‹ <code>proxy_pass</code> ä¸º <code>localhost:4000</code></p><p>é…ç½®å¦‚ä¸‹</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>     <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span> www.baidu.com;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://localhost:4000;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯•ä¸€ä¸‹ï¼Œæ˜¯ä¸æ˜¯æ²¡æœ‰ç”¨ï¼Œæ²¡æœ‰ç”¨å°±å¯¹äº†ã€‚è¦æ˜¯è¿™ä¹ˆè½»æ¾çš„æå®š<code>nginx</code>è¿˜ç©ä¸ªè›‹ã€‚é‚£ä¹ˆè¿™ä¸ªé‡Œé¢åˆæœ‰ç‚¹æ“ä½œäº†ï¼Œå…ˆçœ‹æ­£ç¡®çš„é…ç½®ï¼Œä¿®æ”¹æœ¬åœ°çš„hostsæ–‡ä»¶ï¼Œmacä¸‹çš„æ–‡ä»¶ä½ç½®ä¸º <code>/etc/hosts</code>ä½†æ˜¯éœ€è¦ sudo æ¥è¿›è¡Œä¿®æ”¹ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ–‡ä»¶æ¯”è¾ƒé‡è¦å˜›</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim <span class="regexp">/etc/</span>hosts</span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¸€å¥</p><p><img src="http://static.zybuluo.com/shenweizheng/guwjrur3gs80l7quyukxa71j/image_1div5kqsk1jpe7gg10jg18k01g.png" alt="image_1div5kqsk1jpe7gg10jg18k01g.png-4.1kB"></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>     <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span> baidu.com;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:4000;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬åœ¨æœ¬åœ°å¼€å‘çš„æ—¶å€™æˆ‘ä»¬éƒ½ä¼šä¿®æ”¹æœ¬åœ°çš„<code>hosts</code>æ–‡ä»¶ï¼Œä½†æ˜¯ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜å°±æ˜¯æœ‰çš„æ—¶å€™æ˜¯æœ‰ç”¨çš„æœ‰çš„æ—¶å€™åˆæ²¡ç”¨äº†ï¼Œæˆ‘è¿™è¾¹çš„è§£å†³åŠæ³•æ˜¯ï¼Œæ¯æ¬¡ä¿®æ”¹å®Œ<code>hosts</code>æ–‡ä»¶å°±æ¸…æ¥šæµè§ˆå™¨çš„æµè§ˆæ•°æ®ï¼Œå°¤å…¶æ˜¯ç¼“å­˜è¿™ä¸€å—çš„ä¸œè¥¿ã€‚</p><p><img src="http://static.zybuluo.com/shenweizheng/fj2rw8j3zvjzt43tmmukwrf0/image_1div63u0e1s6j18fgtr11vhq101h1t.png" alt="image_1div63u0e1s6j18fgtr11vhq101h1t.png-105.2kB"></p><p>å¦‚æœé‡åˆ°nginxé…ç½®å®Œå…¨æ­£ç¡®<code>hosts</code>æ–‡ä»¶ä¹Ÿé…ç½®äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰ç”¨ï¼Œä¸å¦¨æ¸…ä¸€ä¸‹ç¼“å­˜ï¼Œè‡³å°‘åœ¨æˆ‘è¿™æ˜¯æ¯æ¬¡éƒ½æ˜¯æ¸…å®Œç¼“å­˜æ‰æœ‰ç”¨çš„ã€‚</p><h2 id="nginxè·¨åŸŸ"><a href="#nginxè·¨åŸŸ" class="headerlink" title="nginxè·¨åŸŸ"></a>nginxè·¨åŸŸ</h2><p>è·¨åŸŸçš„è§£å†³åŠæ³•å°±æ˜¯åœ¨<code>header</code>é‡Œé¢åŠ ä¸Šå…è®¸è·¨åŸŸçš„æºç­‰ä¿¡æ¯</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;  </span><br><span class="line">    add_header <span class="keyword">Access</span>-Control-Allow-Origin *;</span><br><span class="line">    add_header <span class="keyword">Access</span>-Control-Allow-Methods <span class="symbol">'GET</span>, POST, OPTIONS';</span><br><span class="line">    add_header <span class="keyword">Access</span>-Control-Allow-Headers <span class="symbol">'DNT</span>,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-<span class="keyword">With</span>,<span class="keyword">If</span>-Modified-Since,Cache-Control,Content-<span class="keyword">Type</span>,Authorization';</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($request_method = <span class="symbol">'OPTIONS</span>') &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">204</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åœ¨å®é™…é¡¹ç›®é‡Œã€‚<code>origin</code>è¿˜æ˜¯ä¸è¦è®¾ç½®ä¸º<code>*</code>æ¯”è¾ƒå¥½ï¼Œå› ä¸ºå‰ç«¯ä½¿ç”¨axiosçš„è¯åœ¨è·å–sessionè¿™ä¸€å—ä¼šå‡ºç°é—®é¢˜ã€‚</p><h2 id="nginxç¼“å­˜"><a href="#nginxç¼“å­˜" class="headerlink" title="nginxç¼“å­˜"></a>nginxç¼“å­˜</h2><blockquote><p>è¿™è¾¹æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œnginxä½œä¸ºé™æ€èµ„æºæœåŠ¡å™¨çš„æ—¶å€™æ˜¯ä¸åšç¼“å­˜çš„ï¼Œåªæœ‰å½“nginxè¿›è¡Œåå‘ä»£ç†çš„æ—¶å€™æ‰å…·å¤‡ç¼“å­˜è¿™ä¸ªåŠŸèƒ½ã€‚æˆ‘ä¸€å¼€å§‹å†™äº†åŠå¤©å‘ç°é¸Ÿç”¨éƒ½æ²¡æœ‰ï¼Œæœ€åæ‰å‘ç°åªæœ‰åšä»£ç†çš„æ—¶å€™æ‰å…·å¤‡ç¼“å­˜ã€‚</p></blockquote><p>å„å¤§æµè§ˆå™¨æœ¬èº«å·²ç»å…·æœ‰ç¼“å­˜äº†ï¼Œæ¯”å¦‚è¯´è°·æ­Œï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªhtmlï¼Œç„¶ååœ¨htmlå¼•å…¥ä¸€å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹æµè§ˆå™¨æ˜¯æ€ä¹ˆå¯¹å›¾ç‰‡è¿™äº›é™æ€èµ„æºè¿›è¡Œç¼“å­˜çš„ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./static/test.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªhtmlä»£ç æˆ‘ä½¿ç”¨<code>http-server</code>éƒ¨ç½²åœ¨äº†<code>http-server -a 127.0.0.1 -p 4000</code>å¯ä»¥çœ‹å‡ºæ˜¯åœ¨<code>127.0.0.1 4000</code>ç«¯å£ã€‚</p><p>è¿™æ˜¯é¦–æ¬¡åŠ è½½çš„æ—¶å€™çš„çŠ¶å†µ</p><p><img src="http://static.zybuluo.com/shenweizheng/9q4w4k01dez4fpr3s5nfp96p/image_1div6rf381gma14094n10vib32q.png" alt="image_1div6rf381gma14094n10vib32q.png-31.3kB"></p><p>åˆ·æ–°ä¸€ä¸‹</p><p><img src="http://static.zybuluo.com/shenweizheng/5rep6dzl2or6zjqe66yxy4xy/image_1div6slsb1niq1atp1oonksd1ubt37.png" alt="image_1div6slsb1niq1atp1oonksd1ubt37.png-28.4kB"></p><p>é‚£ä¹ˆåŒºåˆ«è¿˜æ˜¯å¾ˆå¤§çš„</p><ul><li><code>html</code>æ–‡ä»¶çš„çŠ¶æ€ç ä»200åˆ°304ï¼Œ304çŠ¶æ€ç è¡¨æ˜è¯¥æ–‡ä»¶æ˜¯ä»ç¼“å­˜ä¸­è¯»å–</li><li><code>jpg</code>æ–‡ä»¶å¯ä»¥å‘ç°åœ¨<code>size</code>è¿™ä¸€åˆ—ï¼Œå¤šäº†ä¸€ä¸ª<code>memory cache</code>ï¼Œè¿™è¡¨æ˜è¿™ä¸ªå›¾ç‰‡æ˜¯ä»æµè§ˆå™¨ç¼“å­˜ä¸­è¯»å–çš„</li><li>å„ä¸ªæ–‡ä»¶çš„åŠ è½½äº‹ä»¶æ˜æ˜¾å‡å°‘ï¼Œå°¤å…¶æ˜¯å›¾ç‰‡</li></ul><p>å¯èƒ½æœ‰çš„äººä¼šå‘ç°ç¬¬ä¸€æ¬¡åŠ è½½çš„æ—¶å€™ï¼Œæ˜¾ç¤ºçš„æ˜¯<code>from desk cache</code>ï¼Œé‚£ä¹ˆchromeæµè§ˆå™¨çš„ç¼“å­˜åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ç£ç›˜ç¼“å­˜ä¸€ç§æ˜¯å†…å­˜ç¼“å­˜ï¼Œ</p><p>å®˜æ–¹æ–‡æ¡£ï¼š</p><blockquote><p>Chrome employs two caches â€” an on-disk cache and a very fast in-memory cache. The lifetime of an in-memory cache is attached to the lifetime of a render process, which roughly corresponds to a tab. Requests that are answered from the in-memory cache are invisible to the web request API. If a request handler changes its behavior (for example, the behavior according to which requests are blocked), a simple page refresh might not respect this changed behavior. To make sure the behavior change goes through, call handlerBehaviorChanged() to flush the in-memory cache. But donâ€™t do it often; flushing the cache is a very expensive operation. You donâ€™t need to call handlerBehaviorChanged() after registering or unregistering an event listener.</p></blockquote><p>å¤§æ¦‚æ„æ€å°±æ˜¯ï¼šchromeæœ‰ä¸¤ç§ç¼“å­˜ï¼Œä¸€ç§æ˜¯<code>desk cache</code>ä¸€ç§æ˜¯<code>memory cache</code>ï¼Œç„¶å<code>memory cache</code>çš„æ•ˆç‡é«˜äºå‰è€…ã€‚</p><p>é‚£ä¹ˆæ‰“å¼€chrome devtoolsç‚¹å¼€å›¾ç‰‡å¯ä»¥å‘ç°</p><p><img src="http://static.zybuluo.com/shenweizheng/q9u7y601st5mogf7kuh24cfv/image_1div7hhk3no5hfq1jft2j41t43k.png" alt="image_1div7hhk3no5hfq1jft2j41t43k.png-39.4kB"></p><p>åœ¨<code>cache-control</code>åé¢æœ‰ä¸€ä¸ª<code>max-age</code>ï¼Œé‚£ä¹ˆå…·ä½“çš„æœ‰å…³ç¼“å­˜çš„æŠ€æœ¯è¿™è¾¹å°±ä¸è¯´äº†æˆ‘å›å¤´æ•´ç†ä¸€ä¸‹</p><p>é‚£ä¹ˆé’ˆå¯¹ä¸åŒç±»å‹çš„æ–‡ä»¶è¿›è¡Œç¼“å­˜è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œéœ€è¦æ³¨æ„çš„åœ¨äº<code>location</code>çš„æ­£åˆ™åŒ¹é…</p><p>é‚£ä¹ˆç¬¬ä¸€ç§æœ€ç®€å•çš„ç¼“å­˜ï¼Œå°±æ˜¯ç›´æ¥è®¾ç½®<code>expires ç¼“å­˜æ—¶é—´</code></p><h3 id="è®¾ç½®expires"><a href="#è®¾ç½®expires" class="headerlink" title="è®¾ç½®expires"></a>è®¾ç½®<code>expires</code></h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">location</span> <span class="regexp">~ .*\.(jpg|png)$</span> &#123;</span><br><span class="line"><span class="attribute">proxy_pass</span> http://127.0.0.1:4000;</span><br><span class="line">    <span class="attribute">expires</span> <span class="number">3m</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/rfve3ikhd0makef97uluzfdm/image_1div8c7nk1jv05ds1tvo1a7n1bm841.png" alt="image_1div8c7nk1jv05ds1tvo1a7n1bm841.png-44.2kB"></p><p><code>expires</code>æ˜¯ä»¥ç§’ä¸ºå•ä½çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¾ç½®ä¸º<code>3m</code> ä¹Ÿå°±æ˜¯180ç§’ï¼Œå‘ç°ç¡®å®æ˜¯å¯ä»¥çš„ã€‚</p><h3 id="proxy-cache-path-çš„ä½¿ç”¨"><a href="#proxy-cache-path-çš„ä½¿ç”¨" class="headerlink" title="proxy_cache_path çš„ä½¿ç”¨"></a>proxy_cache_path çš„ä½¿ç”¨</h3><p>é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæˆ‘ä»¬çš„nginxç¼“å­˜ç›®å½•ï¼Œé€šè¿‡proxy_cache_path å±æ€§</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">proxy_cache_path</span> /tmp/cache/test levels=<span class="number">1</span>:<span class="number">2</span> keys_zone=my_cache:<span class="number">10m</span> max_size=<span class="number">10g</span> inactive=<span class="number">60m</span> use_temp_path=<span class="literal">off</span>;</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~ .*\.(jpg|png)$</span> &#123;</span><br><span class="line"> <span class="attribute">proxy_pass</span> http://127.0.0.1:4000;</span><br><span class="line"> <span class="attribute">proxy_cache</span> my_cache;</span><br><span class="line"> <span class="attribute">proxy_cache_valid</span> <span class="number">200</span> <span class="number">304</span> <span class="number">1y</span>;</span><br><span class="line"> <span class="attribute">proxy_cache_valid</span> any <span class="number">1m</span>;</span><br><span class="line"> <span class="attribute">expires</span> <span class="number">1y</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>proxy_cache_path æ‰§è¡Œç¼“å­˜æ–‡ä»¶çš„ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰çš„è¯éœ€è¦æå‰åˆ›å»ºï¼Œä¸ç„¶nginxä¼šæŠ¥é”™</li><li>levels é‡‡ç”¨2çº§ç›®å½•æ¥å­˜å‚¨</li><li>key_zone åœ¨å…±äº«å†…å­˜ä¸­è®¾ç½®ä¸€å—å­˜å‚¨åŒºåŸŸæ¥å­˜æ”¾ç¼“å­˜çš„keyå’Œmetadataï¼ˆç±»ä¼¼ä½¿ç”¨æ¬¡æ•°ï¼‰ï¼Œè¿™æ ·nginxå¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªrequestæ˜¯å¦å‘½ä¸­æˆ–è€…æœªå‘½ä¸­ç¼“å­˜ï¼Œ1må¯ä»¥å­˜å‚¨8000ä¸ªkeyï¼Œ10må¯ä»¥å­˜å‚¨80000ä¸ªkey</li><li>max_size æœ€å¤§cacheç©ºé—´ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œä¼šä½¿ç”¨æ‰æ‰€æœ‰disk spaceï¼Œå½“è¾¾åˆ°é…é¢åï¼Œä¼šåˆ é™¤æœ€å°‘ä½¿ç”¨çš„cacheæ–‡ä»¶</li><li>inactive æœªè¢«è®¿é—®æ–‡ä»¶åœ¨ç¼“å­˜ä¸­ä¿ç•™æ—¶é—´ï¼Œåœ¨æŒ‡å®šæ—¶é—´å†…æœªè¢«è®¿é—®çš„æ–‡ä»¶ä¼šè¢«åˆ é™¤</li><li>use_temp_path å¦‚æœä¸ºoffï¼Œåˆ™nginxä¼šå°†ç¼“å­˜æ–‡ä»¶ç›´æ¥å†™å…¥æŒ‡å®šçš„cacheæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯ä½¿ç”¨temp_pathå­˜å‚¨ï¼Œofficialå»ºè®®ä¸ºoffï¼Œé¿å…æ–‡ä»¶åœ¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿä¸­ä¸å¿…è¦çš„æ‹·è´ï¼›</li><li>proxy_cache å¯ç”¨proxy cacheï¼Œå¯¹åº”ç€é…ç½®çš„key_zone;</li><li>proxy_cache_valid æ ¹æ®ä¸åŒçš„çŠ¶æ€ç è®¾ç½®ä¸åŒçš„ç¼“å­˜æ—¶é—´</li></ul><p>å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹<code>nginx</code>è¿›ç¨‹ï¼Œä¼šå‘ç°è¿™ä¸ªæ—¶å€™æ˜¯æœ‰ç¼“å­˜çš„è¿›ç¨‹åœ¨å¼€ç€çš„ã€‚</p><p><img src="http://static.zybuluo.com/shenweizheng/stieixi5zmk6iemyo0h7gjzt/image_1div91gppe5h1n0gh751eqv13u54e.png" alt="image_1div91gppe5h1n0gh751eqv13u54e.png-75.1kB"></p><p>è¿™è¾¹å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„å›¾ç‰‡çš„ç¼“å­˜æ—¶é—´å·²ç»è¢«è®¾ç½®ä¸º1å¹´</p><p><img src="http://static.zybuluo.com/shenweizheng/k8jfc8inqt864uvifo3qe98e/image_1div9h7o75lk4vgdqv1iidk5v4r.png" alt="image_1div9h7o75lk4vgdqv1iidk5v4r.png-45.4kB"></p><h3 id="locationåŒ¹é…ä¼˜å…ˆçº§"><a href="#locationåŒ¹é…ä¼˜å…ˆçº§" class="headerlink" title="locationåŒ¹é…ä¼˜å…ˆçº§"></a>locationåŒ¹é…ä¼˜å…ˆçº§</h3><p>åœ¨ç¼“å­˜ä¸­éœ€è¦æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯locationçš„åŒ¹é…è§„åˆ™å’Œä¼˜å…ˆçº§</p><ul><li>= å¼€å¤´è¡¨ç¤ºç²¾ç¡®åŒ¹é…</li><li>^~ å¼€å¤´è¡¨ç¤ºuriä»¥æŸä¸ªå¸¸è§„å­—ç¬¦ä¸²å¼€å¤´ï¼Œä¸æ˜¯æ­£åˆ™åŒ¹é…;</li><li>~ å¼€å¤´è¡¨ç¤ºåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…;</li><li>~* å¼€å¤´è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…;</li><li>/ é€šç”¨åŒ¹é…, å¦‚æœæ²¡æœ‰å…¶å®ƒåŒ¹é…,ä»»ä½•è¯·æ±‚éƒ½ä¼šåŒ¹é…åˆ°;</li></ul><h2 id="upstreamè´Ÿè½½å‡è¡¡"><a href="#upstreamè´Ÿè½½å‡è¡¡" class="headerlink" title="upstreamè´Ÿè½½å‡è¡¡"></a>upstreamè´Ÿè½½å‡è¡¡</h2><p>è´Ÿè½½å‡è¡¡æ˜¯nginxçš„å¦ä¸€å¤§ç‰¹ç‚¹ï¼Œå¯ä»¥é…ç½®å¤šä¸ªæœåŠ¡å™¨ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°æœ€åˆé€‚çš„é‚£å°æœåŠ¡å™¨ï¼Œé¿å…æŸä¸€å°æœåŠ¡å™¨è¯·æ±‚å¤ªå¤šè€Œå´©æºƒã€‚ä½¿ç”¨<code>upstream</code>å±æ€§æ¥é…ç½®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">upstream</span> favtomcat &#123;</span><br><span class="line">       <span class="attribute">server</span> <span class="number">192.168.1.100:4000</span>;</span><br><span class="line">       <span class="attribute">server</span> <span class="number">192.168.1.111:5000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line">            <span class="attribute">root</span>   html;</span><br><span class="line">            <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">            <span class="comment"># å¯¹åº”ä¸Šæ–¹çš„ favtomcat</span></span><br><span class="line">            <span class="attribute">proxy_pass</span> http://favtomcat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æœ€åŸºç¡€çš„è´Ÿè½½å‡è¡¡é…ç½®ï¼Œé‡‡ç”¨çš„æ˜¯<code>è½®è¯¢</code>çš„ç­–ç•¥è¿›è¡Œè´Ÿè½½ï¼Œæ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œé€‚ç”¨äºå›¾ç‰‡æœåŠ¡å™¨é›†ç¾¤å’Œçº¯é™æ€é¡µé¢æœåŠ¡å™¨é›†ç¾¤ã€‚<br>ä¼˜ç‚¹ï¼š æ–¹å¼ç®€ä¾¿ã€æˆæœ¬ä½å»‰<br>ç¼ºç‚¹ï¼š å¯é æ€§ä½å’Œè´Ÿè½½åˆ†é…ä¸å‡è¡¡</p><p>é‚£ä¹ˆ<code>upstream</code>è¿˜æœ‰å…¶ä»–çš„è´Ÿè½½ç­–ç•¥</p><h3 id="weightæƒé‡"><a href="#weightæƒé‡" class="headerlink" title="weightæƒé‡"></a>weightæƒé‡</h3><p>å¯ä»¥ç»™æ¯ä¸€å°æœåŠ¡å™¨è®¾ç½®ä¸€ä¸ªæƒé‡ï¼Œè¿™æ ·æƒé‡é«˜çš„å¹²çš„æ´»ä¹Ÿå°±ä¼šå¤šä¸€ç‚¹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">upstream favtomcat &#123;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.100:4000 <span class="attribute">weight</span>=5;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.111:5000 <span class="attribute">weight</span>=10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ip-hash"><a href="#ip-hash" class="headerlink" title="ip_hash"></a>ip_hash</h3><p>è¿™ç§æ–¹å¼æ˜¯åŸºäºå®¢æˆ·ç«¯çš„ipåœ°å€ï¼Œé‡‡ç”¨hashç®—æ³•è®¡ç®—ä¸‹ä¸€ä¸ªè¯·æ±‚è¦é€‰æ‹©å“ªä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·å›ºå®šçš„ipä¼šè®¿é—®åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessioné—®é¢˜</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">upstream favtomcat &#123;</span><br><span class="line">       ip_hash;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.100:4000;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.111:5000;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="least-connæœ€å°‘é“¾æ¥"><a href="#least-connæœ€å°‘é“¾æ¥" class="headerlink" title="least_connæœ€å°‘é“¾æ¥"></a>least_connæœ€å°‘é“¾æ¥</h3><p>ä¼šå°†ä¸‹ä¸€ä¸ªè¯·æ±‚åˆ†å‘åˆ°å½“å‰é“¾æ¥æ•°æœ€å°‘çš„ä¸€å°æœåŠ¡å™¨<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">upstream favtomcat &#123;</span><br><span class="line">       least_conn;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.100:4000;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.111:5000;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="fair"><a href="#fair" class="headerlink" title="fair"></a>fair</h3><p>æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">upstream favtomcat &#123;</span><br><span class="line">       fair;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.100:4000;</span><br><span class="line">      <span class="built_in"> server </span>192.168.1.111:5000;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="url-hash"><a href="#url-hash" class="headerlink" title="url_hash"></a>url_hash</h3><p>æŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">upstream backserver &#123; </span><br><span class="line">   <span class="built_in"> server </span>squid1:3128; </span><br><span class="line">   <span class="built_in"> server </span>squid2:3128; </span><br><span class="line">    hash <span class="variable">$request_uri</span>; </span><br><span class="line">    hash_method crc32; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å‚è€ƒ<br><a href="https://juejin.im/post/59f94f626fb9a045023af34cï¼›" target="_blank" rel="noopener">https://juejin.im/post/59f94f626fb9a045023af34cï¼›</a><br><a href="https://www.jianshu.com/p/625c2b15dad5" target="_blank" rel="noopener">Nginx Proxy CacheåŸç†å’Œæœ€ä½³å®è·µ</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>node.js Expressæ¡†æ¶ä¸­ä½¿ç”¨websoecket åŒ…å« ts å’Œ é ts ç¯å¢ƒ</title>
      <link href="/2019/08/19/node.js%20Express%E6%A1%86%E6%9E%B6%E4%B8%AD%E4%BD%BF%E7%94%A8websoecket%20%E5%8C%85%E5%90%AB%20ts%20%E5%92%8C%20%E9%9D%9E%20ts%20%E7%8E%AF%E5%A2%83/"/>
      <url>/2019/08/19/node.js%20Express%E6%A1%86%E6%9E%B6%E4%B8%AD%E4%BD%BF%E7%94%A8websoecket%20%E5%8C%85%E5%90%AB%20ts%20%E5%92%8C%20%E9%9D%9E%20ts%20%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<blockquote><p>websocketæ˜¯å•¥æˆ‘å°±ç®€å•çš„è¯´ä¸€ä¸‹ï¼Œè¿™ä¸ªå¤§å®¶çŸ¥é“çš„åº”è¯¥æŒºå¤šçš„ã€‚é‚£ä¹ˆé¦–å…ˆå®ƒæ˜¯ä¸€ä¸ªåè®®ï¼Œç±»ä¼¼äºæˆ‘ä»¬çš„HTTPåè®®ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯HTTPåè®®æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨ç«¯å“åº”å¹¶ä¸”åªèƒ½å“åº”ä¸€æ¬¡ï¼Œä½†æ˜¯æ— æ³•åšåˆ°æœåŠ¡å™¨ç«¯ä¸»åŠ¨å‘æµè§ˆå™¨ç«¯æ¨é€æ•°æ®ã€‚é‚£ä¹ˆwebsocketä¸»è¦å°±æ˜¯è§£å†³æœåŠ¡å™¨ç«¯æ— æ³•å‘å®¢æˆ·ç«¯ä¸»åŠ¨æ¨é€æ•°æ®çš„ã€‚å½“æˆ‘ä»¬éœ€è¦ä¿æŒä¸€ç§é•¿é“¾æ¥æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°websocket<br>ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼šæµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šç»å†å¤§é‡çš„è®¡ç®—ï¼Œå¹¶ä¸”è¿”å›ç»™æµè§ˆå™¨å½“å‰è®¡ç®—åˆ°äº†å“ªä¸€æ­¥ï¼Œè¿™ä¸ªæ—¶å€™æµè§ˆå™¨å°±å¯ä»¥å±•ç¤ºä¸€ä¸ªå¼¹çª—å‘Šè¯‰ç”¨æˆ·å½“å‰å·²ç»åˆ°äº†å“ªä¸€æ­¥ï¼Œé€‚å½“çš„æ›´å¯ä»¥å±•ç¤ºä¸€ä¸ªè¿›åº¦æ¡ï¼Œé¿å…ç”¨æˆ·å› ä¸ºè¯·æ±‚æ—¶é—´å¤ªé•¿çœ‹ä¹…äº†loadingä¹Ÿä¼šè…»ä¸æ˜¯ã€‚<br>å®ƒçš„ä¸»è¦ç‰¹ç‚¹å°±æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯<br>ç‰¹ç‚¹åŒ…æ‹¬ï¼š<br>ï¼ˆ1ï¼‰å»ºç«‹åœ¨ TCP åè®®ä¹‹ä¸Šï¼ŒæœåŠ¡å™¨ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“ã€‚<br>ï¼ˆ2ï¼‰ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯80å’Œ443ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ HTTP åè®®ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ã€‚<br>ï¼ˆ3ï¼‰æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œé€šä¿¡é«˜æ•ˆã€‚<br>ï¼ˆ4ï¼‰å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®ã€‚<br>ï¼ˆ5ï¼‰æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡ã€‚<br>ï¼ˆ6ï¼‰åè®®æ ‡è¯†ç¬¦æ˜¯wsï¼ˆå¦‚æœåŠ å¯†ï¼Œåˆ™ä¸ºwssï¼‰ï¼ŒæœåŠ¡å™¨ç½‘å€å°±æ˜¯ URLã€‚</p></blockquote><a id="more"></a><h2 id="æœåŠ¡å™¨ç«¯"><a href="#æœåŠ¡å™¨ç«¯" class="headerlink" title="æœåŠ¡å™¨ç«¯"></a>æœåŠ¡å™¨ç«¯</h2><p>è¿™è¾¹æ˜¯ç”¨node.js çš„expressæ¡†æ¶è¿›è¡Œæ“ä½œ,ä½¿ç”¨<code>express-ws</code>æ’ä»¶</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm <span class="selector-tag">i</span> -S express-ws</span><br></pre></td></tr></table></figure><h3 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h3><p>ä½¿ç”¨express-wsæ’ä»¶å¯¹appè¿›è¡Œæ“ä½œï¼Œå¯¹äºä¸æ˜¯tsç¯å¢ƒä¸‹çš„é€šè¿‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> expressWs <span class="keyword">from</span> <span class="string">'express-ws'</span>;</span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app = expressWs(app);</span><br></pre></td></tr></table></figure><p>å¯¹äº ts ç¯å¢ƒä¸‹çš„æ“ä½œ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> express <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> expressWs <span class="keyword">from</span> <span class="string">'express-ws'</span>;</span><br><span class="line"><span class="keyword">const</span> appBase = express();</span><br><span class="line"><span class="comment">// å¼•å…¥ websocket</span></span><br><span class="line"><span class="keyword">let</span> wsInstance = expressWs(appBase);</span><br><span class="line"><span class="keyword">let</span> &#123; app &#125; = wsInstance;</span><br></pre></td></tr></table></figure></p><p>è·å–åˆ°å®ä¾‹ä¹‹åï¼Œå¯ä»¥é€šè¿‡app.wsè¿›è¡Œæ“ä½œäº†</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> è®¾ç½®websocket</span><br><span class="line">app.ws(<span class="string">'/autoSchedule'</span>, <span class="function"><span class="params">(ws, req)</span> =&gt;</span> &#123;</span><br><span class="line">    ws.send(<span class="string">'å·²è¿æ¥'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¹‹å‰çœ‹åˆ°æœ‰è¯´å¯ä»¥é€šè¿‡routerè¿›è¡Œä½¿ç”¨wsï¼Œå› ä¸ºrouterç›¸å½“äºä¸€ä¸ªmini çš„appå®ä¾‹ï¼Œä½†æ˜¯æˆ‘åœ¨tsç¯å¢ƒä¸‹è¯•äº†å¾ˆå¤šæ¬¡éƒ½æ²¡æœ‰æˆåŠŸ,æ¯”å¦‚è¯´ä¸€ä¸‹ä»£ç <br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> expres <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> expressWs <span class="keyword">from</span> <span class="string">'express-ws'</span>;</span><br><span class="line">const router = expressWs(express().Router());</span><br><span class="line">router.ws(<span class="string">'/autoSchedule'</span>, <span class="function"><span class="params">(ws, req)</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>è¿™ç§æ–¹å¼ä¹Ÿæ˜¯éœ€è¦appåš<code>expressWS(app)</code>æ“ä½œçš„ã€‚ä½†æ˜¯åœ¨tsä¸‹æˆ‘æ²¡æœ‰è¯•æˆåŠŸè¿‡ï¼Œä¸€ç›´åŒ…çš„æ˜¯routeræ²¡æœ‰wsæ–¹æ³•ï¼Œæˆ–è€…æ˜¯<code>expressWs(express().Router())</code>æ“ä½œæ—¶è¯´routerä¸æ˜¯ä¸€ä¸ªappå®ä¾‹ã€‚æ€»ä¹‹å¾ˆç¥å¥‡ã€‚é‚£ä¹ˆæˆ‘é‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼Œå°†æˆ‘çš„ä¸šåŠ¡ä»£ç å°è£…æˆä¸€ä¸ªå¤§çš„å‡½æ•°ç„¶åé€šè¿‡æ¨¡å—å¯¼å‡ºï¼Œåœ¨app.tsæ–‡ä»¶ä¸‹å¼•ç”¨ä½¿ç”¨ï¼Œè¿™ä¸ªæ“ä½œçš„å…³é”®åœ¨äºéœ€è¦å°†<code>app.ws(&#39;/autoSchedule&#39;,(ws: any, req: any))</code>å›è°ƒå‡½æ•°ä¸­çš„wsä¼ é€’ç»™è¯¥å‡½æ•°ï¼Œå·²è¾¾åˆ°æ¨¡å—åˆ’åˆ†çš„ç›®çš„.</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.ts</span></span><br><span class="line"><span class="comment">// å¼•å…¥å°è£…å¥½çš„å‡½æ•°æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> scheduleWs <span class="keyword">from</span> <span class="string">'./src/util/autoSchedule'</span>;</span><br><span class="line"><span class="comment">// è®¾ç½®websocket</span></span><br><span class="line">app.ws(<span class="string">'/autoSchedule'</span>, <span class="function">(<span class="params">ws: <span class="built_in">any</span>, req: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å°† ws ä¼ é€’ç»™å‡½æ•°</span></span><br><span class="line">    scheduleWs(ws);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">util/autoSchedule.ts</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (ws: any) =&gt; &#123;</span><br><span class="line">    ws.send(<span class="string">'å¼€å§‹è°ƒç”¨'</span>);</span><br><span class="line">    <span class="comment">// ä¸šåŠ¡ä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰¹åˆ«è¯´æ˜"><a href="#ç‰¹åˆ«è¯´æ˜" class="headerlink" title="ç‰¹åˆ«è¯´æ˜"></a>ç‰¹åˆ«è¯´æ˜</h2><p>websocketåœ¨æ‰§è¡Œ<code>send</code>æ–¹æ³•ï¼Œå‘é€ä¿¡æ¯çš„æ—¶å€™ï¼Œ<code>send</code>å‡½æ•°çš„å‚æ•°åªæ”¯æŒå­—ç¬¦ä¸²ã€äºŒè¿›åˆ¶æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä¸€èˆ¬ä¼šå°†æ‰€éœ€è¦çš„æ•°æ®è½¬æˆ JSONå­—ç¬¦ä¸²ï¼Œç„¶ååœ¨å‰ç«¯åœ¨è§£æï¼Œä¾‹å¦‚</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœåŠ¡å™¨ç«¯</span></span><br><span class="line"><span class="selector-tag">ws</span><span class="selector-class">.send</span>(JSON.stringify(&#123;</span><br><span class="line">    <span class="attribute">code</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attribute">msg</span>: <span class="string">'å¼€å§‹è°ƒåº¦'</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®¢æˆ·ç«¯</span></span><br><span class="line">ws.onmessage = <span class="function">(<span class="params">e: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> res: <span class="built_in">any</span> = <span class="built_in">JSON</span>.parse(e.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œå…¨éƒ¨ä»»åŠ¡æ—¶ï¼Œè®°å¾—å…³é—­socketè¿æ¥<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.close()<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><h2 id="å®¢æˆ·ç«¯çš„API"><a href="#å®¢æˆ·ç«¯çš„API" class="headerlink" title="å®¢æˆ·ç«¯çš„API"></a>å®¢æˆ·ç«¯çš„API</h2><h3 id="websocketå®ä¾‹åŒ–"><a href="#websocketå®ä¾‹åŒ–" class="headerlink" title="websocketå®ä¾‹åŒ–"></a>websocketå®ä¾‹åŒ–</h3><p>websocketåè®®çš„æ¥å£åœ°å€æ˜¯ä»¥ ws å¼€å¤´</p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:3000/autoSchedule'</span>);</span><br></pre></td></tr></table></figure><h3 id="websocket-çš„çŠ¶æ€"><a href="#websocket-çš„çŠ¶æ€" class="headerlink" title="websocket çš„çŠ¶æ€"></a>websocket çš„çŠ¶æ€</h3><ul><li>CONNECTINGï¼šå€¼ä¸º0ï¼Œè¡¨ç¤ºæ­£åœ¨è¿æ¥</li><li>OPENï¼šå€¼ä¸º1ï¼Œè¡¨ç¤ºè¿æ¥æˆåŠŸï¼Œå¯ä»¥é€šä¿¡äº†</li><li>CLOSINGï¼šå€¼ä¸º2ï¼Œè¡¨ç¤ºè¿æ¥æ­£åœ¨å…³é—­</li><li>CLOSEDï¼šå€¼ä¸º3ï¼Œè¡¨ç¤ºè¿æ¥å·²ç»å…³é—­ï¼Œæˆ–è€…æ‰“å¼€è¿æ¥å¤±è´¥</li></ul><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (ws.readyState) &#123;</span><br><span class="line">  <span class="keyword">case</span> WebSocket.<span class="string">CONNECTING:</span></span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> WebSocket.<span class="string">OPEN:</span></span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> WebSocket.<span class="string">CLOSING:</span></span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> WebSocket.<span class="string">CLOSED:</span></span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="symbol">  default:</span></span><br><span class="line">    <span class="comment">// this never happens</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="websocket-open"><a href="#websocket-open" class="headerlink" title="websocket.open"></a>websocket.open</h3><p>ç›‘å¬è¿æ¥å¼€å¯</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.onopen = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å·²è¿æ¥'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="websocket-close"><a href="#websocket-close" class="headerlink" title="websocket.close"></a>websocket.close</h3><p>ç›‘å¬è¿æ¥å…³é—­<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.onclose = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'å·²å…³é—­'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="websocket-onerror"><a href="#websocket-onerror" class="headerlink" title="websocket.onerror"></a>websocket.onerror</h3><p>ç›‘å¬è¿æ¥å‘ç”Ÿé”™è¯¯</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.onerror = <span class="function"><span class="params">(<span class="built_in">error</span>: any)</span> =&gt;</span> &#123;</span><br><span class="line">    console.log(<span class="built_in">error</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="websocket-onmessage"><a href="#websocket-onmessage" class="headerlink" title="websocket.onmessage"></a>websocket.onmessage</h3><p>ç›‘å¬æœåŠ¡å™¨ç«¯å‘æ¥çš„æ¶ˆæ¯</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.onmessage = <span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">    let res = e.data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="websocket-sned"><a href="#websocket-sned" class="headerlink" title="websocket.sned"></a>websocket.sned</h3><p>å‘æœåŠ¡å™¨ç«¯å‘é€æ¶ˆæ¯</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.<span class="built_in">send</span>(<span class="string">'hello world'</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> node.js </tag>
            
            <tag> express </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>AxiosäºŒæ¬¡å°è£…</title>
      <link href="/2019/08/19/Axios%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/"/>
      <url>/2019/08/19/Axios%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<blockquote><p>axiosæ˜¯ä¸€ä¸ªåŸºäºPromiseçš„httpåº“ï¼Œå¯ä»¥ç”¨åœ¨æµè§ˆå™¨å’Œnode.jsä¸­ã€‚åŒæ—¶ä¹Ÿæ˜¯å¯¹åŸç”Ÿæµè§ˆå™¨è¯·æ±‚XMLHttpRequestçš„å°è£…ï¼Œæ”¯æŒPromiseçš„APiè¯·æ±‚ï¼Œé¿å…äº†å›æ‰åœ°ç‹±é—®é¢˜ï¼Œå¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼Œåœ¨å‘å‡ºè¯·æ±‚å‰å¯¹è¯·æ±‚å‚æ•°è¿›è¡Œä¿®æ”¹ï¼Œæ¥å—æœåŠ¡å™¨å“åº”æ—¶ï¼Œä¹Ÿå¯ä»¥æ ¹æ®è¿”å›çš„codeè¿›è¡Œç»Ÿä¸€çš„å¤„ç†ï¼Œä¸”å®¢æˆ·ç«¯æ”¯æŒé˜²å¾¡XSRFã€‚å¯ä»¥å¼€ç®±å³ç”¨ï¼Œä½†æ˜¯åœ¨å®é™…é¡¹ç›®æ—¶ï¼Œéœ€è¦å¯¹axiosè¿›è¡ŒäºŒæ¬¡å°è£…</p></blockquote><a id="more"></a><h2 id="å®ä¾‹-Or-defaults"><a href="#å®ä¾‹-Or-defaults" class="headerlink" title="å®ä¾‹ Or defaults"></a>å®ä¾‹ Or defaults</h2><p>å¯¹ axios è¿›è¡ŒäºŒæ¬¡å°è£…ç”±ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åˆ›å»ºä¸€ä¸ªaxioså®ä¾‹ï¼Œå¦å¤–ä¸€ç§æ˜¯ç›´æ¥ä¿®æ”¹axiosçš„defaults</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import axios from 'axios';</span><br><span class="line">var<span class="built_in"> instance </span>= axios.create(&#123;</span><br><span class="line">  baseURL: 'https://some-domain.com/api/',</span><br><span class="line">  timeout: 1000,</span><br><span class="line">  headers: &#123;'X-Custom-Header': 'foobar'&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line">axios.defaults.baseURL = SERVICE;</span><br></pre></td></tr></table></figure><p>å½“ç„¶åœ¨ä½¿ç”¨ç¬¬ä¸€ç§åˆ›å»ºä¸€ä¸ªå®ä¾‹æ—¶ï¼Œä¹Ÿå¯ä»¥è®¾ç½®è¿™ä¸ªå®ä¾‹çš„defaultsï¼Œå°±åƒè¿™æ ·<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import axios from 'axios';</span><br><span class="line">var<span class="built_in"> instance </span>= axios.create(&#123;</span><br><span class="line">  baseURL: 'https://some-domain.com/api/',</span><br><span class="line">  timeout: 1000,</span><br><span class="line">  headers: &#123;'X-Custom-Header': 'foobar'&#125;</span><br><span class="line">&#125;);</span><br><span class="line">instance.defaults.baseUR<span class="class">L = SERVICE;</span></span><br></pre></td></tr></table></figure></p><h2 id="è®¾ç½®baseURL"><a href="#è®¾ç½®baseURL" class="headerlink" title="è®¾ç½®baseURL"></a>è®¾ç½®baseURL</h2><p>åœ¨å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œå¾€å¾€éœ€è¦å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡æ¥å£°æ˜åå°çš„æ¥å£åœ°å€ï¼Œä¸€èˆ¬æˆ‘ä¼šé€‰æ‹©é€šè¿‡ webpack çš„ definePlugin æ’ä»¶æ¥ç»™é¡µé¢è®¾ç½®å…¨å±€å˜é‡ï¼Œå¹¶ä¸”æ ¹æ®ä¸åŒçš„ç¯å¢ƒä¼ é€’ä¸åŒçš„å€¼ã€‚æ¯”å¦‚è¯´åå°çš„æ¥å£éƒ¨ç½²åœ¨äº† <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a><br>é‚£ä¹ˆé¦–å…ˆä½¿ç”¨ webpack å®šä¹‰ä¸€ä¸ªå« SERVICE çš„å…¨å±€å˜é‡</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">new</span> <span class="selector-tag">webpack</span><span class="selector-class">.DefinePlugin</span>(&#123;</span><br><span class="line">    <span class="attribute">SERVICE</span>: <span class="string">"'http://localhost:3000'"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥åœ¨é¡µé¢ä¸­ä½¿ç”¨è¿™ä¸ªå…¨å±€å˜é‡ï¼Œå½“ç„¶å¦‚æœæ˜¯åœ¨tsé¡¹ç›®ä¸‹çš„è¯ï¼Œç›´æ¥ä½¿ç”¨SERVICEä¼šæŠ±ä¸€ä¸ªæœªå®šä¹‰çš„é”™ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨ä½¿ç”¨SERVICEçš„æ–‡ä»¶ä¸­ç”³æ˜ä¸€ä¸‹å³å¯ï¼Œæœªä½¿ç”¨ts çš„å¯ä»¥è·³è¿‡è¿™å¥å£°æ˜ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="comment">// ts ä¸‹ä½¿ç”¨ éœ€è¦å…ˆå£°æ˜</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> SERVICE: <span class="built_in">string</span>;</span><br><span class="line">axios.defaults.baseURL = SERVICE;</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®Content-type"><a href="#è®¾ç½®Content-type" class="headerlink" title="è®¾ç½®Content-type"></a>è®¾ç½®Content-type</h2><p>åœ¨ post è¯·æ±‚å’Œ put è¯·æ±‚ä¸­ï¼Œéœ€è¦åœ¨è¯·æ±‚å¤´é‡Œè®¾ç½®ä¸€ä¸‹content-type ä¸º application/x-www-form-urlencoded</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.headers.post[<span class="symbol">'Content</span>-<span class="keyword">Type</span>'] = <span class="symbol">'application</span>/x-www-form-urlencoded';</span><br><span class="line">axios.defaults.headers.put[<span class="symbol">'Content</span>-<span class="keyword">Type</span>'] = <span class="symbol">'application</span>/x-www-form-urlencoded';</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®withCredentials"><a href="#è®¾ç½®withCredentials" class="headerlink" title="è®¾ç½®withCredentials"></a>è®¾ç½®withCredentials</h2><p>axioså‘èµ·è¯·æ±‚æ—¶ï¼Œé»˜è®¤æ˜¯ä¸ä¼šæºå¸¦cookieçš„ï¼Œè¿™å°±å¯¼è‡´äº†åœ¨å‰åç«¯åˆ†ç¦»é¡¹ç›®ä¸­ï¼Œåšä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œç™»å½•å®Œä¹‹åè·³è½¬ä¸»é¡µé¢ï¼Œä½†æ˜¯ä¸»é¡µé¢ä¸­è¯·æ±‚çš„æ¥å£æœªæ£€æµ‹åˆ°ç”¨æˆ·å·²ç™»å½•é‚£ä¹ˆå°±ä¼šè·³å›ç™»å½•é¡µé¢ï¼Œå¤§æ¦‚æ—¶è¿™æ ·çš„åœºæ™¯ã€‚é‚£ä¹ˆç¼˜ç”±å°±æ˜¯å› ä¸ºaxiosåœ¨å‘èµ·è¯·æ±‚æ—¶æ˜¯ä¸ä¼šæºå¸¦cookieçš„ï¼Œé€šè¿‡è®¾ç½®withCredentialsä¸ºtrue æ¥è§£å†³</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.defaults.<span class="attr">withCredentials</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><h2 id="è¯·æ±‚æ‹¦æˆª-requestå¤„ç†"><a href="#è¯·æ±‚æ‹¦æˆª-requestå¤„ç†" class="headerlink" title="è¯·æ±‚æ‹¦æˆª requestå¤„ç†"></a>è¯·æ±‚æ‹¦æˆª requestå¤„ç†</h2><p>å¯ä»¥é€šè¿‡å¯¹è¯·æ±‚çš„æ‹¦æˆªï¼Œä¿®æ”¹å‚æ•°ï¼Œå¯¹å‚æ•°è¿›è¡Œåºåˆ—åŒ–å¤„ç†ï¼Œé˜²æ­¢XSRFæ”»å‡»ã€‚åºåˆ—åŒ–ä½¿ç”¨ <code>qs</code>æ¥å®ç°ï¼Œ<code>qs</code>çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å¯¹æ·±å±‚æ¬¡çš„json array ç­‰å¤æ‚ç±»å‹è¿›è¡Œåºåˆ—åŒ–ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.request.use((config: <span class="built_in">any</span>): <span class="function"><span class="params">any</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ç»™è¯·æ±‚æ·»åŠ è¯·æ±‚æ—¶é—´</span></span><br><span class="line">    <span class="keyword">if</span> (config.url.indexOf(<span class="string">'?'</span>) !== <span class="number">-1</span>) &#123;</span><br><span class="line">        config.url += <span class="string">`&amp;t=<span class="subst">$&#123;new Date().getTime()&#125;</span>`</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        config.url += <span class="string">`?t=<span class="subst">$&#123;new Date().getTime()&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// `transformRequest` å…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®</span></span><br><span class="line">    <span class="comment">// åªèƒ½ç”¨åœ¨ 'PUT', 'POST' å’Œ 'PATCH' è¿™å‡ ä¸ªè¯·æ±‚æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// åé¢æ•°ç»„ä¸­çš„å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ– ArrayBufferï¼Œæˆ– Stream</span></span><br><span class="line">    config.transformRequest = [<span class="function">(<span class="params">data: <span class="built_in">any</span>, headers: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(data, &#123;</span><br><span class="line">            allowDots: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// `paramsSerializer` æ˜¯ä¸€ä¸ªè´Ÿè´£ `params` åºåˆ—åŒ–çš„å‡½æ•°</span></span><br><span class="line">    config.paramsSerializer = <span class="function">(<span class="params">params: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(params, &#123;</span><br><span class="line">            arrayFormat: <span class="string">'repeat'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">&#125;, <span class="function">(<span class="params">error: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="å¯¹responseè¿›è¡Œå¤„ç†"><a href="#å¯¹responseè¿›è¡Œå¤„ç†" class="headerlink" title="å¯¹responseè¿›è¡Œå¤„ç†"></a>å¯¹responseè¿›è¡Œå¤„ç†</h2><p>æœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œå½“æ¥å£è¿”å›çš„codeä¸º2æ—¶ï¼Œè¡¨æ˜ç”¨æˆ·æœªç™»å½•ï¼Œè¿™æ—¶éœ€è¦å‰ç«¯å¯¹è¯·æ±‚çš„responseè¿”å›çš„codeè¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªè¯·æ±‚çš„åˆ¤æ–­è‚¯å®šæ˜¯ä¼šå¾ˆéº»çƒ¦çš„ï¼Œå“ªä¸ªè¯·æ±‚å¿˜äº†åŠ åˆ¤æ–­å°±å®Œè›‹äº†ï¼Œæ‰€ä»¥axiosæä¾›äº†å¯¹å“åº”è¿›è¡Œæ‹¦æˆªçš„æ“ä½œã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">axios.interceptors.response.use((response: <span class="built_in">any</span>): <span class="function"><span class="params">any</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; data &#125; = response;</span><br><span class="line">    <span class="keyword">if</span>(data.code === <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="built_in">window</span>.location.href = <span class="string">`/login?from=<span class="subst">$&#123;window.location.pathname&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;, <span class="function">(<span class="params">error: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="axioså¸¸è§„æ“ä½œ"><a href="#axioså¸¸è§„æ“ä½œ" class="headerlink" title="axioså¸¸è§„æ“ä½œ"></a>axioså¸¸è§„æ“ä½œ</h2><h3 id="GETè¯·æ±‚"><a href="#GETè¯·æ±‚" class="headerlink" title="GETè¯·æ±‚"></a>GETè¯·æ±‚</h3><p>getè¯·æ±‚,å¯¹äºéœ€è¦å‚æ•°çš„getè¯·æ±‚ï¼Œè¯·ä¸€å®šè¦å°†å‚æ•°æ”¾åœ¨ params é‡Œï¼Œä¸ç„¶ä½ ä¼šåƒäºçš„ã€‚ä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼Œè·å–ä¸€ä¸ªé‚®ä»¶çš„idï¼ŒmailIdæ˜¯ä¸€ä¸ªéå¸¸é•¿çš„ä¸€ä¸²å„ç§å­—ç¬¦ç»„æˆçš„ï¼Œæ°å·§è¿™é‡Œé¢åŒ…å«äº†ä¸€äº› . æˆ–è€… \ æˆ–è€… : å•¥çš„ï¼Œå…·ä½“çš„æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œæœ€åå¯¼è‡´çš„åŸå› æ˜¯è¿™ä¸ªé‚®ç®±çš„mailIDç©¿ä¸åˆ°åå°ï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°ç›´æ¥æ”¾åœ¨è·¯ç”±åé¢æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ‰€ä»¥è¯·ç›´æ¥è®²å‚æ•°æ”¾åœ¨paramsé‡Œï¼Œå› ä¸ºä¸Šé¢å·²ç»å¯¹paramsé‡Œçš„å‚æ•°è¿›è¡Œäº†å¤„ç†ã€‚<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">axios</span><span class="selector-class">.get</span>(<span class="string">'/api/info'</span>,&#123;</span><br><span class="line">    <span class="attribute">params</span>: &#123;</span><br><span class="line">        <span class="attribute">id</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)<span class="selector-class">.then</span>(res =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)<span class="selector-class">.catch</span>(err =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><h3 id="POSTè¯·æ±‚"><a href="#POSTè¯·æ±‚" class="headerlink" title="POSTè¯·æ±‚"></a>POSTè¯·æ±‚</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">axios</span><span class="selector-class">.post</span>(<span class="string">'/api/info'</span>,&#123;</span><br><span class="line">    <span class="attribute">username</span>: <span class="string">'haha'</span>,</span><br><span class="line">    <span class="attribute">password</span>: <span class="string">'123456'</span></span><br><span class="line">&#125;)<span class="selector-class">.then</span>(res =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)<span class="selector-class">.catch</span>(err =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>delete è¯·æ±‚ç±»ä¼¼äºgetè¯·æ±‚ putè¯·æ±‚ç±»ä¼¼äºpostè¯·æ±‚</p></blockquote><h3 id="é“¾å¼è°ƒç”¨"><a href="#é“¾å¼è°ƒç”¨" class="headerlink" title="é“¾å¼è°ƒç”¨"></a>é“¾å¼è°ƒç”¨</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">axios</span><span class="selector-class">.get</span>(<span class="string">'/api/info'</span>,&#123;</span><br><span class="line">    <span class="attribute">params</span>: &#123;</span><br><span class="line">        <span class="attribute">id</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)<span class="selector-class">.then</span>(res =&gt; &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">axios</span><span class="selector-class">.post</span>(<span class="string">'/api/info'</span>,&#123;</span><br><span class="line">        <span class="attribute">username</span>: <span class="string">'haha'</span>,</span><br><span class="line">        <span class="attribute">password</span>: <span class="string">'123456'</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)<span class="selector-class">.then</span>(res =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)<span class="selector-class">.catch</span>(err =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="axios-all"><a href="#axios-all" class="headerlink" title="axios.all"></a>axios.all</h3><p>ä¸ <code>Promise.all</code> ç±»ä¼¼ï¼Œç”¨äºå¤šä¸ªè¯·æ±‚å¹¶ç½šå¤„ç†ï¼Œç­‰å¾…è¯·æ±‚å…¨éƒ¨å®Œæˆæ—¶æ‰§è¡Œå›è°ƒï¼Œå¹¶ä¸”å›è°ƒå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œçš„é¡ºåºä¸è¯·æ±‚çš„é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–æ˜¯æŒ‰é¡ºåºå°†è¿”å›å€¼å­˜è¿›å»çš„</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">axios</span><span class="selector-class">.all</span>([</span><br><span class="line">    axios.get(<span class="string">'/api/info'</span>,&#123;</span><br><span class="line">        <span class="attribute">params</span>: &#123;</span><br><span class="line">            <span class="attribute">id</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">    axios.post(<span class="string">'/api/info'</span>,&#123;</span><br><span class="line">        <span class="attribute">username</span>: <span class="string">'haha'</span>,</span><br><span class="line">        <span class="attribute">password</span>: <span class="string">'123456'</span></span><br><span class="line">    &#125;);</span><br><span class="line">])<span class="selector-class">.then</span>(resArray =&gt; &#123;</span><br><span class="line">    <span class="comment">// resArray[0] ä¸ºaxios.get('/api/info') çš„res</span></span><br><span class="line">    <span class="comment">// resArray[1] ä¸ºaxios.post('/api/info') çš„res</span></span><br><span class="line">&#125;)<span class="selector-class">.catch</span>(err =&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="å®Œæ•´ä»£ç -æ¨¡å—åŒ–å¼€å‘"><a href="#å®Œæ•´ä»£ç -æ¨¡å—åŒ–å¼€å‘" class="headerlink" title="å®Œæ•´ä»£ç -æ¨¡å—åŒ–å¼€å‘"></a>å®Œæ•´ä»£ç -æ¨¡å—åŒ–å¼€å‘</h2><p>å°è£…å®Œäº†ä¹‹åå°†axioså¯¼å‡ºï¼Œå…¶ä»–çš„é¡µé¢ç›´æ¥å¼•ç”¨è¯¥axioså°±è¡Œã€‚å®Œæ•´ä»£ç å¦‚ä¸‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// request.js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> qs <span class="keyword">from</span> <span class="string">'qs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> SERVICE: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">axios.defaults.baseURL = SERVICE;</span><br><span class="line">axios.defaults.withCredentials = <span class="literal">true</span>;</span><br><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span>;</span><br><span class="line">axios.defaults.headers.put[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// qs åºåˆ—åŒ– é˜²æ­¢XSRFæ”»å‡» å¯ä»¥å¯¹æ·±å±‚æ¬¡çš„json arrayè¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line">axios.interceptors.request.use((config: <span class="built_in">any</span>): <span class="function"><span class="params">any</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (config.url.indexOf(<span class="string">'?'</span>) !== <span class="number">-1</span>) &#123;</span><br><span class="line">        config.url += <span class="string">`&amp;t=<span class="subst">$&#123;new Date().getTime()&#125;</span>`</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        config.url += <span class="string">`?t=<span class="subst">$&#123;new Date().getTime()&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// `transformRequest` å…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®</span></span><br><span class="line">    <span class="comment">// åªèƒ½ç”¨åœ¨ 'PUT', 'POST' å’Œ 'PATCH' è¿™å‡ ä¸ªè¯·æ±‚æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// åé¢æ•°ç»„ä¸­çš„å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ– ArrayBufferï¼Œæˆ– Stream</span></span><br><span class="line">    config.transformRequest = [<span class="function">(<span class="params">data: <span class="built_in">any</span>, headers: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(data, &#123;</span><br><span class="line">            allowDots: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;];</span><br><span class="line">    <span class="comment">// `paramsSerializer` æ˜¯ä¸€ä¸ªè´Ÿè´£ `params` åºåˆ—åŒ–çš„å‡½æ•°</span></span><br><span class="line">    config.paramsSerializer = <span class="function">(<span class="params">params: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> qs.stringify(params, &#123;</span><br><span class="line">            arrayFormat: <span class="string">'repeat'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">&#125;, <span class="function">(<span class="params">error: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.interceptors.response.use((response: <span class="built_in">any</span>): <span class="function"><span class="params">any</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; data &#125; = response;</span><br><span class="line">    <span class="keyword">if</span>(data.code === <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="built_in">window</span>.location.href = <span class="string">`/login?from=<span class="subst">$&#123;window.location.pathname&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;, <span class="function">(<span class="params">error: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios;</span><br></pre></td></tr></table></figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// action.js</span></span><br><span class="line"><span class="keyword">import</span> axios from <span class="string">'./request'</span>;</span><br><span class="line">axios.<span class="keyword">get</span>(<span class="string">''</span>)</span><br><span class="line">    .then(res = &gt; &#123;</span><br><span class="line">        <span class="comment">// ä¸šåŠ¡ä»£ç </span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(err =&gt; &#123;</span><br><span class="line">        <span class="comment">// ä¸šåŠ¡ä»£ç </span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ </title>
      <link href="/2019/08/14/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/08/14/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ­£åˆ™è¡¨è¾¾å¼åšå¤§ç²¾æ·±ï¼Œä½œä¸ºä¸€åå¼€å‘äººå‘˜ä¸èƒ½ä¸ä¼šæ­£åˆ™ï¼Œæ•ˆç‡å¥½ä½¿ç”¨æ–¹ä¾¿ï¼Œå†™èµ·æ¥è¿˜å¹²å‡€åˆ©è½ç®€ç›´å°±æ˜¯ç¥å™¨ã€‚ä½¿ç”¨åœºæ™¯ä¹Ÿå¾ˆå¤šï¼Œwebpackä¸­çš„loaderé…ç½®ï¼ŒdevServerä¸­çš„historyFallBackä¸­çš„è·¯ç”±åŒ¹é…ï¼Œè¡¨å•éªŒè¯ç­‰ç­‰ä½¿ç”¨æ­£åˆ™åŠå…¶æ–¹ä¾¿ã€‚</p></blockquote><h2 id="åˆ›å»ºä¸€ä¸ªæ­£åˆ™"><a href="#åˆ›å»ºä¸€ä¸ªæ­£åˆ™" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ­£åˆ™"></a>åˆ›å»ºä¸€ä¸ªæ­£åˆ™</h2><p>åˆ›å»ºä¸€ä¸ªæ­£åˆ™æœ‰ä¸¤ç§æ–¹å¼å’Œæˆ‘ä»¬åˆ›å»ºæ­£å¸¸çš„å˜é‡ä¸€æ ·ã€‚</p><ul><li>å­—é¢é‡ <code>var test = /a+/</code> ä½¿ç”¨ä¸¤ä¸ª<code>/</code>åŒ…è£¹</li><li>åˆ›å»º<code>RegExp</code>å¯¹è±¡ï¼Œ <code>var test = new RegExp(&quot;a+&quot;);</code></li></ul><h2 id="æ‰‹æœºå·åŒ¹é…"><a href="#æ‰‹æœºå·åŒ¹é…" class="headerlink" title="æ‰‹æœºå·åŒ¹é…"></a>æ‰‹æœºå·åŒ¹é…</h2><ul><li>ä»¥ 1 å¼€å§‹</li><li>ç¬¬äºŒä¸ªæ•°å­—ä¸º 3 4 5 7 8 ä¸­çš„ä¸€ä¸ª</li><li>æ¥ 9 ä¸ªæ•°å­—</li></ul><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ^ è¡¨ç¤ºåŒ¹é…æ­£åˆ™å¼€å§‹ $ è¡¨ç¤ºåŒ¹é…æ­£åˆ™ç»“æŸ</span></span><br><span class="line"><span class="comment">// () è¡¨ç¤ºå­æ­£åˆ™è¡¨è¾¾å¼ | è¡¨ç¤ºæˆ–</span></span><br><span class="line"><span class="comment">// \d è¡¨ç¤ºä¸€ä¸ª0-9çš„æ•°å­—ç­‰ä»·äº[0-9] &#123;n&#125; è¡¨ç¤ºå‰é¢ä¸€ä¸ªå­—ç¬¦å‡ºç° n æ¬¡</span></span><br><span class="line">var phoneTest = /^<span class="number">1</span>(<span class="number">3</span>|<span class="number">4</span>|<span class="number">5</span>|<span class="number">7</span>|<span class="number">8</span>)\d&#123;<span class="number">9</span>&#125;$/;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆ <code>/^1(3|4|5|7|8)\d{9}$/</code> å°±æ˜¯æœ€ç»ˆçš„æ­£åˆ™éªŒè¯è¡¨è¾¾å¼ã€‚</p><h2 id="é‚®ç®±éªŒè¯"><a href="#é‚®ç®±éªŒè¯" class="headerlink" title="é‚®ç®±éªŒè¯"></a>é‚®ç®±éªŒè¯</h2><ul><li>ä»¥å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€-ã€. å¼€å§‹å¹¶é‡å¤1åˆ°næ¬¡</li><li>ä¸­é—´ä»¥ @ è¿æ¥</li><li>åæ¥ å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€-ã€. é‡å¤1 åˆ°n æ¬¡</li><li>ä»¥ . æ¥2åˆ°4ä½çš„å¤§å°å†™å­—æ¯</li></ul><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// - å’Œ . éƒ½æ˜¯ç‰¹æ®Šå­—ç¬¦ ä½¿ç”¨æ—¶éœ€è¦è¿›è¡Œè½¬ä¹‰</span><br><span class="line">var emailTest = /^[a-zA-Z0-9_<span class="tag">\<span class="name">-</span></span><span class="tag">\<span class="name">.</span></span>]+@[a-zA-Z0-9_<span class="tag">\<span class="name">-</span></span><span class="tag">\<span class="name">.</span></span>]+<span class="tag">\<span class="name">.</span><span class="string">[a-zA-Z]</span><span class="string">&#123;2,4&#125;</span></span>/</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ­£åˆ™ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è§£å†³è¡Œå†…å…ƒç´ ä¹‹é—´çš„é—´éš™</title>
      <link href="/2019/08/13/%E8%A7%A3%E5%86%B3%E8%A1%8C%E5%86%85%E5%85%83%E7%B4%A0%E4%B9%8B%E9%97%B4%E7%9A%84%E9%97%B4%E9%9A%99/"/>
      <url>/2019/08/13/%E8%A7%A3%E5%86%B3%E8%A1%8C%E5%86%85%E5%85%83%E7%B4%A0%E4%B9%8B%E9%97%B4%E7%9A%84%E9%97%B4%E9%9A%99/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä»Šå¤©å†™demoï¼Œç”¨è¡Œå†…å…ƒç´ çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªå°é—®é¢˜ï¼Œè¡Œå†…å…ƒç´ ä¹‹é—´å°½ç„¶ä¼šæœ‰ä¸€ä¸ªå°ç©ºéš™ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰åŠ å·¦å³çš„marginçœŸçš„æ˜¯ç¥å¥‡ã€‚çªç„¶æ˜ç™½ä¸ºä»€ä¹ˆæ¯æ¬¡é¢è¯•é—®æˆ‘è¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„åŒºåˆ«æ—¶ï¼Œé¢è¯•å®˜è„¸ä¸Šçš„å¤±æœ›æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚</p></blockquote><p>ä¸Šä»£ç ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.main&#123;</span><br><span class="line"><span class="symbol">    margin:</span> <span class="number">100</span>px;</span><br><span class="line">&#125;</span><br><span class="line">span&#123;</span><br><span class="line"><span class="symbol">    background:</span> blue;</span><br><span class="line"><span class="symbol">    color:</span> white;</span><br><span class="line">&#125;    </span><br><span class="line"><span class="params">&lt;div class="main"&gt;</span></span><br><span class="line">    <span class="params">&lt;span&gt;</span>ç¬¬ä¸€ä¸ª<span class="params">&lt;/span&gt;</span></span><br><span class="line">    <span class="params">&lt;span&gt;</span>ç¬¬ä¸€ä¸ª<span class="params">&lt;/span&gt;</span></span><br><span class="line">    <span class="params">&lt;span&gt;</span>ç¬¬ä¸€ä¸ª<span class="params">&lt;/span&gt;</span></span><br><span class="line"><span class="params">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/64t51of6himpombw4l501jf8/image_1di4oeu1skdd1jhe125are5bhv9.png" alt="image_1di4oeu1skdd1jhe125are5bhv9.png-4.8kB"></p><p>è¿™ä¸‰ä¸ªspanä¹‹é—´çš„ç©ºæ ¼å²‚ä¸æ˜¯å¾ˆç„å¦™ã€‚<br>æ¢ç§å†™æ³•</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>ç¬¬ä¸€ä¸ª<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>ç¬¬ä¸€ä¸ª<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>ç¬¬ä¸€ä¸ª<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/i6hpzoa17umdwyw88oq8ix9p/image_1di4ojmqnggm13e58a2vatl8sm.png" alt="image_1di4ojmqnggm13e58a2vatl8sm.png-4.8kB"></p><p>é—´éš™æ¶ˆå¤±äº†ï¼Œé‚£ä¹ˆå¯ä»¥çœ‹å‡ºä¹‹æ‰€ä»¥äº§ç”Ÿé—´éš™æ˜¯å› ä¸ºè¡Œå†…å…ƒç´ åé¢æ¢äº†è¡Œæ‰€ä»¥äº§ç”Ÿäº†é—´éš™ã€‚<br>é‚£ä¹ˆè§£å†³åŠæ³•ä¹Ÿæœ‰å¾ˆå¤šã€‚</p><h2 id="è´Ÿè¾¹è·"><a href="#è´Ÿè¾¹è·" class="headerlink" title="è´Ÿè¾¹è·"></a>è´Ÿè¾¹è·</h2><p>è¡Œå†…å…ƒç´ åœ¨æ°´å¹³æ–¹å‘ä¸Šçš„ margin æ˜¯å­˜åœ¨çš„ï¼Œåœ¨å‚ç›´æ–¹å‘ä¸Šä¸å­˜åœ¨ï¼Œæ‰€ä»¥åŠ ä¸€ä¸ªè´Ÿçš„marginå°±å¯ä»¥äº†ã€‚</p><h2 id="ä½¿ç”¨font-size-0"><a href="#ä½¿ç”¨font-size-0" class="headerlink" title="ä½¿ç”¨font-size = 0"></a>ä½¿ç”¨font-size = 0</h2><p>ç¥å¥‡çš„å±æ€§</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.main&#123;</span><br><span class="line"><span class="symbol">    margin:</span> <span class="number">100</span>px;</span><br><span class="line">    font-size: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">span&#123;</span><br><span class="line"><span class="symbol">    background:</span> blue;</span><br><span class="line"><span class="symbol">    color:</span> white;</span><br><span class="line">    font-size: <span class="number">16</span>px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="params">&lt;div class="main"&gt;</span></span><br><span class="line">    <span class="params">&lt;span&gt;</span>ç¬¬ä¸€ä¸ª<span class="params">&lt;/span&gt;</span></span><br><span class="line">    <span class="params">&lt;span&gt;</span>ç¬¬ä¸€ä¸ª<span class="params">&lt;/span&gt;</span></span><br><span class="line">    <span class="params">&lt;span&gt;</span>ç¬¬ä¸€ä¸ª<span class="params">&lt;/span&gt;</span></span><br><span class="line"><span class="params">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><p>å½“ç„¶å…¶ä»–è¿˜æœ‰å¾ˆå¤šå»é™¤é—´éš™çš„æ–¹æ³•ï¼Œæˆ‘è¿˜æ˜¯æ›´å–œæ¬¢ font-size è¿™ä¸€ç§</p><p><img src="http://static.zybuluo.com/shenweizheng/6o55pyf87hmqn5mro8a6an4f/image_1di4orf6p7pj1du01gs21mn1s1b13.png" alt="image_1di4orf6p7pj1du01gs21mn1s1b13.png-4.4kB"></p>]]></content>
      
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>css å®ç°ä¸‰è§’å½¢ã€æ¢¯å½¢ã€å¹³è¡Œå››è¾¹å½¢ã€çˆ±å¿ƒç­‰å½¢çŠ¶</title>
      <link href="/2019/08/13/css%20%E5%AE%9E%E7%8E%B0%E4%B8%89%E8%A7%92%E5%BD%A2%E3%80%81%E6%A2%AF%E5%BD%A2%E3%80%81%E5%B9%B3%E8%A1%8C%E5%9B%9B%E8%BE%B9%E5%BD%A2%E3%80%81%E7%88%B1%E5%BF%83%E7%AD%89%E5%BD%A2%E7%8A%B6/"/>
      <url>/2019/08/13/css%20%E5%AE%9E%E7%8E%B0%E4%B8%89%E8%A7%92%E5%BD%A2%E3%80%81%E6%A2%AF%E5%BD%A2%E3%80%81%E5%B9%B3%E8%A1%8C%E5%9B%9B%E8%BE%B9%E5%BD%A2%E3%80%81%E7%88%B1%E5%BF%83%E7%AD%89%E5%BD%A2%E7%8A%B6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>css æ˜¯ä¸€é—¨å¾ˆé«˜æ·±çš„å­¦é—®ï¼Œæ˜¯å‰ç«¯é¡µé¢æ˜¯å¦å¥½çœ‹çš„æ”¯æŸ±ã€‚ä¹‹å‰ä¸€ç›´å°çœ‹äº†cssçš„åŠ›é‡ï¼Œæœ€è¿‘çœ‹å…¶ä»–åšä¸»çš„ä¹¦æ‰æ˜ç™½è‡ªå·±çš„cssæ˜¯å¤šä¹ˆçš„èœï¼Œä»¥ä¸ºä¼šç‚¹å¸ƒå±€å°±æ˜¯cssäº†æœ‰ç‚¹è´»ç¬‘å¤§æ–¹äº†ã€‚è¿™ç¯‡åšå®¢åˆ©ç”¨css å®ç°å„ç§å½¢çŠ¶çš„ç¼–å†™ã€‚</p><p>å®Œæ•´ä»£ç  <a href="https://github.com/shenweizheng110/study/blob/master/demo/cssShape.html" target="_blank" rel="noopener">https://github.com/shenweizheng110/study/blob/master/demo/cssShape.html</a></p></blockquote><p>css è¦æƒ³å®ç°ä¸‰è§’å½¢ã€æ¢¯å½¢ç¯å½¢çŠ¶ï¼Œä¸»è¦åˆ©ç”¨ border çš„ç›¸å…³ç‰¹æ€§ã€‚é‚£ä¹ˆé¦–å…ˆçœ‹ä¸€ä¸‹borderå±æ€§ï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ªdivè®¾ç½®å¾ˆå®½çš„borderã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line"><span class="attribute">border-top</span>: <span class="number">50px</span> solid red;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid black;</span><br><span class="line"><span class="attribute">border-right</span>: <span class="number">50px</span> solid yellow;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</span><br></pre></td></tr></table></figure><p>æ•ˆæœä¸ºï¼š</p><p><img src="http://static.zybuluo.com/shenweizheng/enpxiprs301m0huftiqh3klq/image_1dhe36eagier2e71cekou71g6r9.png" alt="image_1dhe36eagier2e71cekou71g6r9.png-3kB"></p><a id="more"></a><p>ä¸ºäº†çœ‹èµ·æ¥æ¸…æ¥šä¸€ç‚¹ï¼Œæˆ‘ç”¨äº†å››ç§ä¸åŒçš„é¢œè‰²è¿›è¡ŒåŒºåˆ†ã€‚é‚£ä¹ˆæˆ‘ä»¬è®¾ç½® width å’Œ hight éƒ½ä¸º 0 ï¼Œä¹Ÿå°±æ˜¯contentæ‰€å æ®çš„é¢ç§¯ä¸º0 é‚£ä¹ˆåœ¨æ ‡å‡†ç›’æ¨¡å‹ä¸‹ï¼Œæ•´ä¸ªdivæ‰€å±•ç¤ºçš„é¢ç§¯å°±ä¼šç”±æˆ‘ä»¬çš„borderçš„å®½åº¦æ‰€å æ®ï¼Œæ¯•ç«Ÿæˆ‘ä»¬è¿™é‡Œæ²¡æœ‰margin å’Œ paddingã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line"><span class="attribute">border-top</span>: <span class="number">50px</span> solid red;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid black;</span><br><span class="line"><span class="attribute">border-right</span>: <span class="number">50px</span> solid yellow;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/58qgfr5l43fnx7j0soxqgkie/image_1dhe3fpe91mi59qlo4j1evr1i6pm.png" alt="image_1dhe3fpe91mi59qlo4j1evr1i6pm.png-2.5kB"></p><p>å¦‚æœæˆ‘ä»¬åªéœ€è¦ä¸‹é¢è“è‰²çš„é‚£ä¸ªä¸‰è§’å½¢ï¼Œåªéœ€è¦ä¸è®¾ç½® ä¸Šè¾¹æ¡†ï¼Œç„¶åå·¦å³ä¸¤ä¸ªè¾¹æ¡†çš„é¢œè‰²ä¸ºé€æ˜çš„å°±å¯ä»¥ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½®é™¤äº†è“è‰²çš„å…¶ä½™è¾¹è¾¹æ¡†çš„é¢œè‰²ä¸ºé€æ˜çš„ä¹Ÿå¯ä»¥ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-bottom-color</span>: blue;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/u5p4mfsvekyb8ixaw0vf2go9/image_1dhe3upqv16sfov16l7tcdep113.png" alt="image_1dhe3upqv16sfov16l7tcdep113.png-1.8kB"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æ”¹å˜ä¸‰è§’å½¢çš„å˜é•¿ï¼Œå¤§å®¶éƒ½çŸ¥é“æ”¹å˜è¾¹æ¡†çš„å®½åº¦ç”¨çš„æ˜¯ border-width å±æ€§ã€‚æˆ‘ä»¬å¯ä»¥é€æ¸çš„åŠ å¤§ border-bottom è¯•è¯•<br>border-bottom ä¸º 100 px æ—¶ï¼š</p><p><img src="http://static.zybuluo.com/shenweizheng/e1dshqq513uz2q5kckdu6rqb/image_1dhe49cdo1ke3157mvr917gp1pua1g.png" alt="image_1dhe49cdo1ke3157mvr917gp1pua1g.png-2.7kB"></p><p>å¯ä»¥çœ‹çš„å‡ºæ¥æ—¶ä¸‰è§’å½¢çš„é«˜å˜å¤§äº†ï¼Œè€Œä¸æ˜¯ä¸‰è§’å½¢çš„åº•å˜å¤§äº†ã€‚ä¹‹å‰æˆ‘ä¹Ÿåœ¨æ‡µé€¼ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·çš„ï¼Œç»“æœæˆ‘å‘ç°å¯¹ border-width çš„äº†è§£å‡ºç°äº†åå·®ã€‚äº‹å®ä¸Šï¼Œborder-width æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="http://static.zybuluo.com/shenweizheng/3zdfwy9ga8s4vd9eajazndul/image_1dhe5d7ea36mceuqqq1ij4r401t.png" alt="image_1dhe5d7ea36mceuqqq1ij4r401t.png-33.4kB"></p><p>å›¾ä¸­çš„è¿™æ¡ç™½çº¿æ‰æ˜¯ border-widthã€‚<br>é‚£ä¹ˆåŒæ ·çš„ï¼Œè“è‰²ä¸‰è§’å½¢çš„è¾¹é•¿æ˜¯ border-left-width åŠ ä¸Š border-right-width çš„å’Œï¼Œé«˜åº¦ä¸º border-bottom-widthã€‚</p><h2 id="ç›´è§’ä¸‰è§’å½¢"><a href="#ç›´è§’ä¸‰è§’å½¢" class="headerlink" title="ç›´è§’ä¸‰è§’å½¢"></a>ç›´è§’ä¸‰è§’å½¢</h2><p>ä¸Šé¢è¯´äº†ä¸‰è§’å½¢çš„è¾¹å’Œé«˜çš„æ„æˆï¼Œé‚£ä¹ˆç›´è§’ä¸‰è§’å½¢å°±æ˜¯å°†border-left æˆ–è€… border-rightå…¶ä¸­ä¸€ä¸ªç½®ä¸º0ï¼›</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/jabxz4dhmdd7p0kwf2vwed6r/image_1dhe5n3ab15sbemfjog1brsp882a.png" alt="image_1dhe5n3ab15sbemfjog1brsp882a.png-0.9kB"></p><h2 id="ç­‰è¾¹ä¸‰è§’å½¢"><a href="#ç­‰è¾¹ä¸‰è§’å½¢" class="headerlink" title="ç­‰è¾¹ä¸‰è§’å½¢"></a>ç­‰è¾¹ä¸‰è§’å½¢</h2><p>ç­‰è¾¹ä¸‰è§’å½¢çš„å®šä¹‰æ˜¯ä¸‰è§’å½¢çš„ä¸‰è¾¹é•¿ç›¸ç­‰ï¼Œé«˜ä¸ºè¾¹çš„ $\sqrt 3$, é‚£ä¹ˆé«˜æ˜¯ç”±border-bottom-widthæ§åˆ¶çš„ï¼Œè€Œå˜é•¿æ˜¯ç”± border-left-width ä¸ border-right-width çš„å’Œã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬çš„ border-left-width å’Œ border-right-width éƒ½ä¸º 50px çš„è¯ï¼Œé«˜å°±æ˜¯ $50\sqrt 3$, ç²—ç•¥çš„ä¸º 86px</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-right</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">86px</span> solid blue;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/b0z16sii7eg33047adswnmtg/image_1dhe67t11uj4kt01k3bbb9sjl2n.png" alt="image_1dhe67t11uj4kt01k3bbb9sjl2n.png-2.8kB"></p><h2 id="æ¢¯å½¢"><a href="#æ¢¯å½¢" class="headerlink" title="æ¢¯å½¢"></a>æ¢¯å½¢</h2><h3 id="ç›´è§’æ¢¯å½¢"><a href="#ç›´è§’æ¢¯å½¢" class="headerlink" title="ç›´è§’æ¢¯å½¢"></a>ç›´è§’æ¢¯å½¢</h3><p>åªéœ€è¦å°†ä¸Šè¾¹æ¡†å–æ¶ˆï¼Œå·¦å³é€‰å–ä¸€ä¸ªå°†å…¶é¢œè‰²ç½®ä¸ºé€æ˜<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-right</span>: <span class="number">50px</span> solid yellow;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</span><br></pre></td></tr></table></figure></p><p><img src="http://static.zybuluo.com/shenweizheng/70cxwgul0fxu8lc2u68qvzeo/image_1di4cei5b12bm1e28ipfmn41g8k9.png" alt="image_1di4cei5b12bm1e28ipfmn41g8k9.png-2.1kB"></p><h3 id="æ™®é€šæ¢¯å½¢"><a href="#æ™®é€šæ¢¯å½¢" class="headerlink" title="æ™®é€šæ¢¯å½¢"></a>æ™®é€šæ¢¯å½¢</h3><p>æ™®é€šæ¢¯å½¢çš„ä¸Šè¾¹æ¡†éœ€è¦ä½¿ç”¨widthå±æ€§æŒ‡å®šï¼Œè¦ç»™ä»–ä¸€å®šçš„å®½åº¦<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">25px</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-right</span>: <span class="number">50px</span> solid transparent;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</span><br></pre></td></tr></table></figure></p><p><img src="http://static.zybuluo.com/shenweizheng/1c7o51i00fibxmfhp75km2wx/image_1di4chtfv1ls718n7p4d1rr68vam.png" alt="image_1di4chtfv1ls718n7p4d1rr68vam.png-1.7kB"></p><h2 id="è±å½¢"><a href="#è±å½¢" class="headerlink" title="è±å½¢"></a>è±å½¢</h2><p>è¿™ä¸ªå°±ç®€å•äº†ï¼Œåªè¦å°†æ­£æ–¹å½¢æ—‹è½¬ 45 åº¦ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">border-top</span>: <span class="number">50px</span> solid red;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">50px</span> solid black;</span><br><span class="line"><span class="attribute">border-right</span>: <span class="number">50px</span> solid yellow;</span><br><span class="line"><span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</span><br><span class="line"><span class="attribute">transform</span>: rotate(<span class="number">45deg</span>);</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/j4x5db0fuvszpubr6wlzxob5/image_1di4dvmqhsnt1hmfr8216cd1r8013.png" alt="image_1di4dvmqhsnt1hmfr8216cd1r8013.png-3.8kB"></p><h2 id="å¹³è¡Œå››è¾¹å½¢"><a href="#å¹³è¡Œå››è¾¹å½¢" class="headerlink" title="å¹³è¡Œå››è¾¹å½¢"></a>å¹³è¡Œå››è¾¹å½¢</h2><p>å€ŸåŠ© transform ä¸­çš„ skew å±æ€§æ¥å®ç°ï¼Œç”±äºç›´æ¥åœ¨divä¸­ä½¿ç”¨ï¼Œä¼šå¯¼è‡´å†…éƒ¨çš„å­—ä½“ä¹Ÿä¼šç›¸åº”çš„å€¾æ–œï¼Œä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å¯¹é‡Œé¢çš„æ–‡æœ¬åŠ ä¸€ä¸ªåå‘çš„å€¾æ–œï¼Œå¦ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯åˆ©ç”¨ä¸ºå…ƒç´ è¿›è¡Œå€¾æ–œï¼Œè¿™æ ·å†…éƒ¨çš„æ–‡æœ¬å°±ä¸ä¼šç»§æ‰¿å€¾æ–œäº†ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.rhomboid</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.rhomboid</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">    <span class="attribute">background</span>: blue;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">skew</span>(45deg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/pdzf4qkdzy5ykog9tb7brsj7/image_1di4fae5a1t7316a01oqc1opu7cq1g.png" alt="image_1di4fae5a1t7316a01oqc1opu7cq1g.png-3.3kB"></p><h2 id="çˆ±å¿ƒ"><a href="#çˆ±å¿ƒ" class="headerlink" title="çˆ±å¿ƒ"></a>çˆ±å¿ƒ</h2><p>çˆ±å¿ƒå¯ä»¥é€šè¿‡çš„å…¶ä»–å…ƒç´ è¿›è¡Œé®æ©æ‹¼æ¥å®ç°ã€‚é¦–å…ˆç”»ä¸€ä¸ªæ­£æ–¹å½¢</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.love</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/ist4ccrw14wllj02xdvb6c3r/image_1di4mgturg9ud8j4gt1h8f4er1t.png" alt="image_1di4mgturg9ud8j4gt1h8f4er1t.png-1.1kB"></p><p>é€šè¿‡ä¸ºå…ƒç´ ç”»ä¸¤ä¸ªåœ†è¦†ç›–åœ¨æ­£æ–¹å½¢ä¸Š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.love</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.love</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/kwj2g5my4vw7ii5iw7js5x2a/image_1di4mkpv0lp8se91sink8t2p22a.png" alt="image_1di4mkpv0lp8se91sink8t2p22a.png-4.1kB"></p><p><img src="http://static.zybuluo.com/shenweizheng/pb3wtmyl4dqrimn16f5upnhc/image_1di4mlfpfkip1k76v917cmfl2n.png" alt="image_1di4mlfpfkip1k76v917cmfl2n.png-5.4kB"></p><p>æ—‹è½¬ 45 åº¦ é¢œè‰²æ”¹æˆä¸€è‡´çš„</p><p><img src="http://static.zybuluo.com/shenweizheng/jv5frcyxvv5ku00twgxd158h/image_1di4mmm0r1l5l1prvr8m8p43rr34.png" alt="image_1di4mmm0r1l5l1prvr8m8p43rr34.png-5.9kB"></p>]]></content>
      
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>BFCçš„è§¦å‘æ¡ä»¶ã€å¸ƒå±€è§„åˆ™ã€ä½¿ç”¨åœºæ™¯</title>
      <link href="/2019/07/31/BFC%E7%9A%84%E8%A7%A6%E5%8F%91%E6%9D%A1%E4%BB%B6%E3%80%81%E5%B8%83%E5%B1%80%E8%A7%84%E5%88%99%E3%80%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
      <url>/2019/07/31/BFC%E7%9A%84%E8%A7%A6%E5%8F%91%E6%9D%A1%E4%BB%B6%E3%80%81%E5%B8%83%E5%B1%80%E8%A7%84%E5%88%99%E3%80%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>BFCæŒ‡çš„æ˜¯å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œç®€å•çš„æ¥è¯´ï¼ŒBFCå°±æ˜¯åˆ›å»ºä¸€ä¸ªç›’å­ï¼Œç›’å­å†…éƒ¨çš„å…ƒç´ å¸ƒå±€ä¸å½±å“ç›’å­å¤–éƒ¨çš„å…ƒç´ ã€‚htmlæ ¹å…ƒç´ å°±æ˜¯ä¸€ä¸ªBFC</p></blockquote><h2 id="BFC-çš„è§¦å‘æ¡ä»¶"><a href="#BFC-çš„è§¦å‘æ¡ä»¶" class="headerlink" title="BFC çš„è§¦å‘æ¡ä»¶"></a>BFC çš„è§¦å‘æ¡ä»¶</h2><ul><li>htmlæ ¹å…ƒç´  <code>&lt;html&gt;</code></li><li>float ä¸ä¸º none</li><li>ç»å¯¹å®šä½å…ƒç´  ä¹Ÿå°±æ˜¯ position ä¸º absolute å’Œ fixed</li><li>è¡Œå†…å¿«å…ƒç´  display ä¸º inline-block</li><li>display ä¸º table-cell inline-block flex inline-flex grid inline-grid table-caption(è¡¨æ ¼æ ‡é¢˜)</li><li>overflow ä¸ä¸º visible</li></ul><a id="more"></a><h2 id="BFC-çš„è§„åˆ™"><a href="#BFC-çš„è§„åˆ™" class="headerlink" title="BFC çš„è§„åˆ™"></a>BFC çš„è§„åˆ™</h2><ol><li>å†…éƒ¨çš„Boxä¼šåœ¨å‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½®ã€‚Boxå‚ç›´æ–¹å‘çš„è·ç¦»ç”±marginå†³å®šã€‚å±äºåŒä¸€ä¸ªBFCçš„ä¸¤ä¸ªç›¸é‚»Boxçš„marginä¼šå‘ç”Ÿé‡å ã€‚</li><li>æ¯ä¸ªå…ƒç´ çš„margin boxçš„å·¦è¾¹ï¼Œ ä¸åŒ…å«å—border boxçš„å·¦è¾¹ç›¸æ¥è§¦(å¯¹äºä»å·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸å)ã€‚å³ä½¿å­˜åœ¨æµ®åŠ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li><li>BFCçš„åŒºåŸŸä¸ä¼šä¸float boxé‡å ã€‚</li><li>FCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚åä¹‹ä¹Ÿå¦‚æ­¤ã€‚</li><li>è®¡ç®—BFCçš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—ã€‚</li></ol><h2 id="BFCè§£å†³çš„é—®é¢˜"><a href="#BFCè§£å†³çš„é—®é¢˜" class="headerlink" title="BFCè§£å†³çš„é—®é¢˜"></a>BFCè§£å†³çš„é—®é¢˜</h2><h3 id="å‚ç›´æ–¹å‘-margin-é‡å "><a href="#å‚ç›´æ–¹å‘-margin-é‡å " class="headerlink" title="å‚ç›´æ–¹å‘ margin é‡å "></a>å‚ç›´æ–¹å‘ margin é‡å </h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.out&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: black;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=<span class="string">'out'</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=<span class="string">'out'</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>ç†è®ºä¸Šè®²ï¼Œè¿™ä¸¤ä¸ª div ä¸Šä¸‹é—´éš™æœ‰ 40px å› ä¸ºä¸¤ä¸ªdiv çš„marginéƒ½æ˜¯ 20px åŠ èµ·æ¥å°±æ˜¯40pxï¼Œä½†æ˜¯çœ‹ä¸€ä¸‹æ•ˆæœå›¾ã€‚</p><p><img src="http://static.zybuluo.com/shenweizheng/ht4jg65uch1aetpqj3qss3bx/image_1dh2ouhd51bsjc015lseft7nnm.png" alt="image_1dh2ouhd51bsjc015lseft7nnm.png-2.1kB"></p><p>è¿™ä¸ªå®é™…ä¸Šï¼Œåªæœ‰ 20px çš„é—´éš™ï¼ŒåŸå› æ˜¯ä¸€ä¸ªå®¹å™¨å†…éƒ¨çš„æ‰€æœ‰boxä¼šä»ä¸Šå¾€ä¸‹è¿›è¡Œå †å ï¼Œå¹¶ä¸”å‚ç›´ç›¸é‚»çš„è·ç¦»(å³margin)æ˜¯ç”±å„è‡ªçš„marginå†³å®šçš„ï¼Œåœ¨å‚ç›´æ–¹å‘ä¸Šä¼šå‘ç”Ÿ margin é‡å ã€‚è§£å†³æ–¹æ¡ˆæ˜¯å°†ä¸¤ä¸ª div åˆ†å±äºä¸åŒçš„BFCã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>='out'&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;<span class="keyword">div</span> style=<span class="string">"overflow: hidden"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>='out'&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure><p>åœ¨å…¶ä¸­ä¸€ä¸ªoutå¤–é¢åŒ…è£¹ä¸€å±‚divï¼Œè®¾ç½® overflow: hidden ä½¿å…¶å˜æˆä¸€ä¸ªBFCï¼Œè¿™æ ·ä¸¤ä¸ªoutå°±ä¸ä¼šå‘ç”Ÿmarginé‡å äº†ã€‚</p><p><img src="http://static.zybuluo.com/shenweizheng/q6ic9t4n3v75zghzybkz2jv0/image_1dh2p3qqkk1g1c2dasi6tb1cbn13.png" alt="image_1dh2p3qqkk1g1c2dasi6tb1cbn13.png-2.8kB"></p><p>åœ¨çœ‹å¦ä¸€å¤–ä¸€ç§marginé‡å </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.out&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: black;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.inner&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="selector-tag">div</span> class=<span class="string">'out'</span>&gt;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=<span class="string">"inner"</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/1t50d2gchk4f9pm9o8l1yv1p/image_1dh2p80er1035cd61n5611r9q1v1g.png" alt="image_1dh2p80er1035cd61n5611r9q1v1g.png-6.1kB"></p><p>å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªå…ƒç´ è·ç¦»é¡¶éƒ¨çš„è·ç¦»æ˜¯ç”±å­å…ƒç´  inner çš„margin-topå†³å®šçš„ï¼Œå› ä¸º inner çš„marginTopæ˜¯å¤§äºå¤–éƒ¨çš„outçš„ï¼Œå¹¶ä¸”ä»–ä»¬éƒ½å±äº html è·Ÿå…ƒç´ ä¸‹çš„BFCï¼Œæ‰€ä»¥marginåœ¨å‚ç›´æ–¹å‘ä¸Šä¼šå‘ç”Ÿé‡å ï¼Œå–æœ€å¤§å€¼ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.out</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: black;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»™ out è®¾ç½® overflow: hidden è®©ä»–å˜æˆä¸€ä¸ª BFC</p><p><img src="http://static.zybuluo.com/shenweizheng/2ss8m8qjet3nrlpkik471lfx/image_1dh2ped1p1r5s10ehbnf1a388071t.png" alt="image_1dh2ped1p1r5s10ehbnf1a388071t.png-1.5kB"></p><h3 id="æ–‡æœ¬ä¸ç¯ç»•æµ®åŠ¨å…ƒç´ "><a href="#æ–‡æœ¬ä¸ç¯ç»•æµ®åŠ¨å…ƒç´ " class="headerlink" title="æ–‡æœ¬ä¸ç¯ç»•æµ®åŠ¨å…ƒç´ "></a>æ–‡æœ¬ä¸ç¯ç»•æµ®åŠ¨å…ƒç´ </h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.<span class="built_in">float</span>&#123;</span><br><span class="line">    <span class="built_in">float</span>: left;</span><br><span class="line">    <span class="built_in">width</span>: <span class="number">100</span>px;</span><br><span class="line">    <span class="built_in">height</span>: <span class="number">100</span>px;</span><br><span class="line">    <span class="built_in">background</span>: <span class="built_in">red</span>;</span><br><span class="line">    <span class="built_in">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line">p&#123;</span><br><span class="line">    <span class="built_in">width</span>: <span class="number">200</span>px;</span><br><span class="line">    <span class="built_in">height</span>: <span class="number">200</span>px;</span><br><span class="line">    <span class="built_in">background</span>: <span class="built_in">blue</span>;</span><br><span class="line">    <span class="built_in">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line">&lt;div class=<span class="string">"float"</span>&gt;I am a floated <span class="built_in">box</span>!&lt;/div&gt;</span><br><span class="line">&lt;p&gt;I am content inside the container.&lt;/p&gt;</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/6p2jtzzqff03j50aornozxos/image_1dh2pth9oj4p9412k11kro1tn02a.png" alt="image_1dh2pth9oj4p9412k11kro1tn02a.png-13.2kB"></p><p>ç°åœ¨æˆ‘ä»¬çš„è“è‰²åŒºåŸŸçš„æ–‡æœ¬æ˜¯å›´ç»•ç€æµ®åŠ¨å…ƒç´ è¿›è¡Œæ’åˆ—çš„ï¼Œå¦‚æœè¦å®ç°ä¸¤æ å¸ƒå±€çš„è¯æœ‰ä¸€ç§åŠæ³•æ˜¯è®©è“è‰²åŒºåŸŸçš„marginLeftè®¾ç½®ä¸ºçº¢è‰²åŒºåŸŸçš„å®½ + ä½ æƒ³è¦çš„è¾¹è·</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background</span>: blue;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°† p å˜æˆBFC</p><h3 id="è§£å†³åŒ…è£¹æµ®åŠ¨å…ƒç´ æ²¡æœ‰é«˜åº¦çš„é—®é¢˜"><a href="#è§£å†³åŒ…è£¹æµ®åŠ¨å…ƒç´ æ²¡æœ‰é«˜åº¦çš„é—®é¢˜" class="headerlink" title="è§£å†³åŒ…è£¹æµ®åŠ¨å…ƒç´ æ²¡æœ‰é«˜åº¦çš„é—®é¢˜"></a>è§£å†³åŒ…è£¹æµ®åŠ¨å…ƒç´ æ²¡æœ‰é«˜åº¦çš„é—®é¢˜</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.inner&#123;</span><br><span class="line"><span class="symbol">    float:</span> left;</span><br><span class="line"><span class="symbol">    width:</span> <span class="number">100</span>px;</span><br><span class="line"><span class="symbol">    height:</span> <span class="number">100</span>px;</span><br><span class="line"><span class="symbol">    background:</span> red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="params">&lt;div&gt;</span></span><br><span class="line">    <span class="params">&lt;div class='inner'&gt;</span><span class="params">&lt;/div&gt;</span></span><br><span class="line"><span class="params">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/shenweizheng/9fug72v07c84wmoc0xgmbfz0/image_1dh2qc0vdmsu698slaa112dn3k.png" alt="image_1dh2qc0vdmsu698slaa112dn3k.png-4.7kB"></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œdiv ä¸è®¾ç½®å®½é«˜çš„è¯ï¼Œä»–çš„å®½é«˜ä¼šç”±å­å…ƒç´ çš„å®½é«˜ç»™æ’‘èµ·æ¥ï¼Œä½†æ˜¯è¿™è¾¹ åŒ…è£¹äº†ä¸€ä¸ªæµ®åŠ¨å…ƒç´ ï¼Œå‘ç°çˆ¶çº§å…ƒç´ çš„é«˜åº¦ä¸º 0</p><p><img src="http://static.zybuluo.com/shenweizheng/7pxxvy6tkz4ov0ku7jtqd55p/image_1dh2qhk4l1guf1koqjbokt41ne74e.png" alt="image_1dh2qhk4l1guf1koqjbokt41ne74e.png-11.8kB"></p><p><img src="http://static.zybuluo.com/shenweizheng/jpwg0iwwcwuqncwygfiycsuz/image_1dh2qgtdi1nvsf2b19uo11ej19q541.png" alt="image_1dh2qgtdi1nvsf2b19uo11ej19q541.png-5kB"></p><p>åŒæ ·çš„è®¾ç½®ä¸ºBFC</p>]]></content>
      
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åŸå‹é“¾ ä¸ ç»§æ‰¿çš„ç†è§£</title>
      <link href="/2019/07/26/%E5%8E%9F%E5%9E%8B%E9%93%BE%20%E4%B8%8E%20%E7%BB%A7%E6%89%BF%E7%9A%84%E7%90%86%E8%A7%A3/"/>
      <url>/2019/07/26/%E5%8E%9F%E5%9E%8B%E9%93%BE%20%E4%B8%8E%20%E7%BB%A7%E6%89%BF%E7%9A%84%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åŸå‹é“¾æ˜¯å‰ç«¯é¢è¯•å‡ ä¹å¿…é—®çš„ä¸œè¥¿ï¼ŒåŸå‹é“¾å®ç°äº†jsä¸­çš„ç»§æ‰¿ã€‚åœ¨çœ‹å®Œé˜®ä¸€å³°è€å¸ˆçš„åšå®¢åï¼Œç†è§£äº†åŸå‹é“¾çš„ä½œç”¨ã€‚</p></blockquote><h2 id="new-çš„ç”±æ¥"><a href="#new-çš„ç”±æ¥" class="headerlink" title="new çš„ç”±æ¥"></a>new çš„ç”±æ¥</h2><p>å…³äºnewçš„ç”±æ¥å¤§å®¶å¯ä»¥å€Ÿé˜…é˜®ä¸€å³°è€å¸ˆçš„åšå®¢<a href="http://www.ruanyifeng.com/blog/2011/06/designing_ideas_of_inheritance_mechanism_in_javascript.html" target="_blank" rel="noopener">Javascriptç»§æ‰¿æœºåˆ¶çš„è®¾è®¡æ€æƒ³</a></p><a id="more"></a><h2 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h2><p>åœ¨es5ä¹‹å‰è¿˜æ²¡æœ‰ç±»çš„æ—¶å€™ï¼Œjséƒ½æ˜¯ new ä¸€ä¸ªæ„é€ å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ªæ„é€ å‡½æ•°çš„å¯¹è±¡ï¼Œè¿™è¾¹çš„æ„é€ å‡½æ•°ç›¸å½“äºjavaä¸­çš„classï¼Œåœ¨es6ä¹‹åï¼Œä¸ºäº†æ–¹ä¾¿jsä¹Ÿè¯ç”Ÿäº† class å…³é”®å­—ã€‚<br>æ„é€ å‡½æ•°å’Œæ™®é€šçš„functionæœ€ç›´è§‚çš„åŒºåˆ«æ˜¯ æ„é€ å‡½æ•°çš„å‡½æ•°åæ˜¯å¤§å†™çš„ï¼Œå®ƒå¼ è¿™ä¸ªæ ·å­<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span><span class="params">(name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = <span class="string">'dog'</span>;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™è¾¹æ˜¯å®šä¹‰äº†ä¸€ä¸ª Dog çš„æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ new æ¥åˆ›å»ºä¸€åªç‹—</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> dog = <span class="keyword">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dog.name); <span class="comment">// å“ˆå£«å¥‡</span></span><br></pre></td></tr></table></figure><p>è‡³äºæ„é€ å‡½æ•°ä¸­çš„thisæŒ‡å‘é—®é¢˜ï¼Œè¿™è¾¹å°±ä¸è¯´äº†ï¼Œåœ¨æˆ‘çš„ä¸Šä¸€ç¯‡åšå®¢è¯¦ç»†çš„ä»‹ç»äº†<a href="https://blog.csdn.net/qq_38606793/article/details/97309053" target="_blank" rel="noopener">jsä¸­çš„thisæŒ‡å‘é—®é¢˜</a>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬äº†è§£ä¸€ä¸‹ new ä¸€ä¸ªå¯¹è±¡çš„ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆ</p><h2 id="new-çš„è¿‡ç¨‹"><a href="#new-çš„è¿‡ç¨‹" class="headerlink" title="new çš„è¿‡ç¨‹"></a>new çš„è¿‡ç¨‹</h2><p>èŠ‚é€‰è‡ªjsé«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬ä¸‰ç‰ˆï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œä¸€å…±åˆ†ä¸ºå››ä¸ªæ­¥éª¤</p><p>ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼›</p><p>ï¼ˆ2ï¼‰å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤thiså°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰ï¼›</p><p>ï¼ˆ3ï¼‰æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ï¼›</p><p>ï¼ˆ4ï¼‰è¿”å›æ–°å¯¹è±¡ã€‚</p><h2 id="new-çš„ç¼ºç‚¹"><a href="#new-çš„ç¼ºç‚¹" class="headerlink" title="new çš„ç¼ºç‚¹"></a>new çš„ç¼ºç‚¹</h2><p>å‰é¢æåˆ°äº† new è¿ç®—ç¬¦å¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ new ä¹Ÿæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯newå‡ºæ¥çš„ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ²¡æœ‰ä»»ä½•çš„è”ç³»ï¼Œåšä¸åˆ°æ•°æ®å…±äº«ï¼Œè¿™ä¸ªç¼ºç‚¹æœ‰è¿ new åˆ›å»ºçš„åˆè¡·ã€‚ä¸‹é¢çœ‹ä¸€æ®µç¤ºä¾‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.type = <span class="string">'dog'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogA = <span class="keyword">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="keyword">let</span> dogB = <span class="keyword">new</span> Dog(<span class="string">'å¤§é‡‘æ¯›'</span>);</span><br><span class="line"></span><br><span class="line">dogA.type = <span class="string">'å¤§å‹çŠ¬'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(dogB.type); <span class="comment">// 'dog'</span></span><br></pre></td></tr></table></figure></p><p>é€šè¿‡ Dog æ„é€ å‡½æ•°å®ä¾‹åŒ–å‡ºäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå¹¶ä¸ä¼šæ”¹å˜å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œè¿™å¹¶ä¸æ˜¯ new è®¾è®¡çš„åˆè¡·ï¼Œ dogA å’Œ dogB ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ— æ³•åšåˆ°æ•°æ®å…±äº«ï¼Œå°±å¥½åƒæ²¡æœ‰ä»»ä½•å…³ç³»ä¸€æ ·ã€‚</p><h2 id="prototype-çš„å¼•å…¥"><a href="#prototype-çš„å¼•å…¥" class="headerlink" title="prototype çš„å¼•å…¥"></a>prototype çš„å¼•å…¥</h2><p>ä¸ºäº†è§£å†³ä¸Šé¢æ‰€è¿°çš„é—®é¢˜ï¼Œnew çš„åˆ›å§‹äººå¼•å…¥äº† prototype å±æ€§ï¼Œ</p><blockquote><p>è¿™ä¸ªå±æ€§åŒ…å«ä¸€ä¸ªå¯¹è±¡ï¼ˆä»¥ä¸‹ç®€ç§°â€prototypeå¯¹è±¡â€ï¼‰ï¼Œæ‰€æœ‰å®ä¾‹å¯¹è±¡éœ€è¦å…±äº«çš„å±æ€§å’Œæ–¹æ³•ï¼Œéƒ½æ”¾åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢ï¼›é‚£äº›ä¸éœ€è¦å…±äº«çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°±æ”¾åœ¨æ„é€ å‡½æ•°é‡Œé¢ã€‚</p><p>å®ä¾‹å¯¹è±¡ä¸€æ—¦åˆ›å»ºï¼Œå°†è‡ªåŠ¨å¼•ç”¨prototypeå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ä¾‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œåˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯æœ¬åœ°çš„ï¼Œå¦ä¸€ç§æ˜¯å¼•ç”¨çš„ã€‚</p></blockquote><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function Dog(name)&#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">&#125;</span><br><span class="line">Dog.prototype.<span class="keyword">type</span> = <span class="string">'dog'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogA = <span class="literal">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="keyword">let</span> dogB = <span class="literal">new</span> Dog(<span class="string">'å¤§é‡‘æ¯›'</span>);</span><br><span class="line"></span><br><span class="line">console.<span class="keyword">log</span>(dogA.<span class="keyword">type</span>); <span class="comment">// dog</span></span><br><span class="line">Dog.prototype.<span class="keyword">type</span> = <span class="string">'å¤§å‹çŠ¬'</span>;</span><br><span class="line">console.<span class="keyword">log</span>(dogA.<span class="keyword">type</span>, dogB.<span class="keyword">type</span>); <span class="comment">//å¤§å‹çŠ¬ å¤§å‹çŠ¬</span></span><br></pre></td></tr></table></figure><p>typeå±æ€§æ˜¯ Dogå®ä¾‹åŒ–å‡ºçš„å¯¹è±¡æ‰€å…±äº«çš„å±æ€§ï¼Œåªè¦ä¿®æ”¹äº† prototypeä¸­çš„typeå±æ€§ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡çš„ type å€¼éƒ½ä¼šè¢«æ”¹å˜ã€‚</p><h2 id="æ„é€ å‡½æ•°å®ç°ç»§æ‰¿"><a href="#æ„é€ å‡½æ•°å®ç°ç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°å®ç°ç»§æ‰¿"></a>æ„é€ å‡½æ•°å®ç°ç»§æ‰¿</h2><p>æ„é€ å‡½æ•°å®ç°ç»§æ‰¿æœ‰å¾ˆå¤šä¸­å®ç°æ–¹å¼ï¼Œé¦–å…ˆçœ‹ç¬¬ä¸€ç§</p><h3 id="call-apply-ç»‘å®š"><a href="#call-apply-ç»‘å®š" class="headerlink" title="call apply ç»‘å®š"></a>call apply ç»‘å®š</h3><p>è¿™ç§æ˜¯ç›´æ¥å°†çˆ¶æ„é€ å‡½æ•°ç»‘å®šåœ¨å­æ„é€ å‡½æ•°ä¸­<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = <span class="string">'dog'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    Animal.call(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogA = <span class="keyword">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dogA.type); <span class="comment">// dog</span></span><br></pre></td></tr></table></figure></p><h3 id="ä½¿ç”¨prototypeè¿›è¡Œç»§æ‰¿"><a href="#ä½¿ç”¨prototypeè¿›è¡Œç»§æ‰¿" class="headerlink" title="ä½¿ç”¨prototypeè¿›è¡Œç»§æ‰¿"></a>ä½¿ç”¨prototypeè¿›è¡Œç»§æ‰¿</h3><p>ç”±äº prototype å±æ€§å¯ä»¥å­˜åœ¨å¯¹è±¡å…±äº«çš„å±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å°è£…çš„æ€æƒ³ï¼Œå°†å…¬å…±çš„éƒ¨åˆ†æŠ½ç¦»å‡ºæ¥ï¼Œå˜æˆä¸€ä¸ªå…¬å…±çš„æ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¿™äº›å¯¹è±¡çš„çˆ¶ç±»ä¹Ÿæ˜¯åŸºç±»ï¼Œæˆ‘è§‰å¾—å«åŸºç±»æ›´åŠ çš„åˆé€‚ï¼Œå› ä¸ºå®ƒå­˜å‚¨ç€æ¯ä¸€ä¸ªå¯¹è±¡çš„å…¬å…±éƒ¨åˆ†ã€‚å®ç°æ–¹å¼åªéœ€è¦å°†å­æ„é€ å‡½æ•°çš„ prototype å±æ€§èµ‹å€¼ä¸ºçˆ¶æ„é€ å‡½æ•°<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.type = <span class="string">'dog'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dog.prototype = <span class="keyword">new</span> Animal();</span><br><span class="line">Dog.prototype.constructor = Dog;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogA = <span class="keyword">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dogA.type); <span class="comment">// dog</span></span><br></pre></td></tr></table></figure></p><ul><li>ç¬¬ 9 è¡Œï¼šå°†Dog çš„åŸå‹å±æ€§èµ‹å€¼ä¸ºAnimalçš„å®ä¾‹</li><li>ç¬¬ 10 è¡Œï¼šä¿®æ”¹ prototype å±æ€§çš„costructorå¯¹è±¡ä¸ºDogï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸€ä¸ª prototype å¯¹è±¡éƒ½åŒ…å«äº†å®ƒçš„æ„é€ å‡½æ•°å¯¹è±¡ï¼Œåœ¨ä¸Šä¸€è¡Œå°† Dog çš„åŸå‹ç›´æ¥èµ‹å€¼ä¸º Animalçš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ­¤æ—¶Dogçš„åŸå‹å¯¹è±¡ä¸­çš„ constructorå…¶å®æ˜¯æŒ‡å‘Animalçš„æ„é€ å‡½æ•°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™è¾¹è¦ä¿®æ”¹å›æ¥ï¼Œä¸ç„¶å¼•èµ·åŸå‹é“¾çš„çµ®ä¹±ã€‚</li></ul><h3 id="ç›´æ¥ç»§æ‰¿prototype"><a href="#ç›´æ¥ç»§æ‰¿prototype" class="headerlink" title="ç›´æ¥ç»§æ‰¿prototype"></a>ç›´æ¥ç»§æ‰¿prototype</h3><blockquote><p>ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯å¯¹ç¬¬äºŒç§æ–¹æ³•çš„æ”¹è¿›ã€‚ç”±äºAnimalå¯¹è±¡ä¸­ï¼Œä¸å˜çš„å±æ€§éƒ½å¯ä»¥ç›´æ¥å†™å…¥Animal.prototypeã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®©Cat()è·³è¿‡ Animal()ï¼Œç›´æ¥ç»§æ‰¿Animal.prototypeã€‚</p></blockquote><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span><span class="params">()</span><span class="comment">&#123; &#125;</span>;</span></span><br><span class="line">Animal.prototype.<span class="keyword">type</span> = <span class="string">'dog'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span><span class="params">(<span class="keyword">name</span>)</span><span class="comment">&#123;</span></span></span><br><span class="line"><span class="function"><span class="comment">    this.name = name;</span></span></span><br><span class="line"><span class="function"><span class="comment">&#125;</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Dog</span>.<span class="title">prototype</span> = <span class="title">Animal</span>.<span class="title">prototype</span>;</span></span><br><span class="line">Dog.prototype.<span class="keyword">constructor</span> = Dog;</span><br><span class="line"></span><br><span class="line">let dogA = new Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line">console.log(dogA.<span class="keyword">type</span>); <span class="comment">// dog</span></span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•ç›¸æ¯”äºç¬¬äºŒç§æ–¹æ³•ï¼Œä¼˜ç‚¹æ˜¯æ•ˆç‡é«˜ï¼Œå› ä¸ºä»–è·³è¿‡äº†æ‰§è¡Œåˆ›å»ºä¸€ä¸ª Animal å®ä¾‹ï¼Œçœå†…å­˜ã€‚ä½†æ˜¯ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œç¼ºç‚¹æ˜¯ç›´æ¥å°† Animal çš„prototype å±æ€§èµ‹å€¼ç»™äº† Dog çš„ prototype è¿™æ˜¯ä¸€ä¸ªæµ…æ‹·è´ï¼Œå› ä¸ºprototype æ˜¯ä¸€ä¸ª objectï¼Œæ‰€ä»¥å¯¹äºä»»ä½•Dog çš„ prototypeçš„ä¿®æ”¹éƒ½ä¼šå“åº”åœ¨ Animal.prototypeï¼›</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log<span class="params">(Animal.prototype.<span class="attr">constructor</span> === Dog)</span>; <span class="string">//</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨ç¬¬ 9 è¡Œä¿®æ”¹äº†Dog.prototypeä¸­çš„ constructorå±æ€§ï¼Œè¿™è¾¹æ‰“å°å‘ç° Animal çš„ prototypeä¸­çš„ constructor ä¹ŸæŒ‡å‘äº† Dog</p><h3 id="åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºä¸­ä»‹"><a href="#åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºä¸­ä»‹" class="headerlink" title="åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºä¸­ä»‹"></a>åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºä¸­ä»‹</h3><p>ä¸ºäº†è§£å†³ä¸Šé¢ä¸€ç§æ–¹å¼å¼•èµ·çš„é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨ç©ºå¯¹è±¡ä½œä¸ºåª’ä»‹ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>)</span>&#123; &#125;;</span><br><span class="line">Animal.prototype.type = <span class="string">'dog'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Temp = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;;</span><br><span class="line">Temp.prototype = Animal.prototype;</span><br><span class="line">Dog.prototype = <span class="keyword">new</span> Temp();</span><br><span class="line">Dog.prototype.constructor = Dog;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogA = <span class="keyword">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dogA.type); <span class="comment">// dog</span></span><br><span class="line"><span class="built_in">console</span>.log(Animal.prototype.constructor === Dog); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p><p>åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºåª’ä»‹ï¼Œç©ºå¯¹è±¡å‡ ä¹ä¸å å†…å­˜ï¼Œä¹Ÿä¸ä¼šå½±å“ Animal çš„ prototype</p><h3 id="æ‹·è´ç»§æ‰¿"><a href="#æ‹·è´ç»§æ‰¿" class="headerlink" title="æ‹·è´ç»§æ‰¿"></a>æ‹·è´ç»§æ‰¿</h3><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†çˆ¶å¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œæ‹·è´è¿›å­å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params"></span>)</span>&#123; &#125;;</span><br><span class="line">Animal.prototype.type = <span class="string">'dog'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">extendOfCopy</span>(<span class="params">Child, Parent</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> c = Child.prototype;</span><br><span class="line">    <span class="keyword">let</span> p = Parent.prototype;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> p)&#123;</span><br><span class="line">        c[i] = p[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extendOfCopy(Dog, Animal);</span><br><span class="line"><span class="keyword">let</span> dogA = <span class="keyword">new</span> Dog(<span class="string">'å“ˆå£«å¥‡'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(dogA.type); <span class="comment">// dog</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>js å¾®ä»»åŠ¡ å®ä»»åŠ¡</title>
      <link href="/2019/07/26/js%20%E5%BE%AE%E4%BB%BB%E5%8A%A1%20%E5%AE%8F%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E8%A7%A3%E9%87%8A/"/>
      <url>/2019/07/26/js%20%E5%BE%AE%E4%BB%BB%E5%8A%A1%20%E5%AE%8F%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E8%A7%A3%E9%87%8A/</url>
      
        <content type="html"><![CDATA[<blockquote><p>js æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œjsä¸­çš„ä»»åŠ¡æŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªçš„æ‰§è¡Œï¼Œä½†æ˜¯ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¤ªé•¿ï¼Œé‚£ä¹ˆåé¢çš„ä»»åŠ¡å°±éœ€è¦ç­‰å¾…ï¼Œä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œå°†ä»»åŠ¡åˆ†ä¸ºäº†åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼Œè€Œå¼‚æ­¥ä»»åŠ¡åˆå¯ä»¥åˆ†ä¸ºå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡ã€‚</p></blockquote><p>é¦–å…ˆç¬¬ä¸€æ®µç¤ºä¾‹ä»£ç <br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">console.<span class="built_in">log</span>(<span class="string">'script start'</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="string">'setTimeout'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">Promise.resolve().<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="string">'promise1'</span>);</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">  console.<span class="built_in">log</span>(<span class="string">'promise2'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">'script end'</span>);</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>æ‰“å°é¡ºåºä¸ºï¼š<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">script start</span><br><span class="line">script end</span><br><span class="line">promise1</span><br><span class="line">promise</span><br><span class="line">setTimeout</span><br></pre></td></tr></table></figure></p><p>å…·ä½“ä¸ºä»€ä¹ˆä¼šæ‰“å°å‡ºè¿™ä¸ªé¡ºåºï¼Œä¸‹é¢åœ¨å…·ä½“è§£é‡Šã€‚<br>æˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹jsçš„æ‰§è¡Œæµç¨‹ï¼š<br><img src="http://static.zybuluo.com/shenweizheng/iy5q6fscnpe2c6cch47ck9na/image_1dglrup181e0m18gr10lc187e19549.png" alt="image_1dglrup181e0m18gr10lc187e19549.png-496.3kB"></p><p><a href="https://juejin.im/post/5b498d245188251b193d4059" target="_blank" rel="noopener">å¼ å€©qianniuerlv-2 JSäº‹ä»¶å¾ªç¯æœºåˆ¶ï¼ˆevent loopï¼‰ä¹‹å®ä»»åŠ¡/å¾®ä»»åŠ¡</a>è§£è¯»ï¼š</p><ol><li>åŒæ­¥å’Œå¼‚æ­¥ä»»åŠ¡åˆ†åˆ«è¿›å…¥ä¸åŒçš„æ‰§è¡Œâ€åœºæ‰€â€ï¼ŒåŒæ­¥çš„è¿›å…¥ä¸»çº¿ç¨‹ï¼Œå¼‚æ­¥çš„è¿›å…¥Event Tableå¹¶æ³¨å†Œå‡½æ•°</li><li>å½“æŒ‡å®šçš„äº‹æƒ…å®Œæˆæ—¶ï¼ŒEvent Tableä¼šå°†è¿™ä¸ªå‡½æ•°ç§»å…¥Event Queueã€‚</li><li>ä¸»çº¿ç¨‹å†…çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¸ºç©ºï¼Œä¼šå»Event Queueè¯»å–å¯¹åº”çš„å‡½æ•°ï¼Œè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œã€‚</li><li>ä¸Šè¿°è¿‡ç¨‹ä¼šä¸æ–­é‡å¤ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„Event Loop(äº‹ä»¶å¾ªç¯)ã€‚</li></ol><p>åœ¨jså¼•æ“ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå«monitoring processçš„è¿›ç¨‹ï¼Œè¿™ä¸ªè¿›ç¨‹ä¼šä¸æ–­çš„æ£€æŸ¥ä¸»çº¿ç¨‹çš„æ‰§è¡Œæƒ…å†µï¼Œä¸€æ—¦ä¸ºç©ºï¼Œå°±ä¼šå»Event Queneæ£€æŸ¥æœ‰å“ªäº›å¾…æ‰§è¡Œçš„å‡½æ•°ã€‚</p><h2 id="å¾®ä»»åŠ¡-å’Œ-å®ä»»åŠ¡"><a href="#å¾®ä»»åŠ¡-å’Œ-å®ä»»åŠ¡" class="headerlink" title="å¾®ä»»åŠ¡ å’Œ å®ä»»åŠ¡"></a>å¾®ä»»åŠ¡ å’Œ å®ä»»åŠ¡</h2><blockquote><p>å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„é—®é¢˜åº”è¯¥æ˜¯å‰ç«¯é¢è¯•ä¸­æ¯”è¾ƒå¸¸è§çš„ï¼Œä»–ä»¬éƒ½ä»å±äºå¼‚æ­¥ä»»åŠ¡ï¼Œä¸»è¦åŒºåˆ«åœ¨äºä»–ä»¬çš„æ‰§è¡Œé¡ºåºï¼ŒEvent Loopçš„èµ°å‘å’Œå–å€¼</p></blockquote><p><img src="http://static.zybuluo.com/shenweizheng/cegc5egyrr3orq4ylwf1136k/image_1dglsb50i1tvh1ul01ur318fa6h39.png" alt="image_1dglsb50i1tvh1ul01ur318fa6h39.png-293.5kB"></p><p>è¿™å¼ å›¾çš„æ„æ€å°±æ˜¯ï¼š</p><ol><li>å­˜åœ¨å¾®ä»»åŠ¡çš„è¯ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡</li><li>å¾®ä»»åŠ¡éƒ½æ‰§è¡Œå®Œä¹‹åï¼Œæ‰§è¡Œç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼Œ</li><li>å¾ªç¯ 1ï¼Œ 2</li></ol><p>ä»å‚è€ƒåšä¸»çš„åšå®¢é‡Œçœ‹åˆ°è¿™æ®µï¼Œè¿™è¾¹ä¸å¾—ä¸æä¸€å¥ï¼Œæˆ‘ä¹Ÿæ˜¯çœ‹äº†è¿™ä¸ºåšä¸»çš„åšå®¢æ‰ç†æ¸…æ¥šäº†å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„æ¦‚å¿µã€‚åšä¸»çš„é“¾æ¥ä¼šåœ¨æ–‡ç« æœ«ç»™å‡ºã€‚</p><blockquote><p>ä¸€ä¸ªæ˜é‡‘çš„è€å“¥ï¼ˆssssyokiï¼‰çš„æ–‡ç« æ‘˜è¦ï¼š<br>é‚£ä¹ˆå¦‚æ­¤çœ‹æ¥æˆ‘ç»™çš„ç­”æ¡ˆè¿˜æ˜¯å¯¹çš„ã€‚ä½†æ˜¯jså¼‚æ­¥æœ‰ä¸€ä¸ªæœºåˆ¶ï¼Œå°±æ˜¯é‡åˆ°å®ä»»åŠ¡ï¼Œå…ˆæ‰§è¡Œå®ä»»åŠ¡ï¼Œå°†å®ä»»åŠ¡æ”¾å…¥eventqueueï¼Œç„¶ååœ¨æ‰§è¡Œå¾®ä»»åŠ¡ï¼Œå°†å¾®ä»»åŠ¡æ”¾å…¥eventqueueæœ€éªšçš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªqueueä¸æ˜¯ä¸€ä¸ªqueueã€‚å½“ä½ å¾€å¤–æ‹¿çš„æ—¶å€™å…ˆä»å¾®ä»»åŠ¡é‡Œæ‹¿è¿™ä¸ªå›æ‰å‡½æ•°ï¼Œç„¶åå†ä»å®ä»»åŠ¡çš„queueä¸Šæ‹¿å®ä»»åŠ¡çš„å›æ‰å‡½æ•°ã€‚ æˆ‘å½“æ—¶çœ‹åˆ°è¿™æˆ‘å°±æœäº†è¿˜æœ‰è¿™ç§éªšæ“ä½œã€‚</p></blockquote><p>è¿™è¾¹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡æ˜¯åŒå±äºä¸¤ä¸ªä¸åŒçš„é˜Ÿåˆ—çš„ï¼ï¼ï¼</p><ul><li>å®ä»»åŠ¡ä¸€èˆ¬åŒ…æ‹¬ï¼šæ•´ä½“ä»£ç scriptï¼ŒsetTimeoutï¼ŒsetIntervalã€setImmediateã€‚</li><li>å¾®ä»»åŠ¡ä¸€èˆ¬åŒ…æ‹¬ï¼šåŸç”ŸPromise(æœ‰äº›å®ç°çš„promiseå°†thenæ–¹æ³•æ”¾åˆ°äº†å®ä»»åŠ¡ä¸­)ã€process.nextTickã€Object.observe(å·²åºŸå¼ƒ)ã€ MutationObserver </li></ul><p>ä¸€æ®µä¸§å¿ƒç—…ç‹‚çš„ä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'1'</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'2'</span>);</span><br><span class="line">    process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'3'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'4'</span>);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'5'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'6'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'7'</span>);</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'8'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'9'</span>);</span><br><span class="line">    process.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'10'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'11'</span>);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'12'</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€è½®å¾ªç¯ï¼š</p><ul><li>é¦–å…ˆæ‰“å° 1</li><li>ä¸‹é¢æ˜¯setTimeoutæ˜¯å¼‚æ­¥ä»»åŠ¡ä¸”æ˜¯å®ä»»åŠ¡ï¼ŒåŠ å…¥å®ä»»åŠ¡æš‚ä¸”è®°ä¸º setTimeout1</li><li>ä¸‹é¢æ˜¯ process å¾®ä»»åŠ¡ åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ— è®°ä¸º process1</li><li>ä¸‹é¢æ˜¯ new Promise é‡Œé¢ç›´æ¥ resolve(7) æ‰€ä»¥æ‰“å° 7 åé¢çš„thenæ˜¯å¾®ä»»åŠ¡ è®°ä¸º then1</li><li>setTimeout å®ä»»åŠ¡ è®°ä¸º setTimeout2</li></ul><p>ç¬¬ä¸€è½®å¾ªç¯æ‰“å°å‡ºçš„æ˜¯ 1 7<br>å½“å‰å®ä»»åŠ¡é˜Ÿåˆ—ï¼šsetTimeout1, setTimeout2<br>å½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼šprocess1, then1, </p><p>ç¬¬äºŒè½®å¾ªç¯ï¼š</p><ul><li>æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡</li><li>æ‰§è¡Œprocess1ï¼Œæ‰“å°å‡º 6 </li><li>æ‰§è¡Œthen1 æ‰“å°å‡º8</li><li>å¾®ä»»åŠ¡éƒ½æ‰§è¡Œç»“æŸäº†ï¼Œå¼€å§‹æ‰§è¡Œç¬¬ä¸€ä¸ªå®ä»»åŠ¡</li><li>æ‰§è¡Œ  setTimeout1 ä¹Ÿå°±æ˜¯ ç¬¬ 3 - 14 è¡Œ</li><li>é¦–å…ˆæ‰“å°å‡º 2</li><li>é‡åˆ° process å¾®ä»»åŠ¡ è®°ä¸º process2</li><li>new Promiseä¸­resolve æ‰“å°å‡º 4</li><li>then å¾®ä»»åŠ¡ è®°ä¸º then2</li></ul><p>ç¬¬äºŒè½®å¾ªç¯ç»“æŸï¼Œå½“å‰æ‰“å°å‡ºæ¥çš„æ˜¯  1 7 6 8 2 4<br>å½“å‰å®ä»»åŠ¡é˜Ÿåˆ—ï¼šsetTimeout2<br>å½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼šprocess2, then2</p><p>ç¬¬ä¸‰è½®å¾ªç¯ï¼š</p><ul><li>æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡</li><li>æ‰§è¡Œ process2 æ‰“å°å‡º 3</li><li>æ‰§è¡Œ then2 æ‰“å°å‡º 5</li><li>æ‰§è¡Œç¬¬ä¸€ä¸ªå®ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ setTimeout2 å¯¹åº”ä»£ç ä¸­çš„ 25 - 36 è¡Œ</li><li>é¦–å…ˆæ‰“å°å‡º 9</li><li>process å¾®ä»»åŠ¡ è®°ä¸º process3</li><li>new Promiseæ‰§è¡Œresolve æ‰“å°å‡º 11</li><li>then å¾®ä»»åŠ¡ è®°ä¸º then3</li></ul><p>å½“å‰æ‰“å°é¡ºåºä¸ºï¼š1 7 6 8 2 4 3 5 9 11<br>å½“å‰å®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º<br>å½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼šprocess3ï¼Œthen3</p><p>ç¬¬å››è½®å¾ªç¯ï¼š</p><ul><li>æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡</li><li>æ‰§è¡Œprocess3 æ‰“å°å‡º 10</li><li>æ‰§è¡Œthen3 æ‰“å°å‡º 12</li></ul><p>ä»£ç æ‰§è¡Œç»“æŸï¼š<br>æœ€ç»ˆæ‰“å°é¡ºåºä¸ºï¼š1 7 6 8 2 4 3 5 9 11 10 12<br>(è¯·æ³¨æ„ï¼Œnodeç¯å¢ƒä¸‹çš„äº‹ä»¶ç›‘å¬ä¾èµ–libuvä¸å‰ç«¯ç¯å¢ƒä¸å®Œå…¨ç›¸åŒï¼Œè¾“å‡ºé¡ºåºå¯èƒ½ä¼šæœ‰è¯¯å·®)</p><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="https://juejin.im/post/5b498d245188251b193d4059" target="_blank" rel="noopener">JSäº‹ä»¶å¾ªç¯æœºåˆ¶ï¼ˆevent loopï¼‰ä¹‹å®ä»»åŠ¡/å¾®ä»»åŠ¡</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¯¹ js ä¸­çš„this çš„ç†è§£</title>
      <link href="/2019/07/25/%E5%AF%B9%20js%20%E4%B8%AD%20this%20%E6%8C%87%E5%90%91%E7%9A%84%E7%90%86%E8%A7%A3/"/>
      <url>/2019/07/25/%E5%AF%B9%20js%20%E4%B8%AD%20this%20%E6%8C%87%E5%90%91%E7%9A%84%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>this æŒ‡é’ˆä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªå¾ˆç„å­¦çš„ä¸œè¥¿ï¼Œå®ƒæ˜¯å‡½æ•°è¿è¡Œæ—¶ï¼Œå‡½æ•°å†…éƒ¨è‡ªåŠ¨ç”Ÿæˆçš„å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨ã€‚ä¸€ä¸‹ç¤ºä¾‹éƒ½æ˜¯æµ‹è¯•è¿‡çš„ï¼Œå¯¹äºç­”æ¡ˆè¯·æ”¾å¿ƒã€‚å¦‚æœ‰ç–‘é—®æ¬¢è¿è¯„è®º</p></blockquote><a id="more"></a><h2 id="çº¯ç²¹çš„å‡½æ•°è°ƒç”¨"><a href="#çº¯ç²¹çš„å‡½æ•°è°ƒç”¨" class="headerlink" title="çº¯ç²¹çš„å‡½æ•°è°ƒç”¨"></a>çº¯ç²¹çš„å‡½æ•°è°ƒç”¨</h2><blockquote><p>è¿™æ˜¯å‡½æ•°é€šå¸¸çš„ç”¨æ³•ï¼Œå±äºå…¨å±€æ€§çš„è°ƒç”¨ï¼Œæ‰€ä»¥thisæŒ‡å‘å…¨å±€ã€‚</p></blockquote><p>æœ€ç®€å•çš„ç¤ºä¾‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</span><br><span class="line">&#125;</span><br><span class="line">test();  <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p><h2 id="ä½œä¸ºå¯¹è±¡çš„ä¸€ä¸ªå±æ€§"><a href="#ä½œä¸ºå¯¹è±¡çš„ä¸€ä¸ªå±æ€§" class="headerlink" title="ä½œä¸ºå¯¹è±¡çš„ä¸€ä¸ªå±æ€§"></a>ä½œä¸ºå¯¹è±¡çš„ä¸€ä¸ªå±æ€§</h2><blockquote><p>æ­¤æ—¶ï¼Œè°è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨çš„thiså°±æŒ‡å‘è°</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span>;</span><br><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    name: <span class="string">'test'</span>,</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">test.getName(); <span class="comment">// test</span></span><br></pre></td></tr></table></figure><h2 id="ä½œä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§"><a href="#ä½œä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§" class="headerlink" title="ä½œä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§"></a>ä½œä¸ºæ„é€ å‡½æ•°çš„ä¸€ä¸ªå±æ€§</h2><blockquote><p>thisæŒ‡å‘å½“å‰å®ä¾‹</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">'test'</span>;</span><br><span class="line">    <span class="keyword">this</span>.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> test = <span class="keyword">new</span> Test();</span><br><span class="line">test.getName(); <span class="comment">// test</span></span><br></pre></td></tr></table></figure><h2 id="callã€applyã€bindä¿®æ”¹thisæŒ‡å‘"><a href="#callã€applyã€bindä¿®æ”¹thisæŒ‡å‘" class="headerlink" title="callã€applyã€bindä¿®æ”¹thisæŒ‡å‘"></a>callã€applyã€bindä¿®æ”¹thisæŒ‡å‘</h2><p>ä½¿ç”¨call å’Œ apply æ–¹æ³•å¯ä»¥ä¿®æ”¹thisçš„æŒ‡å‘ï¼Œä¸¤è€…çš„åŒºåˆ«ä¸ºï¼š</p><blockquote><p>call thisåé¢çš„å‚æ•°ä¸ºä¸€ä¸ªå‚æ•°åˆ—è¡¨<br>apply thisåé¢çš„å‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„<br>bind bindç»‘å®šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œbindçš„ä¸­thisåé¢çš„å‚æ•°æ˜¯é¢„å…ˆæ·»åŠ åˆ°ç»‘å®šå‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¸­çš„å‚æ•°ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    name: <span class="string">'test'</span>,</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params">extraParam1, extraParam2</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name, extraParam1, extraParam2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testCall = &#123;</span><br><span class="line">    name: <span class="string">'testCall'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test.getName.call(testCall,<span class="string">'extraParam1'</span>,<span class="string">'extraParam2'</span>);</span><br><span class="line"><span class="comment">// testCall extraParam1 extraParam2</span></span><br></pre></td></tr></table></figure><p>è¿™è¾¹å¯ä»¥çœ‹åˆ°æ‰“å°å‡ºçš„æ—¶testCallå¯¹è±¡çš„nameå±æ€§ï¼Œå¹¶ä¸”callæ–¹æ³•åé¢æºå¸¦çš„æ˜¯ä¸€ä¸ªå‚æ•°åˆ—è¡¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    name: <span class="string">'test'</span>,</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params">extraParam1, extraParam2</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name, extraParam1, extraParam2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testApply = &#123;</span><br><span class="line">    name: <span class="string">'testApply'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test.getName.apply(testApply,[<span class="string">'extraParam1'</span>,<span class="string">'extraParam2'</span>]);</span><br><span class="line"><span class="comment">// testApply extraParam1 extraParam2</span></span><br></pre></td></tr></table></figure><p>applyçš„å‚æ•°ä¸ºä¸€ä¸ªå‚æ•°æ•°ç»„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    name: <span class="string">'test'</span>,</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params">extraParam1, extraParam2</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name, extraParam1, extraParam2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testBind = &#123;</span><br><span class="line">    name: <span class="string">'testBind'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> getNameBind = test.getName.bind(testBind,<span class="string">'å‰ç½®å‚æ•°'</span>);</span><br><span class="line">getNameBind(<span class="string">'extraParam1'</span>); <span class="comment">// testBind å‰ç½®å‚æ•° extraParam1</span></span><br><span class="line">test.getName(<span class="string">'extraParam1'</span>,<span class="string">'extraParam2'</span>); <span class="comment">// test extraParam1 extraParam2</span></span><br></pre></td></tr></table></figure><p>bindè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°</p><h2 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h2><blockquote><p>ç®­å¤´å‡½æ•°æœ¬èº«å¹¶ä¸å…·å¤‡thiså¯¹è±¡ï¼Œå†…éƒ¨çš„thiså¯¹è±¡æ˜¯ç»§æ‰¿çˆ¶çº§ä½œç”¨åŸŸä¸­çš„this,ä¸”ç®­å¤´å‡½æ•°çš„thisä¸å¯ä½¿ç”¨callã€applyä¿®æ”¹æŒ‡å‘ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹çˆ¶çº§çš„thisæ¥å®ç°ã€‚ç®€å•æ¥è¯´è¦æƒ³çŸ¥é“ç®­å¤´å‡½æ•°çš„thisï¼Œéœ€è¦æŸ¥çœ‹ç®­å¤´å‡½æ•°çš„å®šä¹‰ä½ç½®ï¼Œè€Œä¸æ˜¯è°ƒç”¨ä½ç½®ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.name = <span class="string">'window'</span>;</span><br><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    name: <span class="string">'getName'</span>,</span><br><span class="line">    getName: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testCall = &#123;</span><br><span class="line">    name: <span class="string">'testCall'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testApply = &#123;</span><br><span class="line">    name: <span class="string">'testApply'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testBind = &#123;</span><br><span class="line">    name: <span class="string">'testBind'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test.getName(); <span class="comment">// window</span></span><br><span class="line">test.getName.call(testCall); <span class="comment">// window</span></span><br><span class="line">test.getName.apply(testApply); <span class="comment">// window</span></span><br><span class="line">test.getName.bind(testBind)(); <span class="comment">// window</span></span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°å®šä¹‰åœ¨ test å¯¹è±¡çš„å†…éƒ¨ï¼Œtestçš„ä½œç”¨åŸŸä¸ºå…¨å±€ä½œç”¨åŸŸï¼Œæ‰€ä»¥ï¼ŒgetNameå‡½æ•°ä¸­çš„thisæŒ‡å‘çš„æ˜¯å…¨å±€ï¼Œä¸è°ƒç”¨ä½ç½®æ— å…³ã€‚ä¸”æ— æ³•é€šè¿‡call apply bind ç›´æ¥ä¿®æ”¹thisæŒ‡å‘ã€‚ç„¶ååœ¨çœ‹ä¸‹ä¸€ä¸ªç¤ºä¾‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.name = <span class="string">'window'</span>;</span><br><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    name: <span class="string">'test'</span>,</span><br><span class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testCall = &#123;</span><br><span class="line">    name: <span class="string">'testCall'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testApply = &#123;</span><br><span class="line">    name: <span class="string">'testApply'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> testBind = &#123;</span><br><span class="line">    name: <span class="string">'testBind'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test.getName()(); <span class="comment">// test</span></span><br><span class="line">test.getName.call(testCall)(); <span class="comment">// testCall</span></span><br><span class="line">test.getName.apply(testApply)(); <span class="comment">// testApply</span></span><br><span class="line">test.getName.bind(testBind)()(); <span class="comment">// testBind</span></span><br></pre></td></tr></table></figure><p>getNameå‡½æ•°è¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œæ‰€ä»¥åˆå§‹æ—¶ç®­å¤´å‡½æ•°çš„çˆ¶çº§ä½œç”¨åŸŸä¸ºgetNameå‡½æ•°çš„å†…éƒ¨ä½œç”¨åŸŸï¼Œæ‰€ä»¥æ­¤æ—¶thisæŒ‡å‘åº”è¯¥æ˜¯çœ‹è°è°ƒç”¨getNameå°±æŒ‡å‘è°ã€‚æ—¢ç„¶å¦‚æ­¤çš„è¯ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡callã€applyã€bindæ¥ä¿®æ”¹getNameçš„thisæŒ‡å‘ä»è€Œæ”¹å˜ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘ã€‚</p><p>è¯´å®Œä»¥ä¸Šå‡ ç§æƒ…å†µï¼Œä¸‹é¢çœ‹ä¸¤ä¸ªç»¼åˆé¢˜<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person1 = &#123;</span><br><span class="line">    name: <span class="string">'person1'</span>,</span><br><span class="line">    show1: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;,</span><br><span class="line">    show2: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.name),</span><br><span class="line">    show3: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    show4: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person2 = &#123; <span class="attr">name</span>: <span class="string">'person2'</span> &#125;</span><br><span class="line"></span><br><span class="line">person1.show1() <span class="comment">// person1</span></span><br><span class="line">person1.show1.call(person2) <span class="comment">// person2</span></span><br><span class="line"></span><br><span class="line">person1.show2() <span class="comment">// window</span></span><br><span class="line">person1.show2.call(person2) <span class="comment">// window</span></span><br><span class="line"></span><br><span class="line">person1.show3()() <span class="comment">// window</span></span><br><span class="line">person1.show3().call(person2) <span class="comment">// person2</span></span><br><span class="line">person1.show3.call(person2)() <span class="comment">// window</span></span><br><span class="line"></span><br><span class="line">person1.show4()() <span class="comment">// person1</span></span><br><span class="line">person1.show4().call(person2) <span class="comment">// person1</span></span><br><span class="line">person1.show4.call(person2)() <span class="comment">// person2</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ 20 è¡Œï¼šshow1ä¸ºæ™®é€šå‡½æ•°ï¼ŒthisæŒ‡å‘è°ƒç”¨å¯¹è±¡ï¼Œè¿™è¾¹æ˜¯person1è°ƒç”¨ï¼Œæ‰€ä»¥æŒ‡å‘person1</p><p>ç¬¬ 21 è¡Œï¼šä½¿ç”¨callå°†show1å‡½æ•°çš„æŒ‡é’ˆæŒ‡å‘person2</p><p>ç¬¬ 23 è¡Œï¼šshow2å‡½æ•°ä¸ºç®­å¤´å‡½æ•°ï¼Œçˆ¶çº§ä½œç”¨åŸŸä¸ºperson1ä½œç”¨åŸŸå³å…¨å±€ä½œç”¨åŸŸï¼Œæ‰€ä»¥thisæŒ‡å‘window</p><p>åœ° 24 è¡Œï¼šç®­å¤´å‡½æ•°çš„thisæŒ‡å‘åœ¨å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šã€‚ä¸éšç€callè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥æ­¤å¤„thisä¾æ—§æ˜¯æŒ‡å‘window</p><p>ç¬¬ 26 è¡Œï¼šshow3 è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªè¿”å›çš„å‡½æ•°ï¼Œæ­¤è¡Œç­‰ä»·äº<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let show<span class="number">3</span> = perso<span class="symbol">n1</span>.show<span class="number">3</span><span class="comment">()</span>; </span><br><span class="line">show<span class="number">3</span><span class="comment">()</span></span><br></pre></td></tr></table></figure></p><p>å±äºç¬¬ä¸€ç§æƒ…å†µï¼Œå‡½æ•°çš„ç›´æ¥è°ƒç”¨ï¼ŒthisæŒ‡å‘å…¨å±€</p><p>ç¬¬ 27 è¡Œï¼šä½¿ç”¨callå°†show3å‡½æ•°è¿”å›çš„å‡½æ•°çš„thisæŒ‡å‘äº†person2ï¼Œç­‰ä»·ä¸äº<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let show<span class="number">3</span> = perso<span class="symbol">n1</span>.show<span class="number">3</span><span class="comment">()</span>;</span><br><span class="line">show<span class="number">3.</span><span class="keyword">call</span><span class="comment">(person2)</span>;</span><br></pre></td></tr></table></figure></p><p>ç¬¬ 28 è¡Œï¼šå’Œç¬¬ 26 è¡Œé“ç†ä¸€æ ·ï¼Œç­‰ä»·äº<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let show<span class="number">3</span> = perso<span class="symbol">n1</span>.show<span class="number">3.</span><span class="keyword">call</span><span class="comment">(person2)</span>;</span><br><span class="line">show<span class="number">3</span><span class="comment">()</span>;</span><br></pre></td></tr></table></figure></p><p>å‡½æ•°ç›´æ¥è°ƒç”¨ï¼ŒthisæŒ‡å‘å…¨å±€</p><p>ç¬¬ 30 è¡Œï¼šshow4è¿”å›çš„æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„thisæ˜¯ç»§æ‰¿çš„çˆ¶çº§å‡½æ•°show4çš„thisï¼Œæ‰€ä»¥æ­¤å¤„ç®­å¤´å‡½æ•°çš„thiså–å†³äºshow4çš„thisæŒ‡å‘ï¼Œæ­¤å¤„ä½¿ç”¨person1è¿›è¡Œè°ƒç”¨ï¼Œæ‰€ä»¥shoe4çš„thisæŒ‡å‘person1</p><p>ç¬¬ 31 è¡Œï¼šshow4è¿”å›çš„æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„thisä¸ä¼šè¢«callæ”¹å˜ï¼Œä¾æ—§æ—¶å–å†³äºçˆ¶çº§çš„show4å‡½æ•°çš„thisï¼Œæ­¤å¤„person1è¿›è¡Œè°ƒç”¨ï¼Œæ‰€ä»¥ä¾æ—§æ˜¯æŒ‡å‘çš„this</p><p>ç¬¬ 32 è¡Œï¼šä¿®æ”¹äº†show4å‡½æ•°çš„thisæŒ‡å‘ï¼ŒæŒ‡å‘äº†person2ï¼Œç”±äºä¸Šé¢è¯´çš„ï¼Œæ­¤å¤„ç®­å¤´å‡½æ•°çš„thisæ˜¯å–å†³äºshow4çš„ï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°çš„thisä¹ŸæŒ‡å‘äº†person2ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'window'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.show1 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.show2 = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    <span class="keyword">this</span>.show3 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.show4 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> personA = <span class="keyword">new</span> Person(<span class="string">'personA'</span>)</span><br><span class="line"><span class="keyword">var</span> personB = <span class="keyword">new</span> Person(<span class="string">'personB'</span>)</span><br><span class="line"></span><br><span class="line">personA.show1() <span class="comment">// personA</span></span><br><span class="line">personA.show1.call(personB) <span class="comment">// personB</span></span><br><span class="line"></span><br><span class="line">personA.show2() <span class="comment">// personA</span></span><br><span class="line">personA.show2.call(personB) <span class="comment">// personA</span></span><br><span class="line"></span><br><span class="line">personA.show3()() <span class="comment">// window</span></span><br><span class="line">personA.show3().call(personB) <span class="comment">// personB</span></span><br><span class="line">personA.show3.call(personB)() <span class="comment">// window</span></span><br><span class="line"></span><br><span class="line">personA.show4()() <span class="comment">// personA</span></span><br><span class="line">personA.show4().call(personB) <span class="comment">// personA</span></span><br><span class="line">personA.show4.call(personB)() <span class="comment">// personB</span></span><br></pre></td></tr></table></figure><p>æ­¤é¢˜æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶ä¸”ç¤ºä¾‹åŒ–å‡ºä¸¤ä¸ªå¯¹è±¡ï¼ŒpersonA å’Œ personBã€‚<br>ç¬¬ 22 è¡Œï¼šæ„é€ å‡½æ•°å®ä¾‹çš„å¯¹è±¡è°ƒç”¨å‡½æ•°ï¼Œå‡½æ•°thisæŒ‡å‘è°ƒç”¨å¯¹è±¡ï¼Œæ‰€ä»¥æ­¤å¤„æ˜¯æŒ‡å‘äº†personA</p><p>ç¬¬ 23 è¡Œï¼šshow1å‡½æ•°çš„thisè¢«callä¿®æ”¹ï¼ŒæŒ‡å‘ personB</p><p>ç¬¬ 25 è¡Œï¼šshow2 ä¸ºä¸€ä¸ªç®­å¤´å‡½æ•°ï¼ŒthisæŒ‡å‘çˆ¶çº§ä½œç”¨åŸŸï¼Œæ­¤å¤„ä¹Ÿå°±æ˜¯æ„é€ å‡½æ•°å†…éƒ¨ï¼Œå–å†³äºè°ƒç”¨å¯¹è±¡ï¼Œæ­¤å¤„æ˜¯personAè¿›è¡Œè°ƒç”¨ï¼Œæ‰€ä»¥thisæŒ‡å‘äº†personA</p><p>ç¬¬ 26 è¡Œï¼šç®­å¤´å‡½æ•°çš„thisæŒ‡å‘ä¸ä¼šè¢«callä¿®æ”¹ï¼Œæ‰€ä»¥ä¾æ—§æ˜¯æŒ‡å‘personA</p><p>ç¬¬ 28 è¡Œï¼šshow3 è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå±äºå…¨å±€è°ƒç”¨ï¼ŒthisæŒ‡å‘å…¨å±€ï¼Œç­‰ä»·äº<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let show3 = personA.show3()<span class="comment">;</span></span><br><span class="line">show3()<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ 29 è¡Œï¼šç­‰ä»·äº<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let show3 = personA.show3()<span class="comment">;</span></span><br><span class="line">show3.call(personB)<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ 30 è¡Œï¼šç­‰ä»·äº<br><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let show3 = personA.show3.call(personB)<span class="comment">;</span></span><br><span class="line">show3()<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ 32 è¡Œï¼šshow4 è¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œå–å†³äºshow4çš„è°ƒç”¨è€…ï¼Œæ­¤å¤„ä¸º personA</p><p>ç¬¬ 33 è¡Œï¼šç®­å¤´å‡½æ•°çš„thisä¸ä¼šè¢«callä¿®æ”¹ï¼Œæ­¤å¤„ä¾æ—§å–å†³äº show4 çš„è°ƒç”¨è€…ï¼ŒæŒ‡å‘ personA</p><p>ç¬¬ 34 è¡Œï¼šä¿®æ”¹ show4 çš„thisæŒ‡å‘ï¼Œè€Œç®­å¤´å‡½æ•°çš„thiså–å†³äºshow4 æ‰€ä»¥æ­¤å¤„thisæŒ‡å‘äº† personB</p><p>ä»¥ä¸Šä¸ºå¯¹jsä¸­thisæŒ‡å‘çš„é˜è¿°ã€‚å¾—å‡ºç»“è®ºï¼šä»£ç  === ç„å­¦</p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>js å˜é‡æå‡å’Œä½œç”¨åŸŸçš„ç†è§£</title>
      <link href="/2019/07/25/js%20%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9A%84i%E7%90%86%E8%A7%A3/"/>
      <url>/2019/07/25/js%20%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9A%84i%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<blockquote><p>js ä¸­çš„å˜é‡æå‡å¤§ä½“å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ var å£°æ˜çš„å˜é‡ï¼Œå¦ä¸€ç§æ˜¯å‡½æ•°çš„å˜é‡æå‡ï¼Œè€Œå‡½æ•°çš„åˆ›å»ºå¯ä»¥åˆ†ä¸ºå‡½æ•°å£°æ˜å’Œå‡½æ•°è¡¨è¾¾å¼ä¸¤ç§ï¼Œè¿™ä¸¤ç§å…·æœ‰ä¸åŒçš„å˜é‡æå‡ï¼Œä»¥ä¸‹ä¸ºæœ¬äººæ ¹æ®è‡ªå·±çš„ç†è§£å‚è€ƒå…¶ä»–åšä¸»çš„åšå®¢å¾—å‡ºçš„çœ‹æ³•ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿æŒ‡æ­£ã€‚</p></blockquote><h2 id="ä½¿ç”¨varå£°æ˜çš„å˜é‡"><a href="#ä½¿ç”¨varå£°æ˜çš„å˜é‡" class="headerlink" title="ä½¿ç”¨varå£°æ˜çš„å˜é‡"></a>ä½¿ç”¨varå£°æ˜çš„å˜é‡</h2><p>æˆ‘ä»¬é¦–å…ˆå…ˆçœ‹ä¸€æ®µä»£ç ï¼Œ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scopeTest</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test); <span class="comment">// undefined</span></span><br><span class="line">    <span class="keyword">var</span> test = <span class="string">'hello'</span>;</span><br><span class="line">&#125;</span><br><span class="line">scopeTest();</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>ä»¥ä¸Šä»£ç è¾“å‡ºçš„ç»“æœæ˜¯ <code>undefined</code>ï¼ŒåŸå› æ˜¯ js å¯¹äºä½¿ç”¨varå£°æ˜çš„å˜é‡å…·æœ‰å˜é‡æå‡çš„ç‰¹æ€§ï¼Œå‡½æ•°å†…éƒ¨ä¼šé¦–å…ˆå£°æ˜å‡½æ•°å†…éƒ¨éœ€è¦çš„å˜é‡å¹¶èµ‹å€¼ä¸ºundefinedã€‚ä»¥ä¸Šä»£ç ç­‰ä»·äº<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scopeTest</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> test;</span><br><span class="line">    <span class="built_in">console</span>.log(test);</span><br><span class="line">    test = <span class="string">'hello'</span>;</span><br><span class="line">&#125;</span><br><span class="line">scopeTest();</span><br></pre></td></tr></table></figure></p><blockquote><p>æ²¡æœ‰ä½¿ç”¨varå£°æ˜çš„ä¼šå˜æˆå…¨å±€å˜é‡<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = <span class="string">'hello'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scopeTest</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(test) <span class="comment">// hello</span></span><br><span class="line">    test = <span class="string">'helloworld'</span>;</span><br><span class="line">&#125;</span><br><span class="line">scopeTest();</span><br><span class="line"><span class="built_in">console</span>.log(test); <span class="comment">// helloworld</span></span><br></pre></td></tr></table></figure></p></blockquote><p>å‡½æ•°ä¸­çš„ test å˜é‡æ²¡æœ‰ä½¿ç”¨varè¿›è¡Œå£°æ˜ï¼Œæ‰€ä»¥å¹¶ä¸å…·å¤‡å˜é‡æå‡ï¼Œæ­¤æ—¶æ‰“å°ï¼Œæ‰“å°çš„æ˜¯ä¸Šå±‚ä½œç”¨åŸŸçš„testå³ helloï¼Œç”±äº test æ˜¯ç›´æ¥å£°æ˜çš„ï¼Œé‚£ä¹ˆ test ä¼šæˆä¸ºå…¨å±€å˜é‡ï¼Œè¦†ç›–æ‰å·²ç»æœ‰çš„ test ï¼Œæ‰€ä»¥ä¸ºå‡½æ•°æ‰§è¡Œå®Œæ‰“å° test è¾“å‡ºçš„æ˜¯ helloworld</p><h2 id="å‡½æ•°æå‡"><a href="#å‡½æ•°æå‡" class="headerlink" title="å‡½æ•°æå‡"></a>å‡½æ•°æå‡</h2><blockquote><p>å‡½æ•°çš„åˆ›å»ºåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½¿ç”¨functionåŠ å‡½æ•°åè¿›è¡Œå£°æ˜ï¼Œå¦ä¸€ä¸­å°†å‡½æ•°èµ‹å€¼ç»™å˜é‡</p></blockquote><p>é¦–å…ˆçœ‹ç¬¬ä¸€ç§ï¼Œå£°æ˜æ–¹å¼å¦‚ä¸‹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">//[Function: a]</span></span><br><span class="line">    a=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p><p>è¿™è¾¹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€åæ‰“å°çš„å‡ºçš„ a æ˜¯ 1 è€Œä¸æ˜¯å‡½æ•°é‡Œèµ‹å€¼çš„10ï¼ŒåŸå› æ˜¯å‡½æ•°å…·æœ‰å˜é‡æå‡çš„ç‰¹æ€§ï¼Œä»¥ä¸Šä»£ç ç­‰ä»·äº<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123; &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">//[Function: a]</span></span><br><span class="line">    a=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p><p>å‡½æ•°å†…éƒ¨é¦–å…ˆå£°æ˜ function a æ­¤æ—¶å‡½æ•°å†…éƒ¨çš„ a ä¸ºfunctionç±»å‹ï¼Œæ­¤æ—¶æ‰“å° a å¯ä»¥çœ‹å‡ºæ˜¯ä¸€ä¸ªfunction æ¥ä¸‹æ¥ a = 10 å°† a çš„ç±»å‹è½¬ä¸º number å¹¶èµ‹å€¼ä¸º 10ï¼›ç„¶åreturn å‡½æ•°é”€æ¯ï¼Œå‡½æ•°å†…éƒ¨çš„ a å˜é‡è¢«å›æ”¶ã€‚æœ€åæ‰“å°çš„ a è¿˜æ˜¯å…¨å±€çš„ a</p><p>ä¸Šé¢æ˜¯ä½¿ç”¨ function è¿›è¡Œç”³æ˜çš„ï¼Œä¸‹é¢è¯•ä¸€ä¸‹ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„æ–¹å¼è¿›è¡Œå£°æ˜<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">//undefined</span></span><br><span class="line">    a=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p><p>è¿™è¾¹å¯ä»¥çœ‹åˆ°ç¬¬ 3 è¡Œæ‰“å°çš„æ˜¯ undefined è€Œä¸æ˜¯ functionï¼ŒåŒæ ·å…·æœ‰å˜é‡æå‡ä½†æ˜¯ä¸¤è€…å´ä¸ä¸€æ ·ï¼Œä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„æ–¹å¼è¿›è¡Œå£°æ˜å‡½æ•°åªä¼šå®šä¹‰å˜é‡ï¼Œå‡½æ•°ä½“å’Œå‡½æ•°å†…å®¹å¹¶ä¸ä¼šæºå¸¦ï¼Œä½†æ˜¯ä½¿ç”¨functionåŠ å‡½æ•°åçš„æ–¹å¼ä¼šå°†å‡½æ•°åå’Œå‡½æ•°ä½“ä¸€èµ·æå‡åˆ°å‡½æ•°çš„å¤´éƒ¨ã€‚<br>ä»¥ä¸Šä»£ç ç­‰ä»·äº<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">//undefined</span></span><br><span class="line">    a=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">    a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure></p><h2 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h2><p>js çš„ä½œç”¨åŸŸåˆ†ä¸ºå…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¯´èµ·ä½œç”¨åŸŸå°±å¾—è¯´åˆ°ä½œç”¨åŸŸé“¾ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> global=<span class="string">'global context'</span>;</span><br><span class="line"><span class="keyword">var</span> inner=<span class="string">'global inner context'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(global); </span><br><span class="line">    <span class="built_in">console</span>.log(inner);</span><br><span class="line">    <span class="keyword">var</span> inner=<span class="string">'inner context'</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(inner);</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br></pre></td></tr></table></figure></p><p>ç¬¬4è¡Œï¼šfoo å‡½æ•°å†…éƒ¨ï¼Œé¦–å…ˆæ‰“å°globalï¼Œç”±äºå‡½æ•°å†…éƒ¨æ²¡æœ‰è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆä¼šä»fooå‡½æ•°çš„å¤–éƒ¨ä½œç”¨åŸŸå¼€å§‹æ‰¾è¿™ä¸ªå˜é‡ï¼Œç„¶åæ‰“å°ã€‚<br>ç¬¬5è¡Œï¼šinnerè¿™ä¸ªå˜é‡ï¼Œç”±äºå˜é‡æå‡ï¼Œæ‰€æœ‰å‡½æ•°çš„å¤´éƒ¨å­˜åœ¨innerå˜é‡çš„å®šä¹‰ï¼Œæ‰“å°å‡ºundefined<br>ç¬¬7è¡Œï¼šinnerå˜é‡èµ‹å€¼ï¼Œæ‰“å°å‡º inner context</p><p>ä¸ä½œç”¨åŸŸæ¯æ¯ç›¸å…³çš„æ˜¯é—­åŒ…ï¼ŒthisæŒ‡å‘é—®é¢˜ã€‚</p><p>æ„Ÿè°¢åšä¸»çš„æ–‡ç« <br><a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023021187855808" target="_blank" rel="noopener">å»–é›ªå³°-å˜é‡ä½œç”¨åŸŸä¸è§£æ„èµ‹å€¼</a><br><a href="https://segmentfault.com/a/1190000000618597" target="_blank" rel="noopener">æ·±å…¥javascriptâ€”â€”ä½œç”¨åŸŸå’Œé—­åŒ…</a><br><a href="https://segmentfault.com/a/1190000013656524" target="_blank" rel="noopener">js å˜é‡æå‡å’Œé—­åŒ…ç†è§£</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>jså¿«æ’å°¾é€’å½’ä¼˜åŒ–</title>
      <link href="/2019/03/25/js%E5%BF%AB%E6%8E%92%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/"/>
      <url>/2019/03/25/js%E5%BF%AB%E6%8E%92%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>å°¾é€’å½’æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿è¿™è¾¹å°±ä¸ä»‹ç»äº†ã€‚æ€»ä¹‹é€’å½’æˆ‘æ˜¯ä¸€ç›´æ²¡æœ‰ææ˜ç™½ã€‚ä½†æ˜¯æˆ‘çŸ¥é“å°¾é€’å½’æ˜¯ä¸ºäº†è§£å†³é€’å½’é€ æˆçš„æ ˆæº¢å‡ºå’Œå¤§é‡é‡å¤çš„è®¡ç®—ã€‚</p><a id="more"></a><h2 id="å¸¸è§„ç‰ˆæœ¬"><a href="#å¸¸è§„ç‰ˆæœ¬" class="headerlink" title="å¸¸è§„ç‰ˆæœ¬"></a>å¸¸è§„ç‰ˆæœ¬</h2><pre><code>function quickSort(arr, left, right) {    // é€’å½’è·³å‡ºæ¡ä»¶    if (left &gt;= right)        return;    let i = left,        j = right,        flag = arr[left]; // å®šä¹‰çš„åŸºå‡†    while (i &lt; j) {        // æ‰¾åˆ°æ¯”flagå°çš„        while (i &lt; j &amp;&amp; arr[j] &gt;= flag)            j--;        // æ‰¾åˆ°æ¯”flagå¤§çš„        while (i &lt; j &amp;&amp; arr[i] &lt;= flag)            i++;        // äº¤æ¢iå’Œj        if (i &lt;= j) {            let temp = arr[i];            arr[i] = arr[j];            arr[j] = temp;        }    }    // äº¤æ¢åŸºå‡†å’Œi    arr[left] = arr[i];    arr[i] = flag;    // å¯¹å·¦è¾¹å¿«æ’    quickSort(arr, left, i - 1);    // å¯¹å³è¾¹å¿«æ’    quickSort(arr, i + 1, right);}let testArr = [2, 4, 1, 5, 8, 6, 7, 9, 0];quickSort(testArr, 0, testArr.length - 1);console.log(testArr);</code></pre><h2 id="å°¾é€’å½’ç‰ˆæœ¬"><a href="#å°¾é€’å½’ç‰ˆæœ¬" class="headerlink" title="å°¾é€’å½’ç‰ˆæœ¬"></a>å°¾é€’å½’ç‰ˆæœ¬</h2><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tailQuickSort</span><span class="params">(arr, left, right)</span> &#123;</span></span><br><span class="line">    let <span class="built_in">i</span> = left,</span><br><span class="line">        <span class="built_in">j</span> = right,</span><br><span class="line">        flag = arr[left];</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">i</span> &lt; <span class="built_in">j</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">i</span> &lt; <span class="built_in">j</span> &amp;&amp; arr[<span class="built_in">j</span>] &gt;= flag)</span><br><span class="line">            <span class="built_in">j</span>--;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">i</span> &lt; <span class="built_in">j</span> &amp;&amp; arr[<span class="built_in">i</span>] &lt;= flag)</span><br><span class="line">            <span class="built_in">i</span>++;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">i</span> &lt; <span class="built_in">j</span>) &#123;</span><br><span class="line">            let temp = arr[<span class="built_in">i</span>];</span><br><span class="line">            arr[<span class="built_in">i</span>] = arr[<span class="built_in">j</span>];</span><br><span class="line">            arr[<span class="built_in">j</span>] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    arr[left] = arr[<span class="built_in">i</span>];</span><br><span class="line">    arr[<span class="built_in">i</span>] = flag;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">i</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span><span class="params">(arr, left, right)</span> &#123;</span></span><br><span class="line">    let pivot = left;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        pivot = tailQuickSort(arr, left, right);</span><br><span class="line">        quickSort(arr, left, pivot - <span class="number">1</span>);</span><br><span class="line">        left = pivot + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let testArray = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">4</span>];</span><br><span class="line">quickSort(testArray, <span class="number">0</span>, testArray.<span class="built_in">length</span> - <span class="number">1</span>);</span><br><span class="line">console.<span class="built_in">log</span>(testArray);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>19å¹´å‰ç«¯æ ¡æ‹›é¢ç»</title>
      <link href="/2019/03/25/19%E5%B9%B4%E6%A0%A1%E6%8B%9B%E5%89%8D%E7%AB%AF%E9%9D%A2%E7%BB%8F%EF%BC%88%E9%98%BF%E9%87%8C-%E5%B0%8F%E7%B1%B3-%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8%EF%BC%89/"/>
      <url>/2019/03/25/19%E5%B9%B4%E6%A0%A1%E6%8B%9B%E5%89%8D%E7%AB%AF%E9%9D%A2%E7%BB%8F%EF%BC%88%E9%98%BF%E9%87%8C-%E5%B0%8F%E7%B1%B3-%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>åŠ ä¸ªå°å‰æï¼Œæœ¬äººæŠ•çš„æ˜¯webå‰ç«¯ï¼Œå¦‚æœåˆ†æ–¹å‘çš„è¯ï¼Œæ˜¯Reactæ–¹å‘ã€‚<br>ä¿—è¯è¯´ï¼Œé‡‘ä¸‰é“¶å››ï¼Œåœ¨è¿™å……æ»¡äº†åˆºæ¿€çš„ä¸‰æœˆï¼Œæˆ‘ä¹Ÿæ‹¿ç€æˆ‘çš„ä¸€é¡µçº¸çš„ç®€å†æŠ•äº†å¥½å‡ å®¶å…¬å¸ï¼Œä¸‹é¢è®°å½•ç€æˆ‘å‚åŠ äº†é¢è¯•çš„å‡ å®¶å…¬å¸ä»¥åŠè¿‘æœŸæ•´ç†å‡ºçš„é¢˜ç›®ã€‚å¾ˆå°´å°¬ï¼Œæ²¡æœ‰æ‹¿åˆ°ä»»ä½•ä¸€å®¶çš„offerï¼Œç»è¿‡è¿™å‡ æ¬¡çš„é¢è¯•ä¹Ÿå‘ç°è‡ªå·±çš„åŸºç¡€ç¡®å®å¾ˆå·®ï¼Œæ‰“ç®—æ­‡æ¯ä¸€é˜µå­å¥½å¥½è¡¥ä¸€è¡¥è‡ªå·±çš„åŸºç¡€ï¼Œå‡†å¤‡å¼€å§‹ç§‹æ‹›æˆ–è€…æ˜å¹´çš„æ˜¥æ‹›ï¼Œæ¯•ç«Ÿæˆ‘è¿˜æ˜¯å¾ˆå‘å¾€å¤§å…¬å¸çš„å¾…é‡çš„ã€‚ä¸è¿‡æˆ‘ä¹Ÿå‘ç°äº†ä¸€ç‚¹ï¼Œå¯èƒ½å­¦å†å¯¹äºç¨‹åºå‘˜æœ‰ç‚¹å½±å“ï¼Œä½†æ˜¯è¿˜æ˜¯æŠ€æœ¯æ¯”è¾ƒé‡è¦ï¼Œåªè¦ä½ å¤Ÿç‰›é€¼ï¼ŒBATè‚¯å®šä¼šå‘ä½ æ‰“å¼€å¤§é—¨ï¼Œå†ä¸æµä¹Ÿæ˜¯ç£¨ç»ƒå‡ å¹´èµ°ç¤¾æ‹›è¿›ã€‚ä½†æ˜¯ä¸ªäººè®¤ä¸ºå¯¹äºè€ƒç ”å’Œæ‰¾å·¥ä½œåŠ¨æ‘‡ä¸å®šçš„è¿˜æ˜¯å…ˆå°è¯•ä¸€ä¸‹è€ƒç ”å§ï¼Œæ¯•ç«Ÿå¯¹äºåƒæˆ‘è¿™æ ·çš„ä¸å‡ºåçš„å°äºŒæœ¬ç¯å¢ƒè¿˜æ˜¯ä¸å’‹åœ°ï¼Œ985/211å‡ºåä¸æ˜¯æ²¡æœ‰é“ç†çš„ã€‚</p><a id="more"></a><h2 id="é˜¿é‡Œå‰ç«¯æ ¡æ‹›â€“ç”µè¯é¢è¯•"><a href="#é˜¿é‡Œå‰ç«¯æ ¡æ‹›â€“ç”µè¯é¢è¯•" class="headerlink" title="é˜¿é‡Œå‰ç«¯æ ¡æ‹›â€“ç”µè¯é¢è¯•"></a>é˜¿é‡Œå‰ç«¯æ ¡æ‹›â€“ç”µè¯é¢è¯•</h2><p>å°ç”Ÿä¸æ‰ï¼Œç¬¬ä¸€è½®çš„ç”µè¯åˆè¯•å°±è¢«åˆ·æ‰äº†ï¼Œæ‰€ä»¥ä¸æ¸…æ¥šé˜¿é‡Œçš„æ ¡æ‹›è¿™ä¸ªæµç¨‹ï¼Œæˆ‘ä¹Ÿåªèƒ½æä¾›ç”µè¯åˆè¯•çš„æƒ…å†µäº†ï¼Œé‚£å¤©é˜³å…‰æ˜åªšï¼Œä¸­åˆåˆšä¸‹è¯¾æ¥åˆ°ä¸€ä¸ªç”µè¯ï¼Œä¸€çœ‹å½’å±åœ°æµ™æ±Ÿæ­å·å·²ç»å¼€å§‹æ¢¦æƒ³è¿›å…¥é˜¿é‡Œçš„åœºæ™¯äº†ï¼Œæœä¸å…¶ç„¶ï¼Œçº¦äº†ç¬¬äºŒå¤©æ™šä¸Šå…«ç‚¹çš„ç”µè¯åˆå§‹ï¼Œåˆåœ¨æƒ…ç†ä¹‹ä¸­çš„è¢«åˆ·æ‰äº†ï¼Œå†ç»ä¸€ä¸ªå°æ—¶ï¼Œæ„Ÿè§‰å°±æ˜¯è¿™ä¸ªé¢è¯•å®˜æ˜¯çœŸç‰›é€¼å•Šï¼Œæˆ‘æ˜¯åœ¨ä¸€ä¸ªå°æ—¶ä¹‹å†…è‚šå­é‡Œçš„å­˜è´§è¢«æçš„å¹²å¹²å‡€å‡€çš„ã€‚</p><h3 id="1-è¯·æ±‚è·¨åŸŸé—®é¢˜"><a href="#1-è¯·æ±‚è·¨åŸŸé—®é¢˜" class="headerlink" title="1. è¯·æ±‚è·¨åŸŸé—®é¢˜"></a>1. è¯·æ±‚è·¨åŸŸé—®é¢˜</h3><p>è¿™æ˜¯å‰ç«¯é¢è¯•å¿…é—®é¢˜å‹ï¼Œæˆ‘å°±å†™å‡ ä¸ªä¸ä¸€å®šå¯¹ï¼Œå› ä¸ºæˆ‘ä¹Ÿæ˜¯æœçš„æˆ‘ä¹Ÿæ²¡ç»å†è¿‡è·¨åŸŸã€‚</p><ol><li>jsonpå½¢å¼ï¼Œç¼ºç‚¹æ˜¯åªèƒ½å®ç°getè¯·æ±‚ï¼Œå¹¶ä¸”å¯¹äºå‡ºç°çš„errorä¸å®¹æ˜“è°ƒè¯•</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span></span><br><span class="line"><span class="actionscript">    script.type = <span class="string">'text/javascript'</span>;</span></span><br><span class="line"><span class="actionscript">    script.src = <span class="string">'http://domain2.com:8080/login?user=admin&amp;callback=onBack'</span>;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.head.appendChild(script);</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// å›è°ƒæ‰§è¡Œå‡½æ•°</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">onBack</span><span class="params">(res)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(res);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>document.domain  æ”¹å˜ä¸¤ä¸ªåŸŸçš„document.domain</li><li>window.name</li><li>postMessage</li><li>CORS è·¨åŸŸèµ„æºå…±äº«</li><li>nginxåå‘ä»£ç†</li><li>websocketåè®®è·¨åŸŸ</li></ol><h3 id="2-webpackæ’ä»¶ã€ä¼˜åŒ–ã€loader"><a href="#2-webpackæ’ä»¶ã€ä¼˜åŒ–ã€loader" class="headerlink" title="2. webpackæ’ä»¶ã€ä¼˜åŒ–ã€loader"></a>2. webpackæ’ä»¶ã€ä¼˜åŒ–ã€loader</h3><h3 id="3-é¡µé¢æ€§èƒ½ä¼˜åŒ–"><a href="#3-é¡µé¢æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="3. é¡µé¢æ€§èƒ½ä¼˜åŒ–"></a>3. é¡µé¢æ€§èƒ½ä¼˜åŒ–</h3><ol><li>å‡å°‘httpè¯·æ±‚</li><li>ä½¿ç”¨CDN</li><li>æ·»åŠ Expireså¤´ï¼Œç¬¬ä¸€æ¬¡è®¿é—®æ˜¯ç¼“å­˜ç»„ä»¶ï¼Œå‡å°‘ä¸å¿…è¦çš„httpè¯·æ±‚</li><li>å¼€å¯å‹ç¼©gzipå¯ä»¥å‡å°‘åˆ°30%</li><li>æ ·å¼è¡¨æ”¾åœ¨headè¡¨ï¼Œè„šæœ¬æ”¾æœ€ä¸‹é¢</li><li>é…ç½®ETAG</li><li>â€¦.</li></ol><h3 id="4-åŸå‹é“¾ç›¸å…³"><a href="#4-åŸå‹é“¾ç›¸å…³" class="headerlink" title="4. åŸå‹é“¾ç›¸å…³"></a>4. åŸå‹é“¾ç›¸å…³</h3><h3 id="5-ES6çš„æ–°ç‰¹æ€§äº†è§£å¤šå°‘"><a href="#5-ES6çš„æ–°ç‰¹æ€§äº†è§£å¤šå°‘" class="headerlink" title="5. ES6çš„æ–°ç‰¹æ€§äº†è§£å¤šå°‘"></a>5. ES6çš„æ–°ç‰¹æ€§äº†è§£å¤šå°‘</h3><h3 id="6-ES6å’Œcommonjsçš„åŒºåˆ«"><a href="#6-ES6å’Œcommonjsçš„åŒºåˆ«" class="headerlink" title="6. ES6å’Œcommonjsçš„åŒºåˆ«"></a>6. ES6å’Œcommonjsçš„åŒºåˆ«</h3><ol><li>es6å¯¼å‡ºçš„æ˜¯å€¼å¾—å¼•ç”¨ï¼Œå€¼çš„æ”¹å˜å¼•ç”¨ä¹Ÿæ”¹å˜ï¼Œcommonjsè¾“å‡ºçš„æ˜¯å€¼çš„æ‹·è´ï¼Œå€¼æ”¹å˜ä¸ä¼šå½±å“å·²ç»å¯¼å‡ºçš„å˜é‡</li><li>es6ä¸­thisæŒ‡å‘undefinedï¼ŒcommonjsæŒ‡å‘å½“å‰æ¨¡å—</li><li>es6æ˜¯åœ¨è§£ææ˜¯åŠ è½½æ¨¡å—ï¼Œcommonjsæ˜¯è¿è¡Œæ—¶åŠ è½½</li><li>es6å¯ä»¥å•ç‹¬åŠ è½½æŸä¸ªå‡½æ•°ï¼Œcommonjsåªèƒ½åŠ è½½æ•´ä¸ªæ¨¡å—</li><li>es6åŠ è½½çš„ä¸æ˜¯å¯¹è±¡ï¼ŒcommonjsåŠ è½½çš„æ˜¯ä¸€ä¸ªå¯¹è±¡</li></ol><h3 id="7-reactç”Ÿå‘½å‘¨æœŸ"><a href="#7-reactç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="7. reactç”Ÿå‘½å‘¨æœŸ"></a>7. reactç”Ÿå‘½å‘¨æœŸ</h3><p><img src="http://static.zybuluo.com/shenweizheng/0lh7kggg8topfqk2grc9717w/TIM%E6%88%AA%E5%9B%BE20190325164720.png" alt="TIMæˆªå›¾20190325164720.png-258.9kB"></p><h3 id="8-reactä¼˜åŒ–"><a href="#8-reactä¼˜åŒ–" class="headerlink" title="8. reactä¼˜åŒ–"></a>8. reactä¼˜åŒ–</h3><ol><li>shouldComponentUpdateè¿™è¾¹åšæ“ä½œï¼Œåˆ¤æ–­æ˜¯å¦è¿›è¡Œrender</li><li>å°½é‡ä¸é€‚åº”ç»„ä»¶stateä½¿ç”¨mobxæˆ–è€…å…¶ä»–ä»£æ›¿</li><li>ã€‚ã€‚ã€‚</li></ol><h3 id="9-ä¸ºä»€ä¹ˆä½¿ç”¨mobxè€Œä¸æ˜¯ä½¿ç”¨åŸç”Ÿçš„setState"><a href="#9-ä¸ºä»€ä¹ˆä½¿ç”¨mobxè€Œä¸æ˜¯ä½¿ç”¨åŸç”Ÿçš„setState" class="headerlink" title="9. ä¸ºä»€ä¹ˆä½¿ç”¨mobxè€Œä¸æ˜¯ä½¿ç”¨åŸç”Ÿçš„setState"></a>9. ä¸ºä»€ä¹ˆä½¿ç”¨mobxè€Œä¸æ˜¯ä½¿ç”¨åŸç”Ÿçš„setState</h3><ol><li>setStateæ˜¯å¼‚æ­¥çš„ï¼Œæ¸²æŸ“æ—¶å¯èƒ½ä¼šå‡ºç°é”™è¯¯</li><li>setStateä¼šé€ æˆä¸å¿…è¦çš„æ¸²æŸ“ï¼Œmobxå¯ä»¥ä¸æŠŠå˜é‡è®¾ç½®ä¸ºå¯è§‚å¯Ÿå˜é‡</li><li>setStateä¸å¯èƒ½ç®¡ç†æ‰€æœ‰çš„çŠ¶æ€ï¼Œçˆ¶å­ç»„ä»¶å¾ˆå¤šçš„æ—¶å€™ä¼šå¾ˆä¹±</li><li>ä½¿å¾—jsxçš„èŒè´£å˜å¾—æ›´å•ä¸€</li></ol><h3 id="10-setStateæ˜¯æ‰¹å¤„ç†å—"><a href="#10-setStateæ˜¯æ‰¹å¤„ç†å—" class="headerlink" title="10. setStateæ˜¯æ‰¹å¤„ç†å—"></a>10. setStateæ˜¯æ‰¹å¤„ç†å—</h3><p>æ˜¯æ‰¹å¤„ç†ï¼Œå¦‚æœrenderé‡Œé¢æœ‰å¤šä¸ªsetStateæ—¶ä¼šä¸€èµ·è¿›è¡ŒsetState</p><h3 id="11-è¯´ä¸€è¯´flexå¸ƒå±€"><a href="#11-è¯´ä¸€è¯´flexå¸ƒå±€" class="headerlink" title="11. è¯´ä¸€è¯´flexå¸ƒå±€"></a>11. è¯´ä¸€è¯´flexå¸ƒå±€</h3><h3 id="12-è¯´ä¸€è¯´å†’æ³¡æœºåˆ¶"><a href="#12-è¯´ä¸€è¯´å†’æ³¡æœºåˆ¶" class="headerlink" title="12. è¯´ä¸€è¯´å†’æ³¡æœºåˆ¶"></a>12. è¯´ä¸€è¯´å†’æ³¡æœºåˆ¶</h3><p>ä»ä¸Šåˆ°ä¸‹æ•è·åˆ°å†’æ³¡ï¼Œä»ä¸‹å¾€ä¸Šå†’æ³¡<br>æœ€ä¸Šé¢æ˜¯window</p><h3 id="13-æµè§ˆå™¨å·²ç»å®šä¹‰å¥½çš„å¯¹è±¡æœ‰å“ªäº›"><a href="#13-æµè§ˆå™¨å·²ç»å®šä¹‰å¥½çš„å¯¹è±¡æœ‰å“ªäº›" class="headerlink" title="13. æµè§ˆå™¨å·²ç»å®šä¹‰å¥½çš„å¯¹è±¡æœ‰å“ªäº›"></a>13. æµè§ˆå™¨å·²ç»å®šä¹‰å¥½çš„å¯¹è±¡æœ‰å“ªäº›</h3><p>window,screen,location,history,navigator</p><h3 id="14-æ•°ç»„å»é‡-è¯´ä¸€è¯´å¤æ‚åº¦"><a href="#14-æ•°ç»„å»é‡-è¯´ä¸€è¯´å¤æ‚åº¦" class="headerlink" title="14. æ•°ç»„å»é‡,è¯´ä¸€è¯´å¤æ‚åº¦"></a>14. æ•°ç»„å»é‡,è¯´ä¸€è¯´å¤æ‚åº¦</h3><h3 id="15-è¯´ä¸€è¯´websocket"><a href="#15-è¯´ä¸€è¯´websocket" class="headerlink" title="15. è¯´ä¸€è¯´websocket"></a>15. è¯´ä¸€è¯´websocket</h3><h3 id="16-æ­£åˆ™è¡¨è¾¾å¼"><a href="#16-æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="16. æ­£åˆ™è¡¨è¾¾å¼"></a>16. æ­£åˆ™è¡¨è¾¾å¼</h3><h3 id="17-httpå’Œhttpsçš„åŒºåˆ«"><a href="#17-httpå’Œhttpsçš„åŒºåˆ«" class="headerlink" title="17. httpå’Œhttpsçš„åŒºåˆ«"></a>17. httpå’Œhttpsçš„åŒºåˆ«</h3><ol><li>httpæ˜¯æ˜æ–‡ä¼ è¾“ï¼Œhttpsæ˜¯ä½¿ç”¨å®‰å…¨å¥—æ¥å­—åŠ å¯†çš„</li><li>httpçš„ç«¯å£æ˜¯80 httpsçš„ç«¯å£æ˜¯443</li><li>httpséœ€è¦åˆ°caç”³è¯·è¯ä¹¦ï¼Œéœ€è¦ä¸€å®šçš„è´¹ç”¨</li><li>httpçš„é“¾æ¥å¾ˆç®€å•æ²¡æœ‰çŠ¶æ€ï¼Œhttpsçš„åè®®æ˜¯ç”±SSL+httpåè®®æ„å»ºçš„åŠ å¯†ä¼ è¾“ï¼Œèº«ä»½è®¤è¯çš„ç½‘ç»œåè®®å¾ˆå®‰å…¨</li></ol><h3 id="18-httpè¯·æ±‚å¸¸ç”¨çš„çŠ¶æ€ç "><a href="#18-httpè¯·æ±‚å¸¸ç”¨çš„çŠ¶æ€ç " class="headerlink" title="18. httpè¯·æ±‚å¸¸ç”¨çš„çŠ¶æ€ç "></a>18. httpè¯·æ±‚å¸¸ç”¨çš„çŠ¶æ€ç </h3><ol><li>200 è¯·æ±‚æˆåŠŸ</li><li>404 è¯·æ±‚ä¸å­˜åœ¨</li><li>405 è¯·æ±‚æ–¹å¼é”™è¯¯</li><li>403 æœåŠ¡å™¨æ¥å—äº†è¯·æ±‚ä½†æ˜¯æ‹’ç»å“åº”</li><li>303 è¯·æ±‚éœ€è¦å­˜åœ¨å¦ä¸€ä¸ªurlï¼Œè¯·ä½¿ç”¨getè¯·æ±‚å®šå‘è·å–è¯·æ±‚çš„èµ„æº</li><li>500 æœåŠ¡å™¨å‘ç”Ÿäº†ä¸€åœºå¼‚å¸¸</li></ol><h3 id="19-è¯´ä¸€è¯´css3åŠ¨ç”»"><a href="#19-è¯´ä¸€è¯´css3åŠ¨ç”»" class="headerlink" title="19. è¯´ä¸€è¯´css3åŠ¨ç”»"></a>19. è¯´ä¸€è¯´css3åŠ¨ç”»</h3><h3 id="20-canvasç”»å¸ƒ"><a href="#20-canvasç”»å¸ƒ" class="headerlink" title="20. canvasç”»å¸ƒ"></a>20. canvasç”»å¸ƒ</h3><h3 id="21-httpå±äºå“ªä¸€å±‚"><a href="#21-httpå±äºå“ªä¸€å±‚" class="headerlink" title="21. httpå±äºå“ªä¸€å±‚"></a>21. httpå±äºå“ªä¸€å±‚</h3><p>åº”ç”¨å±‚</p><h3 id="22-tcpå’Œudpçš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯"><a href="#22-tcpå’Œudpçš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="22. tcpå’Œudpçš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯"></a>22. tcpå’Œudpçš„åŒºåˆ«ä»¥åŠä½¿ç”¨åœºæ™¯</h3><ol><li>tcpé¢å‘è¿æ¥çš„å¯é ä¼ è¾“ï¼Œudpé¢å‘æ— è¿æ¥ä¸å¯é </li><li>tcpé¢å‘å­—èŠ‚æµï¼Œudpé¢å‘æŠ¥æ–‡</li><li>tcpæ˜¯ä¸€å¯¹ä¸€çš„é€šä¿¡ï¼Œudpå¯ä»¥ä¸€å¯¹ä¸€ä¹Ÿå¯ä»¥ä¸€å¯¹å¤šä¹Ÿå¯ä»¥å¤šå¯¹å¤šé€šä¿¡</li><li>tcpçš„å»ºç«‹éœ€è¦ç»å†ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</li><li>tcpé€‚ç”¨äºæ–‡ä»¶ä¼ è¾“ï¼Œå‘é€é‚®ä»¶</li><li>udpé€‚ç”¨äºå³æ—¶é€šä¿¡ï¼Œåœ¨çº¿è§†é¢‘</li></ol><h3 id="23-è®²ä¸€è®²è®¡ç®—æœºç½‘ç»œçš„ä¸ƒå±‚æ¨¡å‹"><a href="#23-è®²ä¸€è®²è®¡ç®—æœºç½‘ç»œçš„ä¸ƒå±‚æ¨¡å‹" class="headerlink" title="23. è®²ä¸€è®²è®¡ç®—æœºç½‘ç»œçš„ä¸ƒå±‚æ¨¡å‹"></a>23. è®²ä¸€è®²è®¡ç®—æœºç½‘ç»œçš„ä¸ƒå±‚æ¨¡å‹</h3><p>ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚ã€åº”ç”¨å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚</p><h3 id="24-è®²ä¸€è®²é—­åŒ…"><a href="#24-è®²ä¸€è®²é—­åŒ…" class="headerlink" title="24. è®²ä¸€è®²é—­åŒ…"></a>24. è®²ä¸€è®²é—­åŒ…</h3><p>å‡½æ•°å†…éƒ¨å¯ä»¥è¯»å–å‡½æ•°å¤–éƒ¨çš„å˜é‡ï¼Œç›´ç™½çš„è¯´å°±æ˜¯å‡½æ•°åŒ…å‡½æ•°<br>å¯ä»¥ä¿å­˜å±€éƒ¨å˜é‡å¹¶ä¸”ä¸ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒï¼Œç¼ºç‚¹æ˜¯ä¼šåŠ å¤§å†…å­˜çš„è´Ÿæ‹…</p><h3 id="25-ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«"><a href="#25-ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«" class="headerlink" title="25. ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«"></a>25. ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«</h3><ol><li>thisä½œç”¨åŸŸçš„åŒºåˆ«ï¼Œç®­å¤´å‡½æ•°æ˜¯å‡½æ•°è‡ªèº«ï¼Œæ™®é€šå‡½æ•°æ˜¯å‡½æ•°æ‰€åœ¨çš„ä¸Šä¸‹æ–‡</li><li>å‡½æ•°ä½œç”¨äºæå‡çš„åŒºåˆ«ï¼Œç®­å¤´å‡½æ•°éœ€è¦å°†å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªvarå˜é‡æ‰èƒ½æå‡ä»–çš„ä½œç”¨åŸŸ</li><li>æ„é€ å‡½æ•°çš„é—®é¢˜ï¼Œç®­å¤´å‡½æ•°æ˜¯åŒ¿åå‡½æ•°ä¸å¯ä»¥ä½œä¸ºæ„é€ å‡½æ•°ä¸å¯ä»¥new</li></ol><h3 id="26-å¦‚ä½•æå‡å‡½æ•°çš„ä½œä½œç”¨åŸŸ"><a href="#26-å¦‚ä½•æå‡å‡½æ•°çš„ä½œä½œç”¨åŸŸ" class="headerlink" title="26. å¦‚ä½•æå‡å‡½æ•°çš„ä½œä½œç”¨åŸŸ"></a>26. å¦‚ä½•æå‡å‡½æ•°çš„ä½œä½œç”¨åŸŸ</h3><p>callï¼Œapplyï¼Œbind</p><h3 id="27-callå’Œapplyçš„åŒºåˆ«"><a href="#27-callå’Œapplyçš„åŒºåˆ«" class="headerlink" title="27. callå’Œapplyçš„åŒºåˆ«"></a>27. callå’Œapplyçš„åŒºåˆ«</h3><p>ç¬¬äºŒä¸ªå‚æ•°çš„åŒºåˆ«ï¼Œapplyçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œcallæ˜¯ä¸€ä¸ªä¸€ä¸ªå‚æ•°çš„å¾€ååŠ </p><h3 id="28-es5çš„ç»§æ‰¿æ˜¯å¦‚ä½•å®ç°çš„"><a href="#28-es5çš„ç»§æ‰¿æ˜¯å¦‚ä½•å®ç°çš„" class="headerlink" title="28. es5çš„ç»§æ‰¿æ˜¯å¦‚ä½•å®ç°çš„"></a>28. es5çš„ç»§æ‰¿æ˜¯å¦‚ä½•å®ç°çš„</h3><p>åˆ©ç”¨prototypeå®ç°</p><pre><code>function Dog{    this.name = &apos;dog&apos;;};function Animal{    this.speak = function(){        console.log(&apos;äºŒå“ˆ&apos;);    }};Dog.prototype = new Animal();dog = new Dog();dog.speak();</code></pre><h3 id="29-XSSæ”»å‡»"><a href="#29-XSSæ”»å‡»" class="headerlink" title="29. XSSæ”»å‡»"></a>29. XSSæ”»å‡»</h3><ol><li>XSSæ”»å‡»åˆ†ä¸ºåå°„å‹ï¼Œå­˜å‚¨å‹ï¼ŒDOMå‹</li><li>åå°„å‹XSSæ˜¯åœ¨å°†XSSä»£ç æ”¾åœ¨URLä¸­ï¼Œå°†å‚æ•°æäº¤åˆ°æœåŠ¡å™¨ã€‚æœåŠ¡å™¨è§£æåå“åº”ï¼Œåœ¨å“åº”ç»“æœä¸­å­˜åœ¨XSSä»£ç ï¼Œæœ€ç»ˆé€šè¿‡æµè§ˆå™¨è§£ææ‰§è¡Œ</li><li>å­˜å‚¨å‹XSSæ˜¯å°†XSSä»£ç å­˜å‚¨åˆ°æœåŠ¡ç«¯ï¼ˆæ•°æ®åº“ã€å†…å­˜ã€æ–‡ä»¶ç³»ç»Ÿç­‰ï¼‰ï¼Œåœ¨ä¸‹æ¬¡è¯·æ±‚åŒä¸€ä¸ªé¡µé¢æ—¶å°±ä¸éœ€è¦å¸¦ä¸ŠXSSä»£ç äº†ï¼Œè€Œæ˜¯ä»æœåŠ¡å™¨è¯»å–</li><li>DOM XSSçš„å‘ç”Ÿä¸»è¦æ˜¯åœ¨JSä¸­ä½¿ç”¨evalé€ æˆçš„ï¼Œæ‰€ä»¥åº”å½“é¿å…ä½¿ç”¨evalè¯­å¥</li><li>XSSå±å®³æœ‰ç›—å–ç”¨æˆ·cookieï¼Œé€šè¿‡JSæˆ–CSSæ”¹å˜æ ·å¼ï¼ŒDomé€ æˆæ­£å¸¸ç”¨æˆ·æ— æ³•å¾—åˆ°æœåŠ¡å™¨å“åº”<br>é¢„é˜²ï¼š</li><li>å¯¹cookieè¿›è¡Œä¿æŠ¤ å¯¹cookieè®¾ç½®httpOnly</li><li>å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œç¼–ç ã€è§£ç ã€è¿‡æ»¤</li></ol><h3 id="30-jsxä¸ºä»€ä¹ˆå«jsx-ç±»åä¸ºä»€ä¹ˆå¤§å†™"><a href="#30-jsxä¸ºä»€ä¹ˆå«jsx-ç±»åä¸ºä»€ä¹ˆå¤§å†™" class="headerlink" title="30. jsxä¸ºä»€ä¹ˆå«jsx ç±»åä¸ºä»€ä¹ˆå¤§å†™"></a>30. jsxä¸ºä»€ä¹ˆå«jsx ç±»åä¸ºä»€ä¹ˆå¤§å†™</h3><p>jsxä¹Ÿå«javascript XML</p><h3 id="31-å¦‚ä½•è·å–åˆ°domé‡Œé¢çš„æŸä¸ªèŠ‚ç‚¹"><a href="#31-å¦‚ä½•è·å–åˆ°domé‡Œé¢çš„æŸä¸ªèŠ‚ç‚¹" class="headerlink" title="31. å¦‚ä½•è·å–åˆ°domé‡Œé¢çš„æŸä¸ªèŠ‚ç‚¹"></a>31. å¦‚ä½•è·å–åˆ°domé‡Œé¢çš„æŸä¸ªèŠ‚ç‚¹</h3><p>å„ç§domæ“ä½œï¼ŒquerySelectorç­‰</p><h3 id="32-absoluteæ˜¯å¯¹å“ªä¸ªç‚¹å¼€å§‹è®¡ç®—çš„"><a href="#32-absoluteæ˜¯å¯¹å“ªä¸ªç‚¹å¼€å§‹è®¡ç®—çš„" class="headerlink" title="32. absoluteæ˜¯å¯¹å“ªä¸ªç‚¹å¼€å§‹è®¡ç®—çš„"></a>32. absoluteæ˜¯å¯¹å“ªä¸ªç‚¹å¼€å§‹è®¡ç®—çš„</h3><ol><li>å¤–å±‚æœ‰relativeå®šä¹‰æ—¶ç›¸å¯¹äºrelativeå®šä½</li><li>å¤–å±‚æ²¡æœ‰æ—¶æ ¹æ®bodyå®šä½</li></ol><h3 id="33-åŸç”Ÿjså‘é€è¯·æ±‚"><a href="#33-åŸç”Ÿjså‘é€è¯·æ±‚" class="headerlink" title="33. åŸç”Ÿjså‘é€è¯·æ±‚"></a>33. åŸç”Ÿjså‘é€è¯·æ±‚</h3><pre><code>// å®šä¹‰ä¸€ä¸ªXMLHttpRequestå˜é‡var xhr = new XMLHttpRequest();// è¦å‘é€çš„è¯·æ±‚urlxhr.open(&apos;post&apos;,&apos;/api/login&apos;);// å¯¹äºpostè¯·æ±‚è¦è®¾ç½®è¯·æ±‚å¤´xhr.setRequestHeader(&apos;Content-type&apos;,&apos;application/x-www-form-urlencoded&apos;);// å‘é€è¯·æ±‚xhr.send(&apos;account=admin&amp;password=123456);// ç›‘å¬çŠ¶æ€æ”¹å˜xhr.onreadystatechange = function(){    if(xhr.readyState === 4 &amp;&amp; xhr.status === 200){        console.log(&apos;success&apos;);    }}</code></pre><h2 id="å°ç±³ç”µè¯é¢è¯•"><a href="#å°ç±³ç”µè¯é¢è¯•" class="headerlink" title="å°ç±³ç”µè¯é¢è¯•"></a>å°ç±³ç”µè¯é¢è¯•</h2><h3 id="1-csså¸¸ç”¨é€‰æ‹©å™¨æŒ‰ç…§ä¼˜å…ˆçº§è¯´"><a href="#1-csså¸¸ç”¨é€‰æ‹©å™¨æŒ‰ç…§ä¼˜å…ˆçº§è¯´" class="headerlink" title="1. csså¸¸ç”¨é€‰æ‹©å™¨æŒ‰ç…§ä¼˜å…ˆçº§è¯´"></a>1. csså¸¸ç”¨é€‰æ‹©å™¨æŒ‰ç…§ä¼˜å…ˆçº§è¯´</h3><h3 id="2-csså¸¸ç”¨æ°´å¹³å±…ä¸­"><a href="#2-csså¸¸ç”¨æ°´å¹³å±…ä¸­" class="headerlink" title="2. csså¸¸ç”¨æ°´å¹³å±…ä¸­"></a>2. csså¸¸ç”¨æ°´å¹³å±…ä¸­</h3><h3 id="3-csså‚ç›´å±…ä¸­"><a href="#3-csså‚ç›´å±…ä¸­" class="headerlink" title="3. csså‚ç›´å±…ä¸­"></a>3. csså‚ç›´å±…ä¸­</h3><h3 id="4-csså®ç°å›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾"><a href="#4-csså®ç°å›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾" class="headerlink" title="4. csså®ç°å›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾"></a>4. csså®ç°å›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾</h3><h3 id="5-è®²ä¸€è®²flexå¸ƒå±€"><a href="#5-è®²ä¸€è®²flexå¸ƒå±€" class="headerlink" title="5. è®²ä¸€è®²flexå¸ƒå±€"></a>5. è®²ä¸€è®²flexå¸ƒå±€</h3><h3 id="6-cssè¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„åŒºåˆ«"><a href="#6-cssè¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„åŒºåˆ«" class="headerlink" title="6. cssè¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„åŒºåˆ«"></a>6. cssè¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„åŒºåˆ«</h3><h3 id="7-è®²ä¸€è®²åŸå‹é“¾"><a href="#7-è®²ä¸€è®²åŸå‹é“¾" class="headerlink" title="7. è®²ä¸€è®²åŸå‹é“¾"></a>7. è®²ä¸€è®²åŸå‹é“¾</h3><h3 id="8-ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«"><a href="#8-ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«" class="headerlink" title="8. ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«"></a>8. ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«</h3><h3 id="9-webpackçš„æ’ä»¶éƒ½ç”¨è¿‡å“ªäº›ï¼Œéƒ½æ˜¯å¹²å˜›ç”¨çš„"><a href="#9-webpackçš„æ’ä»¶éƒ½ç”¨è¿‡å“ªäº›ï¼Œéƒ½æ˜¯å¹²å˜›ç”¨çš„" class="headerlink" title="9. webpackçš„æ’ä»¶éƒ½ç”¨è¿‡å“ªäº›ï¼Œéƒ½æ˜¯å¹²å˜›ç”¨çš„"></a>9. webpackçš„æ’ä»¶éƒ½ç”¨è¿‡å“ªäº›ï¼Œéƒ½æ˜¯å¹²å˜›ç”¨çš„</h3><h2 id="å­—èŠ‚è·³åŠ¨"><a href="#å­—èŠ‚è·³åŠ¨" class="headerlink" title="å­—èŠ‚è·³åŠ¨"></a>å­—èŠ‚è·³åŠ¨</h2><p>å­—èŠ‚è·³åŠ¨å¯¹ç®—æ³•æ˜¯æœ‰ç‚¹è¦æ±‚çš„å…¬å¸ï¼Œæ‰€ä»¥å¾ˆä¸å¹¸çš„åœ¨æœ€åä¸€è½®é¢è¯•è¢«åˆ·äº†ï¼Œæƒ³è¦æŠ•å­—èŠ‚è·³åŠ¨çš„åŒå­¦ä»‹æ„å¤šåˆ·ä¸€åˆ·ç‰›å®¢ç½‘ä¸Šçš„ç®—æ³•é¢˜ã€‚å„ç§æ’åºï¼ŒæŸ¥æ‰¾ï¼Œé€’å½’ã€‚å¾ˆä¸å¹¸æˆ‘å°±æ˜¯ä¸ä¼šé€’å½’æœ€åä¸€è½®æ‰è¢«åˆ·äº†ã€‚</p><h3 id="ç¬”è¯•"><a href="#ç¬”è¯•" class="headerlink" title="ç¬”è¯•"></a>ç¬”è¯•</h3><p>æˆ‘çš„ç¬”è¯•æ˜¯ä¸¤ä¸ªå°æ—¶ç›´æ¥å››é“ç®—æ³•é¢˜ï¼Œå‰ä¸¤é“è¿˜æ˜¯å¾ˆç®€å•çš„ï¼ŒåŸºæœ¬çš„å¾ªç¯å°±éƒ½å¯ä»¥è§£å‡ºæ¥æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œåä¸¤é¢˜æ˜¯æœ‰ç‚¹æ„æ€äº†ï¼Œæˆ‘æ˜¯èŠ±äº†ä¸€ä¸ªå¤šå°æ—¶æ²¡å†™çš„å‡ºæ¥ã€‚åä¸¤é“åº”è¯¥æ˜¯ç”¨åŠ¨æ€è§„åˆ’å°±åšå‡ºæ¥äº†ã€‚<br>æˆ‘æ˜¯ä¸¤é¢˜æ»¡åˆ†ä¸¤é¢˜é›¶åˆ†æ‹¿åˆ°äº†é¢è¯•çš„æœºä¼šï¼Œæˆ‘æœ¬äººä¹Ÿæ˜¯ä¸æ•¢ç›¸ä¿¡çš„ã€‚è²Œä¼¼æ˜¯ä½œå¯¹ä¸¤é¢˜å°±å¯ä»¥æ‹¿åˆ°é¢è¯•æœºä¼šã€‚<br>æ¥ä¸‹æ¥æ˜¯è§†é¢‘é¢è¯•ï¼Œæœ€å¤šä¸‰è½®ï¼Œè¿‡äº†ä¸€è½®ä¼šå‘çŸ­ä¿¡å‘Šè¯‰ä½ è¿™ä¸€è½®æœ‰æ²¡æœ‰è¿‡ï¼Œä¸­é—´å¯ä»¥ä¼‘æ¯åŠä¸ªå°æ—¶å·¦å³ã€‚ä¸‰è½®éƒ½æ˜¯æŠ€æœ¯é¢ã€‚ä¸ªäººæ„Ÿè§‰å‰ä¸¤é¢è™½ç„¶æœ‰çš„æ²¡ç­”å¾—å‡ºæ¥ä½†æ˜¯é¢è¯•å®˜äººè¿˜æ˜¯å¾ˆå¥½çš„éƒ½ç»™è¿‡äº†ã€‚</p><h3 id="è§†é¢‘ä¸€é¢"><a href="#è§†é¢‘ä¸€é¢" class="headerlink" title="è§†é¢‘ä¸€é¢"></a>è§†é¢‘ä¸€é¢</h3><p>ä¸€é¢æ˜¯ä¸€ä¸ªå°å§å§ï¼Œä½†æ˜¯è¿™ä¸ªå°å§å§å°½ç„¶æ¯”æˆ‘è¿˜è¦ç´§å¼ ã€‚ç¬é—´å°±æå¾—æˆ‘æ›´ç´§å¼ äº†ã€‚äº’é“ä½ å¥½ä¹‹åï¼Œå¼€å§‹èŠèŠä¹‹å‰åšè¿‡çš„é¡¹ç›®ï¼Œéƒ½ç”¨äº†å“ªäº›æŠ€æœ¯æ ˆï¼Œä¸ºä»€ä¹ˆé€‰è¿™ç§æŠ€æœ¯æ ˆã€‚ä¸€é¢å…¨ç¨‹åŠä¸ªå°æ—¶ã€‚</p><ol><li>ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«</li><li>mobxå’Œreduxçš„åŒºåˆ«ï¼Œä¸ºä»€ä¹ˆé€‰ç”¨mobx</li><li>å•å‘æ•°æ®æµå’ŒåŒå‘ç»‘å®šçš„ç†è§£</li><li>æµè§ˆå™¨ä»è¾“å…¥ç½‘å€åˆ°é¡µé¢æ¸²æŸ“å®Œæˆä¸­é—´éƒ½å‘ç”Ÿäº†ä»€ä¹ˆ</li><li>æ­£åˆ™è¡¨è¾¾å¼</li><li>webpackéƒ½ç”¨è¿‡å“ªäº›æ’ä»¶</li><li>äº†è§£promiseå§ï¼Œç”¨è¿‡promise.allå§ ï¼Œæ¥ï¼Œæ¨¡æ‹Ÿä¸€ä¸‹promise.allçš„è¿‡ç¨‹ï¼ˆã€‚ã€‚ç›´æ¥ç»™æˆ‘æ•´è’™äº†ï¼‰</li><li><p>ç»å…¸çš„é—­åŒ…é—®é¢˜</p><p> for(var i = 0;i &lt; 10;i++){</p><pre><code>console.log(i);</code></pre><p> }<br>æœ€åè¾“å‡ºçš„æ˜¯ä»€ä¹ˆï¼Œæ”¹å†™æˆæˆ‘ä»¬éœ€è¦çš„æ ·å­</p><p> for(var i = 0;i &lt; 10;i++){</p><pre><code>(function(i){    console.log(i)})(i)</code></pre><p> }</p><h3 id="è§†é¢‘äºŒé¢"><a href="#è§†é¢‘äºŒé¢" class="headerlink" title="è§†é¢‘äºŒé¢"></a>è§†é¢‘äºŒé¢</h3><p>äºŒé¢æ˜¯ä¸€ä¸ªå°å“¥å“¥ï¼Œç›®æµ‹å‘é™…çº¿æœ‰ç‚¹å‰å®³ï¼Œæ˜¯æˆ‘ä»¥åçš„æ¨¡æ ·ã€‚å°å“¥å“¥äººè¿˜æ˜¯å¾ˆå¥½çš„ï¼Œæˆ‘æ²¡ç­”å¾—ä¸Šçš„è¿˜å’Œæˆ‘è®²äº†ä¸€éï¼Œæœ€å¥½å‘Šè¯‰æˆ‘æˆ‘çš„åŸºç¡€å“ªé‡Œæœ‰è–„å¼±ã€‚</p></li><li>è‡ªæˆ‘ä»‹ç»</li><li>stage-0 -1 çš„åŒºåˆ«</li><li>ç»å…¸çš„é—­åŒ…é—®é¢˜ï¼Œä»¥åŠé—­åŒ…æ”¹å†™ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡çš„æ¦‚å¿µ</li><li>å‡½æ•°ä½œç”¨åŸŸæç¤ºé—®é¢˜ï¼Œä¸€ä¸²ä»£ç é—®æˆ‘è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œä»£ç è®°ä¸ä½äº†ï¼Œä½†æ˜¯æˆ‘çŸ¥é“çš„æ˜¯è¿™æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„æ“ä½œã€‚ä¸è¿‡å¤§è‡´å°±æ˜¯é å˜é‡æç¤ºçš„ã€‚</li><li>ä¸€é“ç¼–ç¨‹é¢˜ï¼Œç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºé‡Œé¢å‡ºç°æœ€å¤šçš„å­—ç¬¦å¹¶è¾“å‡ºå¯¹åº”çš„å­—ç¬¦å’Œå‡ºç°æ¬¡æ•°</li><li>ç»™ä¸€å¼ äºŒå‰æ ‘çš„å›¾ï¼Œå£è¿°å‰åºä¸­åºååºéå†çš„è¿‡ç¨‹</li><li>è¯´ä¸€è¯´tcpå’ŒUdpçš„åŒºåˆ«ï¼Œä»¥åŠå„è‡ªçš„ä½¿ç”¨åœºæ™¯</li></ol><h3 id="è§†å±ä¸‰é¢"><a href="#è§†å±ä¸‰é¢" class="headerlink" title="è§†å±ä¸‰é¢"></a>è§†å±ä¸‰é¢</h3><p>å¥½å§ï¼Œè¿™ä¸€è½®ä¸è¯´å¤šå°‘ï¼Œä¸¤é“ç®—æ³•é¢˜ï¼Œæœ‰ç‚¹åæ‚”è¦æ˜¯ä¹‹å‰ææ‡‚äº†é€’å½’ä¹Ÿä¸ä¼šè¢«åˆ·ã€‚</p><ol><li><p>ç¬¬ä¸€é“é¢˜</p><pre><code>const vDom = {    tag: &apos;div&apos;,    props: {&apos;a&apos;: &apos;b&apos;},    children: [        {            tag: &apos;span&apos;,            props: {},            children: []        },{            tag: &apos;span&apos;,            props: {},            children: []        }    ]}// å°†è¿™ä¸ªjsonç»„æˆä¸€ä¸ªèŠ‚ç‚¹&lt;div a=&apos;b&apos;&gt;    &lt;span&gt;&lt;/span&gt;    &lt;span&gt;&lt;/span&gt;&lt;/div&gt;// é€’å½’æ±‚è§£</code></pre></li><li><p>æ•°ç»„æ—‹è½¬</p><p> const image = [</p><pre><code>[1,2,3,4,10],[5,6,7,8,9],[11,12,13,14,15]</code></pre><p> ]<br> // é¡ºæ—¶é’ˆæ—‹è½¬ä¹ååº¦<br>è¿™é¢˜è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œåˆ·ä¸€ä¸‹å°±å†™å®Œäº†ï¼Œåˆ·çš„ä¸€ä¸ªå°±æ”¶åˆ°äº†ä½ çš„é¢è¯•æœªé€šè¿‡çš„çŸ­ä¿¡ï¼Œåˆ·çš„ä¸€ä¸‹offerå°±é£äº†ã€‚å°±æ˜¯è¿™ä¹ˆå¿«ã€‚</p></li></ol><h2 id="ä»¥ä¸‹æ˜¯åœ¨å‡†å¤‡é¢è¯•æ—¶æ”¶é›†åˆ°çš„å…¶ä»–äººçš„ç»éªŒï¼Œä¸å…¨"><a href="#ä»¥ä¸‹æ˜¯åœ¨å‡†å¤‡é¢è¯•æ—¶æ”¶é›†åˆ°çš„å…¶ä»–äººçš„ç»éªŒï¼Œä¸å…¨" class="headerlink" title="ä»¥ä¸‹æ˜¯åœ¨å‡†å¤‡é¢è¯•æ—¶æ”¶é›†åˆ°çš„å…¶ä»–äººçš„ç»éªŒï¼Œä¸å…¨"></a>ä»¥ä¸‹æ˜¯åœ¨å‡†å¤‡é¢è¯•æ—¶æ”¶é›†åˆ°çš„å…¶ä»–äººçš„ç»éªŒï¼Œä¸å…¨</h2><h3 id="1-newä¸€ä¸ªå¯¹è±¡çš„è¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#1-newä¸€ä¸ªå¯¹è±¡çš„è¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="1. newä¸€ä¸ªå¯¹è±¡çš„è¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆ"></a>1. newä¸€ä¸ªå¯¹è±¡çš„è¿‡ç¨‹å‘ç”Ÿäº†ä»€ä¹ˆ</h3><ol><li>åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¦‚ï¼švar person = {};</li><li>æ–°å¯¹è±¡çš„protoå±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ã€‚</li><li>å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹å€¼ç»™æ–°å¯¹è±¡ã€‚ï¼ˆä¹Ÿæ‰€ä»¥thiså¯¹è±¡æŒ‡å‘æ–°å¯¹è±¡ï¼‰</li><li>æ‰§è¡Œæ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç ï¼Œå°†å±æ€§æ·»åŠ ç»™personä¸­çš„thiså¯¹è±¡ã€‚</li><li>è¿”å›æ–°å¯¹è±¡personã€‚</li></ol><h3 id="2-visibilty-å’Œ-displayï¼šnoneçš„åŒºåˆ«"><a href="#2-visibilty-å’Œ-displayï¼šnoneçš„åŒºåˆ«" class="headerlink" title="2. visibilty å’Œ displayï¼šnoneçš„åŒºåˆ«"></a>2. visibilty å’Œ displayï¼šnoneçš„åŒºåˆ«</h3><p>visibilityéšè—æ˜¯è¿˜æ˜¯ä¼šå æ®åŸæ¥çš„ä½ç½®<br>ä½†æ˜¯displayï¼šnoneä¸ä¼šå æ®åŸæ¥çš„ä½ç½®</p><h3 id="3-jsçš„åŸºæœ¬æ•°æ®ç±»å‹"><a href="#3-jsçš„åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="3. jsçš„åŸºæœ¬æ•°æ®ç±»å‹"></a>3. jsçš„åŸºæœ¬æ•°æ®ç±»å‹</h3><p>null,underfined,number,string,boolean,object</p><h3 id="4-typeofå’Œintanceofçš„åŒºåˆ«"><a href="#4-typeofå’Œintanceofçš„åŒºåˆ«" class="headerlink" title="4. typeofå’Œintanceofçš„åŒºåˆ«"></a>4. typeofå’Œintanceofçš„åŒºåˆ«</h3><p>typeofè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯´æ˜åŒ¹é…å¯¹è±¡çš„ç±»å‹ï¼Œè¿”å›å€¼æœ‰stringï¼Œnumberï¼Œbooleanï¼Œobjectï¼Œunderfinedï¼Œfunction<br>å±€é™æ€§ï¼šå¯¹äºArrayç±»å‹å’Œnull typeofä¸€è‡´éƒ½è¿”å›object</p><p>intanceofåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ„é€ å‡½æ•°çš„prototype</p><h3 id="5-å‡½æ•°çš„argumentsæ˜¯ä¸æ˜¯ä¸€ä¸ªæ•°ç»„"><a href="#5-å‡½æ•°çš„argumentsæ˜¯ä¸æ˜¯ä¸€ä¸ªæ•°ç»„" class="headerlink" title="5. å‡½æ•°çš„argumentsæ˜¯ä¸æ˜¯ä¸€ä¸ªæ•°ç»„"></a>5. å‡½æ•°çš„argumentsæ˜¯ä¸æ˜¯ä¸€ä¸ªæ•°ç»„</h3><p>ä¸æ˜¯,argumentsæ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥æ‰“å°çœ‹ä¸€ä¸‹ï¼ŒåŒ…å«äº†å‡½æ•°æ‰€æœ‰çš„å‚æ•°</p><h3 id="6-let-var-const-çš„åŒºåˆ«"><a href="#6-let-var-const-çš„åŒºåˆ«" class="headerlink" title="6. let var const çš„åŒºåˆ«"></a>6. let var const çš„åŒºåˆ«</h3><ol><li>const è¡¨ç¤ºå¸¸é‡ï¼Œä¸€æ—¦å®šä¹‰ä¸å¯ä¿®æ”¹ï¼Œä¸”å¿…é¡»åˆå§‹åŒ–</li><li>varçš„ä½œç”¨äºä¸ºå…¨æ–‡ä¸Šä¸‹ï¼Œå¯ä»¥é‡å¤å®šä¹‰ï¼Œ</li><li>letæ˜¯å¿«çº§ä½œç”¨åŸŸï¼Œä¸å¯é‡å¤å®šä¹‰</li></ol><h3 id="7-promiseçš„åŸç†åŠå®ç°"><a href="#7-promiseçš„åŸç†åŠå®ç°" class="headerlink" title="7. promiseçš„åŸç†åŠå®ç°"></a>7. promiseçš„åŸç†åŠå®ç°</h3><h3 id="8-gitç›¸å…³æ“ä½œï¼Œgit-merge-å’Œrebaseçš„åŒºåˆ«"><a href="#8-gitç›¸å…³æ“ä½œï¼Œgit-merge-å’Œrebaseçš„åŒºåˆ«" class="headerlink" title="8. gitç›¸å…³æ“ä½œï¼Œgit merge å’Œrebaseçš„åŒºåˆ«"></a>8. gitç›¸å…³æ“ä½œï¼Œgit merge å’Œrebaseçš„åŒºåˆ«</h3><ul><li>get merge ä¹‹åè§£å†³å†²çªéœ€è¦æ‰§è¡Œ git add . git commit -mâ€™fix conflictâ€™ ä¼šå¤šå‡ºä¸€ä¸ªcommit </li><li>git rebase ä¹‹åæ‰§è¡Œ git add .å’Œgit rebase â€“continue ä¸ä¼šäº§ç”Ÿé¢å¤–çš„commitè¿™æ ·ä¼šå¹²å‡€ï¼Œä¸ä¼šäº§ç”Ÿæ— æ„ä¹‰çš„commit</li></ul><h3 id="9-Es5æ–°å¢çš„map-filter-reduce"><a href="#9-Es5æ–°å¢çš„map-filter-reduce" class="headerlink" title="9. Es5æ–°å¢çš„map filter reduce"></a>9. Es5æ–°å¢çš„map filter reduce</h3><ul><li>map éå†ä¸ä¼šæ”¹å˜åŸæ•°ç»„ </li><li>filter è¿‡æ»¤ä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ </li><li>reduce å‡½æ•°å€¼ç´¯åŠ </li></ul><h3 id="10-jsä¸­çš„å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡"><a href="#10-jsä¸­çš„å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡" class="headerlink" title="10. jsä¸­çš„å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡"></a>10. jsä¸­çš„å¾®ä»»åŠ¡å’Œå®ä»»åŠ¡</h3><h3 id="11-argumentsæ˜¯ä»€ä¹ˆï¼Œè½¬æ•°ç»„æœ‰å“ªäº›æ–¹æ³•"><a href="#11-argumentsæ˜¯ä»€ä¹ˆï¼Œè½¬æ•°ç»„æœ‰å“ªäº›æ–¹æ³•" class="headerlink" title="11. argumentsæ˜¯ä»€ä¹ˆï¼Œè½¬æ•°ç»„æœ‰å“ªäº›æ–¹æ³•"></a>11. argumentsæ˜¯ä»€ä¹ˆï¼Œè½¬æ•°ç»„æœ‰å“ªäº›æ–¹æ³•</h3><p>ç±»æ•°ç»„å¯¹è±¡ï¼Œ</p><ul><li>[â€¦arguments]</li><li>Array.prototye.slice.apply(arguments)</li><li>Array.from(arguments)</li></ul><h3 id="12-cookie-sessionçš„å…³ç³»åŒºåˆ«"><a href="#12-cookie-sessionçš„å…³ç³»åŒºåˆ«" class="headerlink" title="12. cookie sessionçš„å…³ç³»åŒºåˆ«"></a>12. cookie sessionçš„å…³ç³»åŒºåˆ«</h3><h3 id="13-cookie-localStorage-sessionStorageä¹‹é—´çš„åŒºåˆ«"><a href="#13-cookie-localStorage-sessionStorageä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="13. cookie localStorage sessionStorageä¹‹é—´çš„åŒºåˆ«"></a>13. cookie localStorage sessionStorageä¹‹é—´çš„åŒºåˆ«</h3><h3 id="14-linkå’Œ-importä¹‹é—´çš„åŒºåˆ«"><a href="#14-linkå’Œ-importä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="14. linkå’Œ@importä¹‹é—´çš„åŒºåˆ«"></a>14. linkå’Œ@importä¹‹é—´çš„åŒºåˆ«</h3><ol><li>linkå±äºHTMLæ ‡ç­¾ï¼Œè€Œ@importæ˜¯CSSæä¾›çš„; </li><li>é¡µé¢è¢«åŠ è½½çš„æ—¶ï¼Œlinkä¼šåŒæ—¶è¢«åŠ è½½ï¼Œè€Œ@importå¼•ç”¨çš„CSSä¼šç­‰åˆ°é¡µé¢è¢«åŠ è½½å®Œå†åŠ è½½; </li><li>importåªåœ¨IE5ä»¥ä¸Šæ‰èƒ½è¯†åˆ«ï¼Œè€Œlinkæ˜¯HTMLæ ‡ç­¾ï¼Œæ— å…¼å®¹é—®é¢˜; </li><li>linkæ–¹å¼çš„æ ·å¼çš„æƒé‡ é«˜äº@importçš„æƒé‡.</li></ol><h3 id="15-absolute-å’Œ-float"><a href="#15-absolute-å’Œ-float" class="headerlink" title="15. absolute å’Œ float"></a>15. absolute å’Œ float</h3><p>Aï¼šå…±åŒç‚¹ï¼š<br>å¯¹å†…è”å…ƒç´ è®¾ç½®floatå’Œabsoluteå±æ€§ï¼Œå¯ä»¥è®©å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œå¹¶ä¸”å¯ä»¥è®¾ç½®å…¶å®½é«˜ã€‚</p><p>Bï¼šä¸åŒç‚¹ï¼š<br>floatä»ä¼šå æ®ä½ç½®ï¼Œpositionä¼šè¦†ç›–æ–‡æ¡£æµä¸­çš„å…¶ä»–å…ƒç´ ã€‚</p><h3 id="16-XMLå’Œjsonçš„åŒºåˆ«"><a href="#16-XMLå’Œjsonçš„åŒºåˆ«" class="headerlink" title="16. XMLå’Œjsonçš„åŒºåˆ«"></a>16. XMLå’Œjsonçš„åŒºåˆ«</h3><ol><li>æ•°æ®ä½“ç§¯æ–¹é¢ã€‚<br>JSONç›¸å¯¹äºXMLæ¥è®²ï¼Œæ•°æ®çš„ä½“ç§¯å°ï¼Œä¼ é€’çš„é€Ÿåº¦æ›´å¿«äº›ã€‚ </li><li>æ•°æ®äº¤äº’æ–¹é¢ã€‚<br>JSONä¸JavaScriptçš„äº¤äº’æ›´åŠ æ–¹ä¾¿ï¼Œæ›´å®¹æ˜“è§£æå¤„ç†ï¼Œæ›´å¥½çš„æ•°æ®äº¤äº’ã€‚ </li><li>æ•°æ®æè¿°æ–¹é¢ã€‚<br>JSONå¯¹æ•°æ®çš„æè¿°æ€§æ¯”XMLè¾ƒå·®ã€‚ </li><li>ä¼ è¾“é€Ÿåº¦æ–¹é¢ã€‚<br>JSONçš„é€Ÿåº¦è¦è¿œè¿œå¿«äºXMLã€‚</li></ol><h3 id="17-BFC"><a href="#17-BFC" class="headerlink" title="17. BFC"></a>17. BFC</h3><p>ç›’æ¨¡å‹</p><h3 id="18-HTMLè¯­ä¹‰åŒ–çš„ç†è§£"><a href="#18-HTMLè¯­ä¹‰åŒ–çš„ç†è§£" class="headerlink" title="18. HTMLè¯­ä¹‰åŒ–çš„ç†è§£"></a>18. HTMLè¯­ä¹‰åŒ–çš„ç†è§£</h3><h3 id="19-DOCTYPEï¼Œä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼"><a href="#19-DOCTYPEï¼Œä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼" class="headerlink" title="19. DOCTYPEï¼Œä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼"></a>19. DOCTYPEï¼Œä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼</h3><ol><li>å£°æ˜ä½äºæ–‡æ¡£ä¸­çš„æœ€å‰é¢ï¼Œå¤„äº æ ‡ç­¾ä¹‹å‰ã€‚å‘ŠçŸ¥æµè§ˆå™¨ä»¥ä½•ç§æ¨¡å¼æ¥æ¸²æŸ“æ–‡æ¡£ã€‚</li><li>ä¸¥æ ¼æ¨¡å¼çš„æ’ç‰ˆå’Œ JS è¿ä½œæ¨¡å¼æ˜¯ ä»¥è¯¥æµè§ˆå™¨æ”¯æŒçš„æœ€é«˜æ ‡å‡†è¿è¡Œã€‚</li><li>åœ¨æ··æ‚æ¨¡å¼ä¸­ï¼Œé¡µé¢ä»¥å®½æ¾çš„å‘åå…¼å®¹çš„æ–¹å¼æ˜¾ç¤ºã€‚æ¨¡æ‹Ÿè€å¼æµè§ˆå™¨çš„è¡Œä¸ºä»¥é˜²æ­¢ç«™ç‚¹æ— æ³•å·¥ä½œ</li><li>DOCTYPEä¸å­˜åœ¨æˆ–æ ¼å¼ä¸æ­£ç¡®ä¼šå¯¼è‡´æ–‡æ¡£ä»¥æ··æ‚æ¨¡å¼å‘ˆç°ã€‚</li></ol><h3 id="20-transform-ä»£æ›¿-marginLeft-Topçš„åŒºåˆ«"><a href="#20-transform-ä»£æ›¿-marginLeft-Topçš„åŒºåˆ«" class="headerlink" title="20. transform ä»£æ›¿ marginLeft/Topçš„åŒºåˆ«"></a>20. transform ä»£æ›¿ marginLeft/Topçš„åŒºåˆ«</h3><p>é¡µé¢å›æµæ²¡æœ‰äº†</p><h3 id="21-calcè®¡ç®—"><a href="#21-calcè®¡ç®—" class="headerlink" title="21. calcè®¡ç®—"></a>21. calcè®¡ç®—</h3><p>vwè¡¨ç¤º å®½åº¦çš„ç™¾åˆ†æ¯”<br>vhè¡¨ç¤º é«˜åº¦çš„ç™¾åˆ†æ¯”</p><h3 id="22-jsé˜²æŠ–å’ŒèŠ‚æµ"><a href="#22-jsé˜²æŠ–å’ŒèŠ‚æµ" class="headerlink" title="22. jsé˜²æŠ–å’ŒèŠ‚æµ"></a>22. jsé˜²æŠ–å’ŒèŠ‚æµ</h3><h3 id="23-æ ˆå’Œå †å¾—åŒºåˆ«"><a href="#23-æ ˆå’Œå †å¾—åŒºåˆ«" class="headerlink" title="23. æ ˆå’Œå †å¾—åŒºåˆ«"></a>23. æ ˆå’Œå †å¾—åŒºåˆ«</h3><h3 id="24-èŠä¸€èŠNaN"><a href="#24-èŠä¸€èŠNaN" class="headerlink" title="24. èŠä¸€èŠNaN"></a>24. èŠä¸€èŠNaN</h3><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å”¯ä¸€çš„ä½“ä¼šå°±æ˜¯ä¸€å®šè¦è¡¥è¡¥è‡ªå·±çš„åŸºç¡€ï¼Œå¤§å‚å¾ˆæ³¨é‡åŸºç¡€ï¼Œçœ‹çš„æ˜¯ä¸€ä¸ªäººçš„æ½œåŠ›å’Œå¯å¡‘é€ æ€§ã€‚å¦å¤–å¤šçœ‹çœ‹åˆ«äººçš„é¢ç»ï¼Œå¤šåšå¥½å‡†å¤‡æˆ‘æ˜¯å‡†å¤‡çš„æœ‰ç‚¹å†²å¿™ï¼Œå› ä¸ºæˆ‘æ€»æœ‰ä¸€ç§æ˜å¤©å°±è¦æ¯•ä¸šçš„æ—¢è§†æ„Ÿï¼Œæ‰€ä»¥å¾ˆç€æ€¥æ‰¾å·¥ä½œï¼Œç°åœ¨æ”¾å®½å¿ƒæ€æ…¢æ…¢æ¥ã€‚</p><h2 id="æœ€åå¿ è¯šç¥æ„¿å„ä½åŒè¡Œèƒ½æ‹¿åˆ°è‡ªå·±å¿ƒä»ªçš„offerï¼Œç¥å„ä½æ‹¿offeræ‹¿åˆ°æ‰‹è½¯"><a href="#æœ€åå¿ è¯šç¥æ„¿å„ä½åŒè¡Œèƒ½æ‹¿åˆ°è‡ªå·±å¿ƒä»ªçš„offerï¼Œç¥å„ä½æ‹¿offeræ‹¿åˆ°æ‰‹è½¯" class="headerlink" title="æœ€åå¿ è¯šç¥æ„¿å„ä½åŒè¡Œèƒ½æ‹¿åˆ°è‡ªå·±å¿ƒä»ªçš„offerï¼Œç¥å„ä½æ‹¿offeræ‹¿åˆ°æ‰‹è½¯"></a>æœ€åå¿ è¯šç¥æ„¿å„ä½åŒè¡Œèƒ½æ‹¿åˆ°è‡ªå·±å¿ƒä»ªçš„offerï¼Œç¥å„ä½æ‹¿offeræ‹¿åˆ°æ‰‹è½¯</h2>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>GitåŸºæœ¬æ“ä½œ</title>
      <link href="/2019/01/28/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
      <url>/2019/01/28/Git%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="1-æŸ¥çœ‹åˆ†æ”¯"><a href="#1-æŸ¥çœ‹åˆ†æ”¯" class="headerlink" title="1.æŸ¥çœ‹åˆ†æ”¯"></a>1.æŸ¥çœ‹åˆ†æ”¯</h2><pre><code>git branch æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯git branch -a æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯</code></pre><p><img src="http://static.zybuluo.com/shenweizheng/z2noezmkolv3clrzsv3kr3ys/image_1d29tb0vg1bu35spagp1spr1tqr14.png" alt="image_1d29tb0vg1bu35spagp1spr1tqr14.png-3kB"></p><a id="more"></a><p>å‰é¢å¸¦æœ‰ * å·çš„è¡¨ç¤ºå½“å‰åˆ†æ”¯ã€‚</p><pre><code>git branch xxx æ·»åŠ æœ¬åœ°åˆ†æ”¯git branch -d xxx åˆ é™¤åˆ†æ”¯git pull æ‹‰å–ä»£ç git pull origin xxx æ‹‰å–è¿œç¨‹åˆ†æ”¯git push xxx æ¨é€æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹git merge xxx åˆå¹¶åˆ†æ”¯</code></pre><h2 id="2-åˆå¹¶åˆ†æ”¯"><a href="#2-åˆå¹¶åˆ†æ”¯" class="headerlink" title="2. åˆå¹¶åˆ†æ”¯"></a>2. åˆå¹¶åˆ†æ”¯</h2><p>å½“å‰åˆ†æ”¯  A  è¦åˆå¹¶åˆ†æ”¯Bçš„ä»£ç <br>æ­¥éª¤ä¸€ï¼šå°†Aåˆ†æ”¯çš„ä»£ç commit<br>æ­¥éª¤äºŒï¼šåˆ‡æ¢åˆ°Båˆ†æ”¯  <code>git checkout B</code><br>æ­¥éª¤ä¸‰ï¼šæ‹‰å–è¿œç¨‹ä»£ç   <code>git pull</code><br>æ­¥éª¤å››ï¼šåˆ‡æ¢å›Aåˆ†æ”¯ <code>git checkout A</code><br>æ­¥éª¤äº”ï¼šåˆå¹¶Båˆ†æ”¯ä»£ç  <code>git merge B</code></p><h2 id="3-åˆå¹¶éƒ¨åˆ†æ–‡ä»¶"><a href="#3-åˆå¹¶éƒ¨åˆ†æ–‡ä»¶" class="headerlink" title="3. åˆå¹¶éƒ¨åˆ†æ–‡ä»¶"></a>3. åˆå¹¶éƒ¨åˆ†æ–‡ä»¶</h2><p>å½“å‰åˆ†æ”¯ A  è¦åˆå¹¶åˆ†æ”¯æ–‡ä»¶ B æ–‡ä»¶è·¯å¾„ /static/src/apps/login/store/loginStore.js<br>æ­¥éª¤ä¸€ï¼šå°†Aåˆ†æ”¯commit<br>æ­¥éª¤äºŒï¼šåˆ‡æ¢Båˆ†æ”¯ <code>git checkout B</code><br>æ­¥éª¤ä¸‰ï¼šæ‹‰å–è¿œç¨‹ä»£ç  <code>git pull</code><br>æ­¥éª¤å››ï¼šæ£€æŸ¥æœ‰æ²¡æœ‰æœªæäº¤çš„æ–‡ä»¶ï¼Œæœ‰çš„è¯æäº¤</p><pre><code>git statusgit commit -m &apos;&apos;</code></pre><p>æ­¥éª¤äº”ï¼šåˆ‡æ¢å›Aåˆ†æ”¯ <code>git checkout A</code><br>æ­¥éª¤å…­ï¼šcdè¿›è¯åˆå¹¶çš„æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ <code>cd /static/src/apps/login/store</code><br>æ­¥éª¤ä¸ƒï¼šåˆå¹¶æŒ‡å®šæ–‡ä»¶ <code>git merge B loginStore.js</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexoåšå®¢é…ç½®</title>
      <link href="/2018/12/05/hexo%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE/"/>
      <url>/2018/12/05/hexo%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ç½‘ç«™å›¾æ ‡æ›´æ¢"><a href="#1-ç½‘ç«™å›¾æ ‡æ›´æ¢" class="headerlink" title="1.ç½‘ç«™å›¾æ ‡æ›´æ¢"></a>1.ç½‘ç«™å›¾æ ‡æ›´æ¢</h2><p>themes\hexo-theme-Annie\layout_partial\head.ejs<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link <span class="attribute">href</span>=<span class="string">"&lt;%- config.root %&gt;img/favicon.ico"</span> <span class="attribute">rel</span>=<span class="string">"Shortcut Icon"</span> <span class="attribute">type</span>=<span class="string">"image/ico"</span>&gt;</span><br></pre></td></tr></table></figure></p><p>æˆ‘ä¸­é—´è¿™ä¸ªhexo-theme-Annie æ˜¯æˆ‘çš„ä¸»é¢˜åå­—ï¼Œåªè¦è·¯å¾„å·®ä¸å¤šï¼Œæ‰¾åˆ°layout_partial\head.ejsè¿™ä¸ªæ–‡ä»¶å°±å¯¹äº†ï¼ŒæŠŠä½ è¦æ¢çš„é‚£ä¸ªicoæ–‡ä»¶æ”¾åœ¨æ ¹ç›®å½•çš„public\imgæ–‡ä»¶é‡Œé¢å°±è¡Œäº†ï¼Œå°±æ˜¯ä½ æ”¾é™æ€æ–‡ä»¶çš„é‚£ä¸ªç›®å½•ã€‚</p><a id="more"></a><h2 id="2-ä¸»é¢˜æ›´æ¢"><a href="#2-ä¸»é¢˜æ›´æ¢" class="headerlink" title="2.ä¸»é¢˜æ›´æ¢"></a>2.ä¸»é¢˜æ›´æ¢</h2><p>å¯ä»¥å»hexo themeçš„å®˜ç½‘æ‰¾åˆ°ä½ æƒ³è¦çš„ä¸»é¢˜ï¼Œ<a href="https://hexo.io/themes/" target="_blank" rel="noopener">hexo-theme</a>é€‰æ‹©ä½ å–œæ¬¢çš„ä¸»é¢˜,ä»¥æˆ‘çš„ä¸ºä¾‹ï¼Œæˆ‘é€‰çš„æ˜¯Annie<img src="http://static.zybuluo.com/shenweizheng/91gzkw8d7exfxt76rujuznus/TIM%E6%88%AA%E5%9B%BE20181024000407.png" alt="TIMæˆªå›¾20181024000407.png-41.1kB"><br>ç„¶åç‚¹å‡»è¿™ä¸ªä¸»é¢˜ï¼Œå°±å¯ä»¥æ‰¾åˆ°è¿™ä¸ªä¸»é¢˜çš„åšå®¢æ‹¥æœ‰è€…ï¼Œè¿™æ—¶å€™è§‚å¯Ÿæµè§ˆå™¨çš„åœ°å€æ çš„è·¯ç”±ï¼Œ<a href="https://sariay.github.io/" target="_blank" rel="noopener">https://sariay.github.io/</a> github.ioå‰é¢è¿™ä¸ªsariayå°±æ˜¯åšä¸»çš„githubç”¨æˆ·åäº†<br>ç„¶åæˆ‘ä»¬ä¸»è¦åœ¨è¿› <a href="https://github.com/åšä¸»ç”¨æˆ·åï¼Œè¿™é‡Œå°±æ˜¯https://github.com/sariay" target="_blank" rel="noopener">https://github.com/åšä¸»ç”¨æˆ·åï¼Œè¿™é‡Œå°±æ˜¯https://github.com/sariay</a> å°±å¯ä»¥æ‰¾åˆ°åšä¸»çš„ä»“åº“äº†<br><img src="http://static.zybuluo.com/shenweizheng/lw0roum747u4lwi79scp4o3x/TIM%E6%88%AA%E5%9B%BE20181024000712.png" alt="TIMæˆªå›¾20181024000712.png-207.9kB"><br>è¿™é‡Œæˆ‘ä»¬æ‰¾åˆ°æˆ‘ä»¬æ‰€é€‰çš„ä¸»é¢˜ hexo-theme-Annie ç‚¹è¿›å»<br><img src="http://static.zybuluo.com/shenweizheng/di0v7n85s3nfxxdjo44my531/TIM%E6%88%AA%E5%9B%BE20181024000819.png" alt="TIMæˆªå›¾20181024000819.png-109.5kB"><br>å¤åˆ¶ä¸€ä¸‹ç½‘å€ï¼Œç„¶åæˆ‘ä»¬cdè¿›æˆ‘ä»¬çš„åšå®¢æ–‡ä»¶å¤¹ï¼Œå³å‡»git bash here<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/Sariay/hexo-theme-Annie.git themes/hexo-theme-Annie</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å§ä¸»é¢˜å…‹éš†åˆ°æˆ‘ä»¬çš„æœ¬åœ°ï¼Œç„¶åéœ€æ±‚ä¿®æ”¹ä¸€ä¸‹åšå®¢çš„é…ç½®æ–‡ä»¶_config.yml æ‰¾åˆ°themeå­—æ®µ<br><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">theme</span>: hexo-<span class="built_in">theme</span>-Annie</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹themeåé¢çš„å€¼æ˜¯æˆ‘ä»¬åˆšåˆšå…‹éš†ä¸‹æ¥çš„ä¸»é¢˜åï¼Œæ³¨æ„å…‹éš†ä¸‹çš„é‚£ä¸ªä¸»é¢˜æ–‡ä»¶å¤¹ä¸è¦å»ä¿®æ”¹ä»–çš„æ–‡ä»¶å¤¹çš„åå­—ï¼Œè¿™è¾¹é…ç½®æ–‡ä»¶ä¿®æ”¹å®Œä¹‹åï¼Œå¯åŠ¨ä¸‹æœ¬åœ°æœåŠ¡å°±ä¼šå‘ç°ä¸»é¢˜å·²ç»æ›´æ–°å¥½äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> HEXOåšå®¢ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>webpacké…ç½®åŠè¸©è¿‡çš„é‚£äº›å‘</title>
      <link href="/2018/12/03/webpack%E9%85%8D%E7%BD%AE%E5%8F%8A%E8%B8%A9%E8%BF%87%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/"/>
      <url>/2018/12/03/webpack%E9%85%8D%E7%BD%AE%E5%8F%8A%E8%B8%A9%E8%BF%87%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å­¦ä¹ äº†ä¸€æ³¢webpackæ‰“åŒ…éƒ¨ç½²ï¼Œä½œä¸ºä¸€åå‰ç«¯ï¼Œä¸ä¼šä¸€ä¸ªæ‰“åŒ…çš„å·¥å…·å¯çœŸçš„æ˜¯ä¸¢äººå•Šã€‚ä¸è¿‡ï¼Œç”¨webpackåˆè¦æ¥è§¦åˆ°äº†é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªå½“åˆå½“æˆ‘æ”¾å¼ƒå†™åç«¯çš„ä¸œè¥¿ï¼Œä¸è¿‡ä»¥åè¿˜æ˜¯è¦å…¨é¢å‘å±•çš„ã€‚å¥½äº†ï¼Œè¯ä¸å¤šè¯´ï¼Œè¿™ç¯‡æ–‡ç« ç”¨çš„æ˜¯webpack4.xç‰ˆæœ¬çš„ï¼Œä¸‹é¢å°†ç»†æ•°å½“åˆæ‰è¿‡çš„å‘ã€‚</p><a id="more"></a><h2 id="1-åŸºç¡€å‡†å¤‡"><a href="#1-åŸºç¡€å‡†å¤‡" class="headerlink" title="1.åŸºç¡€å‡†å¤‡"></a>1.åŸºç¡€å‡†å¤‡</h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹webpackDemoï¼Œæˆ‘ä»¬ä½¿ç”¨å‘½ä»¤è¡Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿è¡Œ <code>npm init</code> å‘½ä»¤ï¼Œåˆå§‹åŒ–è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆå§‹åŒ–è¿‡ç¨‹ä¸­å‡ºç°çš„è¯¢é—®çš„ä¸€äº›é…ç½®ï¼Œä¸€è·¯å›è½¦å°±å¥½äº†ã€‚åˆå§‹åŒ–å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°æ–‡ä»¶å¤¹é‡Œé¢å·²ç»å¤šäº†package.jsonæ–‡ä»¶ã€‚<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack --<span class="built_in">save</span>-<span class="built_in">dev</span> webpack-cli --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure></p><p>å®‰è£…å¿…è¦çš„ webpack å’Œ webpack-cliï¼Œå®‰è£…æˆåŠŸä¹‹åçš„package.jsonæ–‡ä»¶å¦‚ä¸‹</p><p><img src="http://static.zybuluo.com/shenweizheng/p03mjogf4044egkmgw1y3jzz/image_1csm6khqv45cj0i1plv1erc15ig9.png" alt="image_1csm6khqv45cj0i1plv1erc15ig9.png-26.8kB"></p><p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºå¦‚ä¸‹çš„ç›®å½•ç»“æ„</p><p><img src="http://static.zybuluo.com/shenweizheng/6w2mp3ir0jcu9vahebdtg5n0/image_1csm6mqk21otcctql4fvdcpcpm.png" alt="image_1csm6mqk21otcctql4fvdcpcpm.png-10.4kB"></p><p>åœ¨<code>test.js</code>æ–‡ä»¶é‡Œé¢ç¼–å†™å¦‚ä¸‹ä»£ç ï¼Œä¸€ä¸‡å¹´ç»å…¸çš„Hello World</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.write(<span class="string">"Hello World"</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>index.html</code>é‡Œé¢ç¼–å†™ä»£ç <br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Webpackåˆæ¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./dist/js/bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>è¿™è¾¹å¼•ç”¨ä¸€ä¸ª<code>bundle.js</code>æ–‡ä»¶ï¼Œ<code>bundle.js</code>æ–‡ä»¶ä½¿æˆ‘ä»¬æ‰“åŒ…ä¹‹åç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨webpackçš„æ‰“åŒ…å‘½ä»¤è¿›è¡Œæ‰“åŒ…</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack src<span class="regexp">/apps/</span>test.js -o dist<span class="regexp">/js/</span>bundle.js</span><br></pre></td></tr></table></figure><p>wepackçš„åŸºç¡€æ‰“åŒ…å‘½ä»¤ <code>webpack {entryFile} -o {aimFile}</code> æ‰§è¡Œå®Œä¹‹åä¼šå‘ç°æˆ‘ä»¬çš„ç›®å½•é‡Œå·²ç»ç”Ÿæˆäº† <code>bundle.js</code> æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿è¡Œ <code>index.html</code> æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°äº²åˆ‡çš„Hello Worldäº†ã€‚<br>æ‰“åŒ…è¿‡ç¨‹ä¸­ï¼Œå‡ºç°çš„è¾“å‡ºå¦‚ä¸‹</p><p><img src="http://static.zybuluo.com/shenweizheng/0ky26he4f2kmgoddtgzdfpuo/image_1csm770vr12441ju3u61v1s49v2j.png" alt="image_1csm770vr12441ju3u61v1s49v2j.png-52.1kB"></p><p>è¿™è¾¹ä¼šæ˜¾ç¤ºwebpackæ‰“åŒ…ä¸€å…±èŠ±äº†501msï¼Œæ‰“åŒ…åçš„ <code>bundle.js</code> ä½“ç§¯æ˜¯957bytesï¼Œå› ä¸ºæˆ‘ä»¬çš„ä»£ç æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶è¿˜æ˜¯å¾ˆå°çš„ã€‚</p><h2 id="2-webpack-config-jsé…ç½®æ–‡ä»¶"><a href="#2-webpack-config-jsé…ç½®æ–‡ä»¶" class="headerlink" title="2.webpack.config.jsé…ç½®æ–‡ä»¶"></a>2.webpack.config.jsé…ç½®æ–‡ä»¶</h2><p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶ <code>webpack.config.js</code> è¿™æ˜¯webackè¿è¡Œæ‰€è¦ä¾æ®çš„é…ç½®ã€‚å¤§è‡´åˆ†ä¸ºå…¥å£é…ç½®ï¼Œå‡ºå£é…ç½®ï¼Œloaderé…ç½®ï¼Œpluginsé…ç½®</p><h3 id="2-1-entryå’Œoutput"><a href="#2-1-entryå’Œoutput" class="headerlink" title="2.1 entryå’Œoutput"></a>2.1 entryå’Œoutput</h3><p>entryé…ç½®çš„æ˜¯å…¥å£æ–‡ä»¶ï¼Œå‘Šè¯‰webpackä»å“ªä¸ªæ–‡ä»¶å¼€å§‹è§£æï¼Œåˆ†ä¸ºå•å…¥å£å’Œå¤šå…¥å£ã€‚æœ‰äº†å…¥å£ï¼Œå°±è¦é…ç½®å‡ºå£ï¼Œé…ç½®æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ä½ç½®å’Œæ–‡ä»¶åç§°ã€‚åœ¨<code>webpack.config.js</code>é‡Œé¢ç¼–å†™å¦‚ä¸‹ä»£ç </p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const <span class="built_in">path</span> = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: <span class="built_in">path</span>.resolve(__dirname, <span class="string">'src/apps/test.js'</span>),</span><br><span class="line">    <span class="built_in">output</span>: &#123;</span><br><span class="line">        <span class="built_in">path</span>: <span class="built_in">path</span>.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">"js/bundle.js"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè¿™è¾¹å¼•ç”¨çš„<code>path</code>æ˜¯<code>node.js</code>çš„ä¸€ä¸ªæ¨¡å—ï¼Œæ˜¯ç”¨æ¥è§£æè·¯å¾„ç”¨çš„ï¼Œ<code>path.resolve</code>æŒ‡çš„æ˜¯å½“å‰æ–‡ä»¶çš„æ‰€åœ¨è·¯å¾„ï¼Œé‚£ä¹ˆè¿™è¾¹æˆ‘ä»¬<code>entry</code>é…ç½®çš„å°±æ˜¯<code>/src/apps/test.js</code>ï¼Œè¿™æ˜¯å•å…¥å£çš„é…ç½®å½¢å¼ã€‚<br>ä¸‹é¢å¯¹å‡ºå£è¿›è¡Œé…ç½®ï¼Œoutputæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŸºç¡€çš„ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ï¼Œå¦ä¸€ä¸ªæ˜¯è¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚<br>åœ¨<code>package.json</code>é‡Œé¢ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p><p><img src="http://static.zybuluo.com/shenweizheng/5fdepz23biva2ealjip37xvy/image_1csonnbu01u9340h1keo11d91nio9.png" alt="image_1csonnbu01u9340h1keo11d91nio9.png-10.9kB"></p><p>è¿™è¾¹é…ç½®ä¸€ä¸‹webpackçš„æ‰“åŒ…å‘½ä»¤ï¼Œä¹‹åé€šè¿‡<code>npm run start</code>è¿›è¡Œæ‰“åŒ…ï¼Œå°±ä¸éœ€è¦è¾“ä¸€å¤§ä¸²çš„å‘½ä»¤äº†ã€‚æ‰“åŒ…ä¸€ä¸‹æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ§åˆ¶å°çš„è¾“å‡º</p><p><img src="http://static.zybuluo.com/shenweizheng/68nmhoje7hk26hqsgfk6k2c1/image_1csonpuv21ev91ekv93i22k15gum.png" alt="image_1csonpuv21ev91ekv93i22k15gum.png-57.5kB"></p><p>å‘ç°æœ‰ä¸€ä¸ªwarningï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰é…ç½®æˆ‘ä»¬çš„modeï¼Œæˆ‘ä»¬ä¿®æ”¹<code>webpack.config.js</code>æ–‡ä»¶</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const <span class="built_in">path</span> = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line">    devtool: <span class="string">'source-map'</span>,</span><br><span class="line">    entry: <span class="built_in">path</span>.resolve(__dirname, <span class="string">'src/apps/test.js'</span>),</span><br><span class="line">    <span class="built_in">output</span>: &#123;</span><br><span class="line">        <span class="built_in">path</span>: <span class="built_in">path</span>.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">"js/bundle.js"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ‰“åŒ…ä¸€ä¸‹ä¼šå‘ç°è¿™è¾¹çš„warningå·²ç»æ²¡æœ‰äº†ã€‚</p><h3 id="2-2-devtoolé…ç½®"><a href="#2-2-devtoolé…ç½®" class="headerlink" title="2.2 devtoolé…ç½®"></a>2.2 devtoolé…ç½®</h3><p>ä¸Šé¢çš„é…ç½®æ–‡ä»¶æˆ‘ä»¬æ˜¯åŠ äº†ä¸€ä¸ª<code>devtool</code>çš„é…ç½®ï¼Œè¿™æ˜¯å› ä¸ºwebpackæ‰“åŒ…åçš„è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ï¼Œå·²ç»ä¸æ˜¯æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„ä»£ç äº†ï¼Œè¿™æ ·ä¸æ–¹ä¾¿äºæˆ‘ä»¬çš„è°ƒè¯•ï¼Œæ‰€ä»¥webpackä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€ä¸ª<code>devtool</code>çš„é…ç½®ã€‚è¿™è¾¹ç»™ä¸€ä¸ªåˆ«äººåšå®¢çš„ä¼ é€é—¨<a href="https://www.jb51.net/article/134834.htm" target="_blank" rel="noopener">webpackä¹‹devtoolè¯¦è§£</a>ï¼Œ<a href="https://webpack.js.org/configuration/devtool/#src/components/Sidebar/Sidebar.jsx" target="_blank" rel="noopener">webpackå®˜æ–¹è§£é‡Š</a></p><h3 id="2-3-loaderé…ç½®"><a href="#2-3-loaderé…ç½®" class="headerlink" title="2.3 loaderé…ç½®"></a>2.3 loaderé…ç½®</h3><p>loaderé…ç½®æ˜¯webpackä¸­çš„é‡ç‚¹ï¼Œå› ä¸ºwebpacké»˜è®¤æ˜¯åªèƒ½å¤„ç†htmlæ–‡ä»¶ï¼Œå¦‚æœè¦å¤„ç†æ¯”å¦‚reactåº”ç”¨ä¸­çš„jsxæ–‡ä»¶é‚£ä¹ˆå°±éœ€è¦é…ç½®ä¸€ä¸‹loaderï¼Œæˆ–è€…jsã€cssç­‰æ–‡ä»¶ï¼Œéƒ½éœ€è¦é…ç½®ä¸€ä¸‹loaderã€‚è¿™è¾¹å·²reactåº”ç”¨ä¸ºä¾‹ã€‚ç”±äºç›®å‰æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¤§é‡çš„æ’ä»¶å’Œloaderæ¥è½¬æ¢æˆ‘ä»¬å†™çš„é«˜çº§jsè¯­æ³•ï¼Œå°±æœ‰äº†å„ç§es6è½¬es5ï¼Œes7å•¥çš„ã€‚å…·ä½“çš„è¿˜å¾—å¥½å¥½ç ”ç©¶ã€‚é¦–å…ˆå®‰è£…reactç›¸å…³çš„æ’ä»¶</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">npm</span> <span class="comment">install</span> <span class="comment">react</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">save</span> <span class="comment">react</span><span class="literal">-</span><span class="comment">dom</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">save</span></span><br></pre></td></tr></table></figure><p>å®‰è£…è§£æreactçš„ç›¸å…³æ’ä»¶å’Œè§£æes6è¯­æ³•çš„ç›¸å…³æ’ä»¶ã€‚</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-loader -<span class="built_in">save</span>-<span class="built_in">dev</span> babel-core --<span class="built_in">save</span>-<span class="built_in">dev</span> babel-preset-env --<span class="built_in">save</span>-<span class="built_in">dev</span> babel-preset-react --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure><p>babel-core<br>æŠŠ js ä»£ç åˆ†ææˆ ast (æŠ½è±¡è¯­æ³•æ ‘, æ˜¯æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼)ï¼Œæ–¹ä¾¿å„ä¸ªæ’ä»¶åˆ†æè¯­æ³•è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚æœ‰äº›æ–°è¯­æ³•åœ¨ä½ç‰ˆæœ¬ js ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œå¦‚ç®­å¤´å‡½æ•°ï¼Œrest å‚æ•°ï¼Œå‡½æ•°é»˜è®¤å€¼ç­‰ï¼Œè¿™ç§è¯­è¨€å±‚é¢çš„ä¸å…¼å®¹åªèƒ½é€šè¿‡å°†ä»£ç è½¬ä¸º astï¼Œå†é€šè¿‡è¯­æ³•è½¬æ¢å™¨åˆ†æå…¶è¯­æ³•åè½¬ä¸ºä½ç‰ˆæœ¬ jsã€‚</p><p>babel-preset-<em><br>babel-preset-</em> ä»£è¡¨äº†ä¸€ç³»åˆ—çš„è½¬ç æ’ä»¶<br>æœ‰äº† babel-plugin ç³»åˆ—ï¼Œå¯ä»¥æŒ‰éœ€é…ç½®è‡ªå·±æƒ³è¦çš„ç‰¹æ€§ï¼Œè‹¥æ˜¯æƒ³æ­ä¸ª es6 ç¯å¢ƒï¼Œä¸€ä¸ªä¸ªåœ°é…ç½®å„ä¸ªæ’ä»¶ï¼Œæˆ‘çŒœä½ ä¼šç–¯æ‰ã€‚babel-preset ç³»åˆ—å°±å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œbabel-preset ç³»åˆ—æ‰“åŒ…äº†ä¸€ç»„æ’ä»¶ï¼Œç±»ä¼¼äºé¤å…çš„å¥—é¤ã€‚å¦‚ babel-preset-es2015 æ‰“åŒ…äº† es6 çš„ç‰¹æ€§ï¼Œbabel-preset-stage-0 æ‰“åŒ…å¤„äº strawman é˜¶æ®µçš„è¯­æ³•</p><p>ä¸‹é¢çœ‹å…·ä½“çš„é…ç½®ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼Œè¿™è¾¹é¦–å…ˆæˆ‘ä»¬è¦å°†package.jsonæ–‡ä»¶é‡Œé¢çš„babel-loaderçš„ç‰ˆæœ¬æ›´æ¢æˆ7.1.5ç„¶åé‡æ–°å®‰è£…ä¸€ä¸‹æ¨¡å—ï¼Œä¸ç„¶ä¸‹é¢ä¼šå› ä¸ºbabel-loaderçš„ç‰ˆæœ¬é—®é¢˜å‡ºç°æ‰“åŒ…å¤±è´¥çš„é—®é¢˜ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"></span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line"></span><br><span class="line">    devtool: <span class="string">'source-map'</span>,</span><br><span class="line"></span><br><span class="line">    entry: path.resolve(__dirname, <span class="string">'src/apps/console.jsx'</span>),</span><br><span class="line"></span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">"js/bundle.js"</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="keyword">module</span>: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">            test: <span class="regexp">/(\.js)|(\.jsx)$/</span>,</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">            use: &#123;</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    presets: [<span class="string">'env'</span>, <span class="string">'react'</span>]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>test æŒ‡æ˜è¦å¯¹å“ªä¸€ç§åç¼€çš„æ–‡ä»¶è¿›è¡Œè§£æï¼Œä½¿ç”¨æ­£åˆ™è¿›è¡ŒéªŒè¯<br>exclude è§„å®šä¸€äº›æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶ä¸å‚ä¸è§£æ<br>use.loader é…ç½®ä½¿ç”¨çš„loaderåç§°<br>use.option é…ç½®loaderçš„å…¶ä»–é€‰é¡¹ï¼Œè¿™è¾¹çš„presetsæ˜¯å‘Šè¯‰webpackè§£æreactè¯­æ³•å’Œes6è¯­æ³•ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// console.jsx</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mountNode = <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">Hello China!</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDOM.render(&lt;App /</span>&gt;, mountNode);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>npm run start</code>ï¼Œç„¶åè¿è¡Œæˆ‘ä»¬çš„index.htmlæ–‡ä»¶å¯ä»¥çœ‹åˆ°Hello Chinaï¼ã€‚</p><h3 id="2-4-pluginé…ç½®"><a href="#2-4-pluginé…ç½®" class="headerlink" title="2.4 pluginé…ç½®"></a>2.4 pluginé…ç½®</h3><p>æ’ä»¶èµ‹äºˆäº†webpackæ›´å¤šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¯´ jså’Œcssåˆ†ç¦»æ‰“åŒ…ã€‚æ¯”å¦‚è¯´happyPackçš„å¤šçº¿ç¨‹æ‰“åŒ…ï¼Œæ¯”å¦‚è¯´æ¯æ¬¡æ‰“åŒ…å‰è‡ªåŠ¨æ¸…ç©ºdistç›®å½•ã€‚<br>ä»¥jsã€cssåˆ†ç¦»æ‰“åŒ…ä¸ºä¾‹ï¼Œè¿™æ˜¯ä½¿ç”¨çš„<code>extract-text-webpack-plugin</code>æ’ä»¶ï¼Œ<br>é¦–å…ˆå®‰è£…ä¸€ä¸‹ï¼Œæ³¨æ„è¿™è¾¹å®‰è£…çš„æ˜¯<code>extract-text-webpack-plugin@next</code>è€Œä¸æ˜¯<code>extract-text-webpack-plugin</code></p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --<span class="built_in">save</span>-<span class="built_in">dev</span> extract-text-webpack-plugin@<span class="built_in">next</span></span><br><span class="line">npm install style-loader --<span class="built_in">save</span>-<span class="built_in">dev</span> css-loader --<span class="built_in">save</span>-<span class="built_in">dev</span></span><br></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"></span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line"></span><br><span class="line">    devtool: <span class="string">'source-map'</span>,</span><br><span class="line"></span><br><span class="line">    entry: path.resolve(__dirname, <span class="string">'src/apps/console.jsx'</span>),</span><br><span class="line"></span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">"js/bundle.js"</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="keyword">module</span>: &#123;</span><br><span class="line">        rules: [&#123;</span><br><span class="line">            test: <span class="regexp">/(\.js)|(\.jsx)$/</span>,</span><br><span class="line">            exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">            use: &#123;</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    presets: [<span class="string">'env'</span>, <span class="string">'react'</span>]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">            use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                fallback: <span class="string">'style-loader'</span>,</span><br><span class="line">                use: [<span class="string">'css-loader'</span>]</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> ExtractTextPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'style/css/[name].css'</span>,</span><br><span class="line">            allChunks: <span class="literal">true</span> </span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###2.5 å…¶ä»–é…ç½®###</p><blockquote><p>statsé…ç½®</p></blockquote><p>åœ¨è¿›è¡Œwebpackæ‰“åŒ…çš„æ—¶å€™ä¼šå‡ºç°å¾ˆå¤šçš„è¾“å‡ºï¼Œä½†æ˜¯æœ‰çš„è¾“å‡ºæ˜¯æˆ‘ä»¬ä¸éœ€è¦çœ‹è§çš„è¾“å‡ºï¼Œè¿™å°±å¯ä»¥é‡‡ç”¨statsè¿›è¡Œé…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">//</span> <span class="string">å¯¹webpackè¾“å‡ºä¿¡æ¯çš„é…ç½®ï¼Œå¯ä»¥å‡å°‘ä¸€äº›ä¸å¿…è¦çš„è¾“å‡º</span></span><br><span class="line"><span class="attr">stats:</span> <span class="string">&#123;</span></span><br><span class="line"><span class="attr">    children:</span> <span class="literal">false</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>resolve.extensions è§£å†³å¼•å…¥æ¨¡å—ä¸éœ€è¦åŠ åç¼€<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// extensions è‡ªåŠ¨è§£å†³æ‰©å±•ï¼Œé…ç½®è¿™ä¸ªåœ¨å¼•ç”¨æ¨¡å—æ—¶ä¸ç”¨åŠ åç¼€</span><br><span class="line">// modules é…ç½®è§£ææ¨¡å—çš„æœç´¢ç›®å½•</span><br><span class="line">// path.<span class="built_in">resolve</span> è¿”å›å‚æ•°çš„ç»å¯¹è·¯å¾„  path.<span class="keyword">join</span> æ‹¼æ¥è·¯å¾„ ç„¶åè¿”å›ç»å¯¹è·¯å¾„</span><br><span class="line"><span class="built_in">resolve</span>: &#123;</span><br><span class="line">        module<span class="variable">s:</span> [path.<span class="built_in">resolve</span>(__dirname, <span class="string">'node_modules'</span>), path.<span class="keyword">join</span>(__dirname, <span class="string">'src'</span>)],</span><br><span class="line">        extension<span class="variable">s:</span> [<span class="string">'.wasm'</span>, <span class="string">'.mjs'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.jsx'</span>]</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>optimizationé…ç½® æŠ½ç¦»å…¬å…±æ¨¡å—<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">optimization</span>: &#123;</span><br><span class="line">    <span class="attribute">minimize</span>: false,</span><br><span class="line">    <span class="attribute">splitChunks</span>: &#123;</span><br><span class="line">        <span class="attribute">chunks</span>: <span class="string">'all'</span>,</span><br><span class="line">        <span class="attribute">name</span>: <span class="string">'common'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="last-ä¸€äº›è§£é‡ŠåŠè¸©è¿‡çš„é‚£äº›å‘"><a href="#last-ä¸€äº›è§£é‡ŠåŠè¸©è¿‡çš„é‚£äº›å‘" class="headerlink" title="last.ä¸€äº›è§£é‡ŠåŠè¸©è¿‡çš„é‚£äº›å‘"></a>last.ä¸€äº›è§£é‡ŠåŠè¸©è¿‡çš„é‚£äº›å‘</h2><p>###last.1 npm install çš„æ—¶å€™ â€“save-dev å’Œâ€“saveçš„åŒºåˆ«</p><p>é¦–å…ˆè¿™è¾¹çš„ <code>--save</code> æ˜¯å°†æˆ‘ä»¬installçš„åŒ…å†™è¿›package.jsonæ–‡ä»¶é‡Œé¢ï¼Œåé¢çš„-devæ‰æ˜¯è¦æè¿°çš„é‡ç‚¹ï¼Œ<code>-dev</code>æ˜¯å†™è¿›æˆ‘ä»¬çš„<code>devDependencies</code>é‡Œé¢ï¼Œå¦‚æœä¸åŠ è¿™ä¸ªé‚£ä¹ˆæ˜¯å†™è¿›<code>dependencies</code>é‡Œé¢çš„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæ˜¯ä¸ä¼šå®‰è£…<code>devDependencies</code>é‡Œé¢çš„åŒ…çš„ã€‚è¿™è¾¹æ‰¾äº†ä¸€ä¸ªåˆ«äººçš„åšå®¢ï¼Œå†™çš„æ¯”æˆ‘è¿™ä¸ªæ›´å…¨é¢ä¸€ç‚¹ã€‚<a href="https://www.cnblogs.com/blackgan/p/7678868.html" target="_blank" rel="noopener">å¯¹â€“save-devå’Œâ€“saveçš„åŒºåˆ«è¯¦è§£</a></p><p>###last.2 webpackåŸºç¡€å‘½ä»¤æ‰“åŒ…çš„æ—¶å€™æŠ¥ERROR in multi ./src/apps/test.js dist/js/bundle.js<br>Module not found: Error: Canâ€™t resolve â€˜dist/js/bundle.jsâ€™ in â€˜F:\WebDemo\webpackDemoâ€™</p><p>è¿™æ˜¯å› ä¸ºwebpackçš„ç‰ˆæœ¬é—®é¢˜ï¼Œåœ¨webpack4.xç‰ˆæœ¬ä¹‹å‰çš„æ‰“åŒ…å‘½ä»¤æ˜¯<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">webpack </span><span class="template-variable">&#123;entryFile&#125;</span><span class="xml"> </span><span class="template-variable">&#123;aimFile&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯åœ¨webpack4.xå¼€å§‹åŸºç¡€æ‰“åŒ…å‘½ä»¤å°±å˜æˆäº†<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class">webpack </span>&#123;entryFile&#125; -<span class="class">o </span>&#123;aimFile&#125;</span><br></pre></td></tr></table></figure></p><p>###last.3å‡ºç°Error: Cannot find module â€˜@babel/coreâ€™###<br>è¿™æ˜¯å› ä¸º<code>babel-loader</code>ç‰ˆæœ¬çš„é—®é¢˜ï¼Œå¦‚æœä¹‹å‰æˆ‘ä»¬å®‰è£…<code>babel-loader</code>çš„æ—¶å€™æ˜¯é‡‡ç”¨<code>npm install babel-loader</code>è¿™æ ·å†™çš„è¯æ˜¯é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„<code>babel-loader</code>æœ€æ–°çš„æ˜¯8.xçš„ï¼Œæˆ‘ä»¬å›é€€åˆ°7.1.5ç‰ˆæœ¬å°±å¯ä»¥é¿å…è¿™ä¸ªæŠ¥é”™äº†ã€‚</p><p>###last.4 webpack-dev-serveré—®é¢˜ ###<br>1.webpack-dev-server ä¸ä¼šè¯»å–webpack.config.jsé…ç½®çš„outputä¹Ÿä¸ä¼šå°†ç”Ÿäº§çš„æ–‡ä»¶æ·»åŠ è¿›é¡¹ç›®ç›®å½•é‡Œ<br>2.webpack-dev-server ç”Ÿæˆçš„æ–‡ä»¶å’Œä½ disté‡Œé¢çš„æ–‡ä»¶ä¸æ˜¯åŒä¸€ä¸ªæ–‡ä»¶ã€‚disté‡Œé¢çš„æ˜¯outputé‡Œé¢å†³å®š<br>çš„webpack-dev-serveræ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶ä½ç½®å–å†³äºcontentBaseé…ç½®</p><p>###last.5 çš„ package.jsoné‡Œé¢çš„æ‰“åŒ…å‘½ä»¤###<br>â€“colors è¾“å‡ºç»“æœå¸¦æœ‰é¢œè‰²<br>â€“profile è¾“å‡ºæ€§èƒ½æ•°æ®çœ‹è§æ¯ä¸€æ­¥çš„è€—æ—¶<br>â€“proress è¾“å‡ºå½“å‰çš„ç¼–è¯‘è¿›åº¦<br>â€“display-error-details è¾“å‡ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</p><p>###lats.6 ä½¿ç”¨extractTextPluginæ—¶æŠ¥ Chunk.entrypoints: Use Chunks.groupsIterable and filter by instanceof Entrypoint instead###<br>è¿™æ˜¯å› ä¸ºå®‰è£…<code>extract-text-webpack-plugin</code>çš„æ—¶å€™å®‰è£…å‘½ä»¤é—®é¢˜ï¼Œå®é™…ä¸Šæˆ‘ä»¬éœ€è¦å®‰è£…çš„æ˜¯<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"<span class="selector-tag">extract-text-webpack-plugin</span>": "^4<span class="selector-class">.0</span><span class="selector-class">.0-beta</span><span class="selector-class">.0</span>",</span><br></pre></td></tr></table></figure></p><p>è§£å†³åŠæ³•ï¼Œåˆ é™¤ä¹‹å‰å®‰è£…çš„extractæ’ä»¶ï¼Œæ›´æ¢å®‰è£…å‘½ä»¤ä¸º<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --<span class="built_in">save</span>-<span class="built_in">dev</span> extract-text-webpack-plugin@<span class="built_in">next</span></span><br></pre></td></tr></table></figure></p><p>###last.7 å…¥å£æ–‡ä»¶é…ç½®[name].js ä½†æ˜¯æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶æ€»æ˜¯main.jså¹¶ä¸ä¼šæ ¹æ®å…¥å£åç§°å†³å®šå‡ºå£åç§°###<br>è¿™è¾¹çš„main.js mainæ˜¯å–å†³ä½ çš„ä¸»å…¥å£çš„ï¼Œå°±æ˜¯åœ¨æ‰§è¡Œnpm initçš„æ—¶å€™é‚£ä¸€å †é»˜è®¤çš„ä¸»å…¥å£ã€‚ä¹‹æ‰€ä»¥æ²¡æœ‰æŒ‰ç…§å…¥å£æ–‡ä»¶æ¥æ”¹å˜å‡ºå£æ–‡ä»¶çš„åç§°ï¼Œæ˜¯å› ä¸ºå…¥å£æ–‡ä»¶é‡‡ç”¨çš„å•å…¥å£çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯å¦‚ä¸‹å†™æ³•<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">entry</span>: path.resolve(__dirname, <span class="symbol">'src</span>/apps/console.jsx')</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨å•å…¥å£çš„å½¢å¼ï¼Œé‚£ä¹ˆ<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">output</span>: &#123;</span><br><span class="line">        <span class="attribute">path</span>: path.<span class="built_in">resolve</span>(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'js/[name].js'</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure></p><p>æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶åªä¼šæœ‰ä¸€ä¸ªmain.js å¹¶ä¸ä¼šç”Ÿæˆconsole.js<br>è§£å†³åŠæ³•æ˜¯å°†å•å…¥å£çš„å†™æ³•æ¢æˆå¤šå…¥å£çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ç§å†™æ³•<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">entry</span>: &#123;</span><br><span class="line">        <span class="attribute">console</span>: path.<span class="built_in">resolve</span>(__dirname, <span class="string">'src/apps/console'</span>)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å°±æ˜¯console.js</p><p>###last.7 bundle.jså’Œvendor.jsçš„å¼•å…¥é¡ºåºé—®é¢˜###<br>vendor.jsä¸€å®šæ˜¯æœ€å…ˆå¼•ç”¨çš„ï¼Œå› ä¸ºbundle.jsè¦ä¾èµ–äºvendor.jsç”Ÿå­˜ã€‚</p><p>###last.8 åè¯è§£é‡Š ###<br>webpack.config.dev.js å¼€å‘ç¯å¢ƒä¸‹çš„webpacké…ç½®æ–‡ä»¶<br>webpack.config.prod.js ç”Ÿäº§ç¯å¢ƒä¸‹çš„é…ç½®æ–‡ä»¶<br>vendor.js è¿™æ˜¯æ‰“åŒ…æˆ‘ä»¬å¼•å…¥çš„ç¬¬ä¸‰æ–¹åŒ…çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> webpack </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è…¾è®¯äº‘æœåŠ¡å™¨é…ç½®JDKï¼Œtomcatè§£å†³å¤–ç½‘æ— æ³•è®¿é—®é—®é¢˜</title>
      <link href="/2018/11/10/%E8%85%BE%E8%AE%AF%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEJDK%EF%BC%8Ctomcat%E8%A7%A3%E5%86%B3%E5%A4%96%E7%BD%91%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E9%97%AE%E9%A2%98/"/>
      <url>/2018/11/10/%E8%85%BE%E8%AE%AF%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEJDK%EF%BC%8Ctomcat%E8%A7%A3%E5%86%B3%E5%A4%96%E7%BD%91%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>å‰å‡ å¤©è¯•äº†ä¸€ä¸‹è…¾è®¯äº‘çš„å­¦ç”ŸæœåŠ¡å™¨ï¼Œåœ¨é…ç½®tomcatçš„æ—¶å€™ï¼Œé…ç½®äº†å¥½ä¹…ï¼Œä¸€ç›´éƒ½æ˜¯æ— æ³•è®¿é—®ä¸»é¡µï¼Œç¿»çœ‹äº†Nå¤šçš„åšå®¢ï¼Œå…³äº†é˜²ç«å¢™ï¼Œé…ç½®äº†å®‰å…¨ç»„ï¼Œä¾æ—§æ— æ³•è®¿é—®ï¼Œæ¥ä¸‹æ¥æ”¹äº†tomcatçš„é…ç½®ç»ˆäºæˆåŠŸï¼Œè®°å½•ä¸€ä¸‹ã€‚<br>æˆ‘ç”¨çš„æ˜¯è…¾è®¯äº‘çš„å­¦ç”ŸæœåŠ¡å™¨ï¼Œæ“ä½œç³»ç»Ÿæ˜¯CentOS7.2 64ä½ JDKç‰ˆæœ¬æ˜¯1.8.0 tomcatç‰ˆæœ¬æ˜¯8.5.34<br>å‡†å¤‡ä¸€ä¸‹XShellå·¥å…·ï¼Œæˆ‘æ˜¯ä½¿ç”¨çš„XShellã€‚è¿˜æœ‰ä¸€ä¸ªWinScpå·¥å…·ç”¨æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰æœ‰ç‚¹æ…¢ï¼Œä¸æ‡‚æ˜¯ä¸æ˜¯é”™è§‰ã€‚</p><a id="more"></a><h2 id="1-é…ç½®JDK"><a href="#1-é…ç½®JDK" class="headerlink" title="1.é…ç½®JDK"></a>1.é…ç½®JDK</h2><p>ç½‘ä¸Šçœ‹åˆ°äº†å¾ˆå¤šé…ç½®jdkçš„æ–¹æ³•ï¼Œç›¸å¯¹è€Œè¨€ï¼Œé…ç½®ä¸€ä¸‹jdkè¿˜æ˜¯å¾ˆç®€å•ã€‚æˆ‘æ˜¯ä½¿ç”¨çš„ç›´æ¥è§£å‹linuxç‰ˆæœ¬çš„jdkæ–‡ä»¶ç„¶åé…ç½®ä¸‹ç¯å¢ƒå˜é‡ï¼Œå½“ç„¶ä¹Ÿæœ‰çš„æ˜¯ç›´æ¥ä½¿ç”¨yumå®‰è£…jdkã€‚é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå»<a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">jdkå®˜ç½‘</a>ä¸‹è½½ä¸€ä¸‹jdk<br><img src="http://static.zybuluo.com/shenweizheng/d6as8u57y5cwx0zklb2l8ubg/image_1crsc1nek1797gbtv7i1rfvpiv9.png" alt="image_1crsc1nek1797gbtv7i1rfvpiv9.png-103.2kB"></p><p>è¿™è¾¹æˆ‘ä»¬ç”¨çš„æ˜¯åç¼€ä¸º.tar.gzçš„ï¼Œè¿™æ˜¯linuxç‰ˆæœ¬çš„<br>ä½¿ç”¨æˆ‘ä»¬çš„WinScpå·¥å…·æŠŠæˆ‘ä»¬åˆšåˆšçš„ä¸‹è½½çš„jdkä¸Šä¼ è‡³æˆ‘ä»¬çš„æœåŠ¡å™¨ã€‚ç”¨XShellç™»å½•è¿›æœåŠ¡å™¨ï¼Œè¿™è¾¹æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æˆ‘çœ‹åˆ°æœ‰çš„åšå®¢æ˜¯è¯´ä¸€å¼€å§‹è¿›å»çš„æ—¶å€™ä¸æ˜¯rootç”¨æˆ·ä½†æ˜¯æˆ‘è¿™è¾¹æ˜¯è¿›å»å°±æ˜¯rootç”¨æˆ·ã€‚ä¸‹é¢çš„æ‰€æœ‰çš„é…ç½®æˆ‘ä»¬éƒ½æ˜¯è¦åœ¨rootç”¨æˆ·ä¸‹è¿›è¡Œçš„ã€‚<br><img src="http://static.zybuluo.com/shenweizheng/dpu4hunouaswrrmozaq12750/image_1crscssno10vipt7m0e37m1rfd13.png" alt="image_1crscssno10vipt7m0e37m1rfd13.png-21.9kB"></p><p>å¦‚æœä½ ä¸æ˜¯rootç”¨æˆ·è€Œæ˜¯ubuntuç”¨æˆ·é‚£ä¹ˆ<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo su</span></span><br></pre></td></tr></table></figure></p><p>åˆ‡æ¢è¿›rootç”¨æˆ·ï¼Œå½“ç„¶æˆ‘æ²¡æœ‰é‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚<br><img src="http://static.zybuluo.com/shenweizheng/jewd66ybvwimbvixxk3lxl4f/image_1crtp2a1sb8t10vtdsd1475dgs9.png" alt="image_1crtp2a1sb8t10vtdsd1475dgs9.png-25.8kB"><br>lsä¸€ä¸‹æŸ¥çœ‹ç°åœ¨çš„æ ¹ç›®å½•ï¼Œè§£å‹jdk</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-<span class="number">8</span>u191-linux-x64<span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure><p>lsæŸ¥çœ‹ä¸€ä¸‹è§£å‹æˆåŠŸ</p><p><img src="http://static.zybuluo.com/shenweizheng/r5nqg0utk1vumr6jqro13xkp/image_1crtp97csdms3kc15pv10c01jkr16.png" alt="image_1crtp97csdms3kc15pv10c01jkr16.png-7.4kB"></p><p>æ¥ä¸‹æ¥åœ¨/usrä¸‹é¢åˆ›å»ºä¸€ä¸‹æ–‡ä»¶å¤¹å«java</p><p><img src="http://static.zybuluo.com/shenweizheng/o3c26xka6jvyiwo7nesvgiv9/image_1crtpt60a3271k911pcd1c4boqf1j.png" alt="image_1crtpt60a3271k911pcd1c4boqf1j.png-10.8kB"></p><p>æ¥ä¸‹æ¥æŠŠæˆ‘ä»¬è§£å‹å¥½çš„jdkæ”¾åˆ°ä¸Šä¸€æ­¥åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸‹é¢</p><p><img src="http://static.zybuluo.com/shenweizheng/9qxwwuaubcriiuqy62j7jg38/image_1crtq214a1r2lav3t7svm8144c20.png" alt="image_1crtq214a1r2lav3t7svm8144c20.png-5kB"></p><p>ä¸‹é¢å°±æ˜¯é…ç½®jdkçš„ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ /etc/profileæ–‡ä»¶</p><p><img src="http://static.zybuluo.com/shenweizheng/hretoz8xtgh5byccpiydt2fj/image_1crtq922b1kt1jmb15ri16on5sb2d.png" alt="image_1crtq922b1kt1jmb15ri16on5sb2d.png-2.7kB"></p><p>é…ç½®ä¸€ä¸‹JAVA_HOME CLASSPATH PATH<br><img src="http://static.zybuluo.com/shenweizheng/gogfsd3z7zlxc8zjcvfk8gfy/image_1crtqakkmm3s1a6103c1duq1be2q.png" alt="image_1crtqakkmm3s1a6103c1duq1be2q.png-75.5kB"></p><p>æŒ‰escä¹‹å :wq ä¿å­˜é€€å‡ºç¼–è¾‘ï¼Œä¸å¾—ä¸è¯´linuxå‘½ä»¤è¿˜æ˜¯è¦ä¼šçš„ï¼Œå¤šå¤šå°‘å°‘ä¼šç”¨åˆ°linuxçš„ä¸œè¥¿<br>ä½¿ç”¨sourceå‘½ä»¤ä½¿æˆ‘ä»¬åˆšåˆšåšçš„ä¿®æ”¹ç”Ÿæ•ˆï¼Œä½¿ç”¨java -versionæ£€æŸ¥æˆ‘ä»¬çš„é…ç½®æ˜¯å¦æ­£ç¡®<br><img src="http://static.zybuluo.com/shenweizheng/wx9rjeszrp6a80sx5x2lnffr/image_1crtqesme1pmnldm1ltm12u71uq737.png" alt="image_1crtqesme1pmnldm1ltm12u71uq737.png-15.3kB"></p><p>åˆ°æ­¤ä¸ºæ­¢jdkçš„é…ç½®å·²ç»åšå®Œäº†ï¼Œä¸‹é¢å°±æ˜¯tomcatçš„é…ç½®ï¼Œä¹Ÿæ˜¯æœ¬ç« çš„é‡ç‚¹ï¼Œæ‹¿ç¬”å¼€å§‹è®°ç¬”è®°äº†ã€‚</p><h2 id="2-Tomcaté…ç½®ä»¥åŠå¤–ç½‘æ— æ³•è®¿é—®é—®é¢˜"><a href="#2-Tomcaté…ç½®ä»¥åŠå¤–ç½‘æ— æ³•è®¿é—®é—®é¢˜" class="headerlink" title="2.Tomcaté…ç½®ä»¥åŠå¤–ç½‘æ— æ³•è®¿é—®é—®é¢˜"></a>2.Tomcaté…ç½®ä»¥åŠå¤–ç½‘æ— æ³•è®¿é—®é—®é¢˜</h2><p>é¦–å…ˆç¬¬ä¸€æ­¥æˆ‘ä»¬å¾—å»ä¸‹ä¸€ä¸ªtomcatå’Œjdkä¸€æ ·ï¼Œè¿™è¾¹ç»™ä¸€ä¸ªä¼ é€é—¨<a href="https://tomcat.apache.org/download-80.cgi" target="_blank" rel="noopener">tomcat8.5</a><br><img src="http://static.zybuluo.com/shenweizheng/7i5yo5ja413q6abv4oflxlg8/image_1crtqmg8s4ap1joo1ls219a2140k3k.png" alt="image_1crtqmg8s4ap1joo1ls219a2140k3k.png-93.4kB"></p><p>è€æ ·å­è¿˜æ˜¯ä¸‹.tar.gzçš„ï¼Œæ¥ä¸‹æ¥ä¸Šä¼ tomcatï¼Œè§£å‹tomcatï¼Œå°†è§£å‹å¥½çš„æ–‡ä»¶å¤¹ç§»è‡³æˆ‘ä»¬çš„/usr/javaæ–‡ä»¶å¤¹ä¸‹é¢ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é‡æ–°å»ºä¸€ä¸ªï¼Œè¿™éƒ½æ˜¯å°äº‹ã€‚</p><p>æˆ‘ä»¬è¿›å…¥javaæ–‡ä»¶å¤¹ï¼Œlsä¸€ä¸‹ç°åœ¨æ˜¯æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªæ˜¯æˆ‘ä»¬ä¸Šé¢çš„jdkå¦ä¸€ä¸ªæ˜¯åˆšåˆšçš„tomcat</p><p><img src="http://static.zybuluo.com/shenweizheng/1jujj0042crmuqpr3nhq01he/image_1crtqu1pvaag1fcn4ld123vpdl41.png" alt="image_1crtqu1pvaag1fcn4ld123vpdl41.png-9.4kB"></p><p>é‚£ä¹ˆä¸‹é¢å°±æ˜¯tomcatçš„é—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬å»ä¿®æ”¹ä¸€ä¸‹tomcatçš„ç«¯å£å·ï¼Œé»˜è®¤æ˜¯8080æˆ‘ä»¬è¿™è¾¹ä¿®æ”¹æˆ80ã€‚ä¿®æ”¹conf/server.xmlæ–‡ä»¶</p><p><img src="http://static.zybuluo.com/shenweizheng/m481dibr6w5yrraphxtm425r/image_1crtr550hecc8krk3e1spm18e14e.png" alt="image_1crtr550hecc8krk3e1spm18e14e.png-87.4kB"></p><p>æ¥ä¸‹æ¥å°±æ˜¯å¯åŠ¨æˆ‘ä»¬çš„tomcatå…ˆçœ‹ä¸€ä¸‹èƒ½ä¸èƒ½è®¿é—®ã€‚å¯åŠ¨ç¨‹åºå’Œå…³é—­ç¨‹åºåœ¨ binç›®å½•ä¸‹æœ‰ä¸€ä¸ªstartup.sh å’Œshutdown.sh<br><img src="http://static.zybuluo.com/shenweizheng/wfhcb1ul4humux1pedea0xuo/image_1crtr8o56c35t577c01j8n1e3d4r.png" alt="image_1crtr8o56c35t577c01j8n1e3d4r.png-23.9kB"></p><p>å¦‚æœè¿™ä¸€æ­¥é‡åˆ° -bash: startup.sh not commandè¿™ç§æŠ¥é”™æ—¶<br><img src="http://static.zybuluo.com/shenweizheng/kmv88x25dvqaps4h54xmgps2/image_1crtrcipe1nla1bfd1honj199j458.png" alt="image_1crtrcipe1nla1bfd1honj199j458.png-3.3kB"></p><p>ç„¶åå†æ‰§è¡Œstartup.shæ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬è¿™è¾¹å¼€å¯äº†tomcatï¼Œä½¿ç”¨å¤–ç½‘ipåŠ ç«¯å£å·è®¿é—®ä¸€ä¸‹çœ‹çœ‹æƒ…å†µã€‚<br>å¦‚æœä½ ä¸èƒ½è®¿é—®ï¼Œé¦–å…ˆé…ç½®ä¸€ä¸‹äº‘æœåŠ¡å™¨çš„å®‰å…¨ç»„ï¼Œè¿™è¾¹æˆ‘ä»¬ç›´æ¥é»˜è®¤å…¨éƒ¨ç«¯å£éƒ½æ”¾é€šï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é…ç½®ä¸€ä¸‹è§„åˆ™ã€‚<br><img src="http://static.zybuluo.com/shenweizheng/5fo9j5yft5genj37nn2kuume/image_1crtrkq1k1d56sa6i1l18vf97t5l.png" alt="image_1crtrkq1k1d56sa6i1l18vf97t5l.png-134.3kB"></p><p>æ¥ä¸‹æ¥é‡å¯ä¸€ä¸‹æœåŠ¡å™¨ï¼Œä¸çŸ¥é“è¦ä¸è¦é‡å¯ï¼Œåæ­£æˆ‘æ˜¯é‡å¯äº†ä¸€ä¸‹ã€‚ä¹‹åå†å»è®¿é—®ä¸€ä¸‹80ç«¯å£ï¼Œçœ‹èƒ½ä¸èƒ½å‡ºç°tomcatçš„ä¸»é¡µï¼Œå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œé‚£ä¹ˆæ¥ä¸‹å»æˆ‘ä»¬ç»§ç»­é…ç½®ï¼Œè¿™è¾¹å®‰å…¨ç»„æ˜¯å·²ç»éƒ½å¼€å¯äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŸ¥çœ‹80ç«¯å£æœ‰æ²¡æœ‰å¼€å¯ã€‚<br><img src="http://static.zybuluo.com/shenweizheng/ajfaio341tmx3l9idey0ylsq/image_1crtrscii1ls21anrl9417411oq762.png" alt="image_1crtrscii1ls21anrl9417411oq762.png-20.2kB"></p><p>æˆ‘è¿™è¾¹æ˜¯å·²ç»é…ç½®å¥½äº†çš„ï¼Œæ‰€ä»¥80ç«¯å£æ˜¯å¼€å¯çš„ï¼Œå¦‚æœä½ çš„80ç«¯å£æ²¡æœ‰å¼€å¯ï¼Œé‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å»æä¸€ä¸‹é˜²ç«å¢™ã€‚<br>é¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹é˜²ç«å¢™çš„çŠ¶æ€<br><img src="http://static.zybuluo.com/shenweizheng/xnj3z2ymgshz32aylpes248g/image_1crts1red1bu81bfd50d4q1dio6f.png" alt="image_1crts1red1bu81bfd50d4q1dio6f.png-14.5kB"></p><p>å‘ç°ç°åœ¨é˜²ç«å¢™æ˜¯å…³é—­çš„ï¼Œè¿™è¾¹æˆ‘ä»¬å…ˆå¼€å¯ä¸€ä¸‹é˜²ç«å¢™ï¼Œä¸ç„¶å¾…ä¼šå‡ºç°filreWalld not runnuindçš„é”™<br><img src="http://static.zybuluo.com/shenweizheng/xs7nmzqmlgvdzwi1anzg7cvf/image_1crtsqrhpmbqirf1n2g17p0n2s6s.png" alt="image_1crtsqrhpmbqirf1n2g17p0n2s6s.png-10.2kB"></p><p>è¿™è¾¹é…ç½®å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬åœ¨å§é˜²ç«å¢™å…³é—­ä¸€ä¸‹<br><code>systemctl stop firewalld</code>ï¼Œæˆ‘ä»¬è¿›å…¥tomcatçš„binç›®å½•ä¸‹é‡å¯ä¸€ä¸‹æœåŠ¡å™¨ã€‚<br><img src="http://static.zybuluo.com/shenweizheng/objwn9diivl04baejjzuw4ru/image_1crtssq284be17641u821v391dgc79.png" alt="image_1crtssq284be17641u821v391dgc79.png-83.6kB"></p><p>å¦‚æœä½ åœ¨å…³é—­çš„æ—¶å€™é‡åˆ°Neither the JAVA_HOME nor the JRE_HOME environment variable is definedè¿™ä¸ªæŠ¥é”™çš„æ—¶å€™ï¼Œä½¿ç”¨vimä¿®æ”¹ä¸€ä¸‹binç›®å½•ä¸‹çš„setclasspath.shï¼Œæ‰‹åŠ¨æ·»åŠ JAVA_HOMEå’ŒJRE_HOMEä¸¤ä¸ªç¯å¢ƒå˜é‡ã€‚<br><img src="http://static.zybuluo.com/shenweizheng/i7us0bl35qtytmr8ie00rchh/image_1crtt3g1d1lno1552p601sr325f83.png" alt="image_1crtt3g1d1lno1552p601sr325f83.png-269.3kB"></p><p>å…³é—­ä¹‹åï¼Œåœ¨å¯åŠ¨ä¸€ä¸‹tomcatï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®å…¬ç½‘ipè®¿é—®ï¼Œå‡ºç°tomcatä¸»é¡µã€‚å¦‚æœè¿˜æ˜¯æ²¡æœ‰å‡ºç°çš„è¯ï¼Œå°±æ— èƒ½ä¸ºåŠ›äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æœåŠ¡å™¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¸¸ç”¨æ ·å¼æ±‡æ€»</title>
      <link href="/2018/11/01/%E5%B8%B8%E7%94%A8%E6%A0%B7%E5%BC%8F%E6%B1%87%E6%80%BB/"/>
      <url>/2018/11/01/%E5%B8%B8%E7%94%A8%E6%A0%B7%E5%BC%8F%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å°æ‰‹æ ·å¼"><a href="#1-å°æ‰‹æ ·å¼" class="headerlink" title="1.å°æ‰‹æ ·å¼"></a>1.å°æ‰‹æ ·å¼</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cursor</span>: pointer</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="2-å‚ç›´å±…ä¸­"><a href="#2-å‚ç›´å±…ä¸­" class="headerlink" title="2.å‚ç›´å±…ä¸­"></a>2.å‚ç›´å±…ä¸­</h2><p>ä½¿ç”¨flexå¸ƒå±€<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"outer"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"inner"</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vertical-alignå±æ€§<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"outer"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"inner"</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">    <span class="attribute">display</span>: table-cell;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»å¯¹å®šä½<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"outer"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"inner"</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>after<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"outer"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"inner"</span>&gt;&lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.outer</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.outer</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inner</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-vertical-alignå¤±æ•ˆé—®é¢˜"><a href="#3-vertical-alignå¤±æ•ˆé—®é¢˜" class="headerlink" title="3.vertical-alignå¤±æ•ˆé—®é¢˜"></a>3.vertical-alignå¤±æ•ˆé—®é¢˜</h2><p>vertical-alignå±æ€§åªå¯¹è¡Œå†…å…ƒç´ æœ‰æ•ˆæœï¼Œè¦æƒ³åœ¨å—çº§å…ƒç´ å¤±æ•ˆå…ˆè®¾ç½®ä¸€ä¸‹displayinline-block</p><h2 id="4-cssæ¸å˜"><a href="#4-cssæ¸å˜" class="headerlink" title="4. cssæ¸å˜"></a>4. cssæ¸å˜</h2><p>çº¿æ€§æ¸å˜-ä»ä¸Šåˆ°ä¸‹ï¼ˆé»˜è®¤ï¼‰<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#grad</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(red, blue); <span class="comment">/* Safari 5.1 - 6.0 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(red, blue); <span class="comment">/* Opera 11.1 - 12.0 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(red, blue); <span class="comment">/* Firefox 3.6 - 15 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(red, blue); <span class="comment">/* æ ‡å‡†çš„è¯­æ³• */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>çº¿æ€§æ¸å˜-ä»å·¦åˆ°å³<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#grad</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left, red , blue); <span class="comment">/* Safari 5.1 - 6.0 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(right, red, blue); <span class="comment">/* Opera 11.1 - 12.0 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(right, red, blue); <span class="comment">/* Firefox 3.6 - 15 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, red , blue); <span class="comment">/* æ ‡å‡†çš„è¯­æ³• */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>çº¿æ€§æ¸å˜ - å¯¹è§’<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#grad</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(left top, red , blue); <span class="comment">/* Safari 5.1 - 6.0 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(bottom right, red, blue); <span class="comment">/* Opera 11.1 - 12.0 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(bottom right, red, blue); <span class="comment">/* Firefox 3.6 - 15 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to bottom right, red , blue); <span class="comment">/* æ ‡å‡†çš„è¯­æ³• */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>window.openè¢«æ‹¦æˆªè§£å†³</title>
      <link href="/2018/10/28/window.open%E8%A2%AB%E6%8B%A6%E6%88%AA/"/>
      <url>/2018/10/28/window.open%E8%A2%AB%E6%8B%A6%E6%88%AA/</url>
      
        <content type="html"><![CDATA[<p>é¡¹ç›®å¼€å‘ä¸­é‡åˆ°window.openå†™åœ¨å›è°ƒé‡Œè¢«æµè§ˆå™¨æ‹¦æˆª.<br>è§£å†³åŠæ³•æ˜¯åœ¨è¯·æ±‚æ—¶æ–°å¼€ä¸€ä¸ªtabé¡µï¼Œç„¶åå†è¯·æ±‚çš„å›è°ƒé‡Œä¿®æ”¹è¿™ä¸ªtabé¡µçš„åœ°å€.</p><a id="more"></a><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> newWindow = <span class="built_in">window</span>.open(<span class="string">'about:blank'</span>); <span class="comment">//  æ–°å¼€ä¸€ä¸ªtabé¡µè¿”å›ä¸€ä¸ªwindowå¯¹è±¡</span></span><br><span class="line">axios.post(url&#125;)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(response.data.status.code === <span class="number">1</span>)&#123;</span><br><span class="line">            newWindow.location.href = <span class="string">''</span> <span class="comment">//  ä¿®æ”¹æ–°å¼€é¡µé¢çš„åœ°å€</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>reactåº”ç”¨ä¸­mobxæœªæ£€æµ‹åˆ°æ•°ç»„çš„æ›´æ–°</title>
      <link href="/2018/10/28/react%E5%BA%94%E7%94%A8%E4%B8%ADmobx%E6%9C%AA%E6%A3%80%E6%B5%8B%E5%88%B0%E6%95%B0%E7%BB%84%E7%9A%84%E6%9B%B4%E6%96%B0/"/>
      <url>/2018/10/28/react%E5%BA%94%E7%94%A8%E4%B8%ADmobx%E6%9C%AA%E6%A3%80%E6%B5%8B%E5%88%B0%E6%95%B0%E7%BB%84%E7%9A%84%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<p>åœ¨mobxä¸­å®šä¹‰ä¸€ä¸ªå¯è§‚å¯Ÿçš„æ•°ç»„<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span>&#123;</span></span><br><span class="line">    @observable testArray = [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨ç»„ä»¶é‡Œé¢å¼•ç”¨è¿™ä¸ªstore<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">testArray.map(<span class="function"><span class="params">item</span>=&gt;</span>(</span><br><span class="line">    &lt;span&gt;&#123;item&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">))</span></span><br></pre></td></tr></table></figure></p><a id="more"></a><p>è¿™ä¸ªæ‰“å°è¿™ä¸ªtestArrayæ•°ç»„ä¼šå‘ç°è¿™ä¸ªæ—¶å€™çš„æ•°ç»„ç±»å‹å·²ç»ä¸æ˜¯æˆ‘ä»¬å¸¸è§„çš„arrayç±»å‹äº†ï¼Œå·²ç»è¢«mobxè½¬æ¢æˆäº†observableArrayç±»å‹çš„æ•°ç»„ï¼Œè¿™ç§çš„å¦‚æœä½ çš„storeé‡Œé¢åªæœ‰è¿™ä¸€ä¸ªæ•°ç»„æ²¡æœ‰å…¶ä»–å˜é‡çš„æ—¶å€™ï¼Œæ›´æ–°æ•´ä¸ªæ•°ç»„ï¼Œé™¤éä½ æ˜¯å°†è¿™ä¸ªæ•°ç»„ç½®ä¸ºç©ºï¼Œä¸ç„¶ç»„ä»¶æ˜¯ä¸ä¼šè§‚å¯Ÿåˆ°ä»–çš„æ”¹å˜ï¼Œå°±ä¸ä¼šé‡æ–°renderäº†<br>è§£å†³åŠæ³•æ˜¯ï¼š<br>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªæ•°ç»„çš„æ—¶å€™ï¼Œslice()ä¸€ä¸‹è½¬å˜æˆæˆ‘ä»¬æ­£å¸¸çš„jsç±»å‹çš„arrayå°±å¯ä»¥äº†<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">testArray.slice().map(<span class="function"><span class="params">item</span>=&gt;</span>(</span><br><span class="line">    &lt;span&gt;&#123;item&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">))</span></span><br></pre></td></tr></table></figure></p><p>å…·ä½“sliceçš„åœ°æ–¹å¯ä»¥æ˜¯åœ¨storeé‡Œé¢ä¹Ÿå¯ä»¥åœ¨ç»„ä»¶é‡Œé¢ï¼Œç»„ä»¶é‡Œé¢å°±åƒä¸Šé¢å†™çš„é‚£æ ·,storeé‡Œé¢å°±æ˜¯å…ˆå¾—åˆ°testArrayç„¶åsliceä¸€ä¸‹ï¼Œåœ¨æŠŠæ–°çš„æ•°ç»„èµ‹å€¼ç»™ä»–ã€‚<br>å¦‚æœé‡åˆ°ä½¿ç”¨æ•°ç»„çš„æ—¶å€™å‡ºç°ä¸€äº›çœ‹ä¸æ‡‚çš„æŠ¥é”™ï¼Œæ’é™¤æ•°ç»„è¶Šç•Œçš„ä¸€äº›é”™è¯¯ï¼Œå¤šåŠæ˜¯å› ä¸ºobservableArrayç±»å‹çš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™ä¸å¦¨slice()ä¸€ä¸‹è¯•è¯•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> react </tag>
            
            <tag> mobx </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç¬¬ä¸€æ¬¡ä½¿ç”¨hexoæ­å»ºåšå®¢çš„è®°å½•</title>
      <link href="/2018/10/27/%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E7%9A%84%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/10/27/%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E7%9A%84%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>åŸºäºgithubçš„åšå®¢ï¼Œæ­å»ºè¿‡ç¨‹å¯è°“å¯æ­Œå¯æ³£ï¼Œç¿»éäº†é…ç½®æ–‡ä»¶ï¼Œæ€»çš„æ¥è¯´æ˜¯æˆåŠŸäº†ç™¾åˆ†ä¹‹å…«åã€‚åŸºæœ¬çš„å½¢çŠ¶å·²ç»æ­å»ºå¥½äº†ï¼Œè¯„è®ºçš„åŠŸèƒ½è¿˜æœªåŠ å…¥ï¼Œç­‰å¾…åç»­æ·»åŠ ã€‚åˆšå¼€å§‹ä½¿ç”¨çš„æ˜¯Jekyllçš„ä¸»é¢˜ï¼Œä¸ªäººè§‰å¾—è¿˜æ˜¯hexoçš„ä¸»é¢˜å¥½çœ‹ä¸€ç‚¹ï¼Œä¸»è¦æ˜¯ä¸€å¼€å§‹ä½¿ç”¨Jekyllçš„ä¸»é¢˜ç›´æ¥å´©æ‰äº†ï¼Œæ±—ã€‚ã€‚ã€‚ã€‚</p><a id="more"></a><h2 id="1-åˆ›å»ºä¸€ä¸ªgithubè´¦æˆ·"><a href="#1-åˆ›å»ºä¸€ä¸ªgithubè´¦æˆ·" class="headerlink" title="1.åˆ›å»ºä¸€ä¸ªgithubè´¦æˆ·"></a>1.åˆ›å»ºä¸€ä¸ªgithubè´¦æˆ·</h2><p>è¿™ä¸ªç›´æ¥å®˜ç½‘åˆ›å»º <a href="https://github.com/" target="_blank" rel="noopener">GitHub</a></p><h2 id="2-åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“"><a href="#2-åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“" class="headerlink" title="2.åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“"></a>2.åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“</h2><p><img src="http://static.zybuluo.com/shenweizheng/m90nw4nyb9ohg4tqv1ruaw8i/TIM%E6%88%AA%E5%9B%BE20181021221725.png" alt="åˆ›å»ºæœ¬åœ°ä»“åº“"><br><img src="http://static.zybuluo.com/shenweizheng/kcp6ug83piiw75khyr3pjrck/TIM%E6%88%AA%E5%9B%BE20181021221854.png" alt="å¡«å†™åŸºæœ¬ä¿¡æ¯"><br>è¿™é‡Œè¦æ³¨æ„ä½ çš„Repository nameçš„æ ¼å¼å¿…é¡»æ˜¯  ç”¨æˆ·å.github.ioï¼Œè®°å¾—å‹¾é€‰ä¸‹é¢çš„åˆå§‹åŒ–READMEï¼Œå½“ç„¶è¿™ä¸ªé€‰ä¸é€‰åº”è¯¥æ˜¯æ— æ‰€è°“çš„.<br>è¿™ä¸ªåˆ›å»ºå®Œä¹‹åï¼Œä½ çš„åšå®¢åœ°å€å°±æ˜¯ https://ç”¨æˆ·å.github.io</p><h2 id="3-å®‰è£…Gitï¼Œnode"><a href="#3-å®‰è£…Gitï¼Œnode" class="headerlink" title="3.å®‰è£…Gitï¼Œnode"></a>3.å®‰è£…Gitï¼Œnode</h2><p>æˆ‘ä»¬è¦ç”¨åˆ°gitå‘½ä»¤å’Œnodeå‘½ä»¤çš„ï¼Œè¿™è¾¹å®‰è£…æ•™ç¨‹å°±æ²¡æœ‰äº†ï¼Œå®˜ç½‘ä¸Šéƒ½æœ‰çš„ï¼Œgitä¸å¥½å®‰è£…çš„è¯ç›´æ¥å»360å®‰å…¨ç®¡å®¶ä¸Šå®‰è£…ï¼Œåæ­£æˆ‘æ˜¯è¿™ä¹ˆå®‰è£…çš„git</p><h2 id="4-é…ç½®gitç”ŸæˆSSHkey"><a href="#4-é…ç½®gitç”ŸæˆSSHkey" class="headerlink" title="4. é…ç½®gitç”ŸæˆSSHkey"></a>4. é…ç½®gitç”ŸæˆSSHkey</h2><p>é¼ æ ‡å³å‡»ä¼šæœ‰ä¸€ä¸ª Git BashHereçš„èœå•ï¼Œé€‰æ‹©è¿™ä¸ªï¼Œæ‰“å¼€çš„å°±æ˜¯æˆ‘ä»¬Gitå‘½ä»¤è¡Œçš„é¡µé¢äº†ï¼Œé¦–å…ˆè®¾ç½®ä¸€ä¸‹å…¨å±€çš„nameå’Œemail<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git<span class="built_in"> config </span>--global user.name <span class="string">"ä½ çš„GitHubç”¨æˆ·å"</span></span><br><span class="line">git<span class="built_in"> config </span>--global user.email <span class="string">"ä½ çš„GitHubæ³¨å†Œé‚®ç®±"</span></span><br></pre></td></tr></table></figure></p><p>é…ç½®SSHkey<br><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -<span class="built_in">t</span> rsa -C <span class="string">"ä½ çš„GitHubæ³¨å†Œé‚®ç®±"</span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœä½ ä¸éœ€è¦ä¿®æ”¹å­˜æ”¾è·¯åŠ²çš„è¯ï¼Œä¸€è·¯å›è½¦ï¼Œæœ€åç”Ÿæˆçš„sshkeyåœ¨C:\Users\Administrator.ssh\id_rsa.pubè¿™ä¸ªé‡Œé¢<br>ç»‘å®šSSHKey<br><img src="http://static.zybuluo.com/shenweizheng/yq5z8046ndm8lwqey2dre8w4/TIM%E6%88%AA%E5%9B%BE20181021223352.png" alt="TIMæˆªå›¾20181021223352.png-13.3kB"><br><img src="http://static.zybuluo.com/shenweizheng/6zihqrjaxju7inxwces2gjp3/TIM%E6%88%AA%E5%9B%BE20181021223452.png" alt="TIMæˆªå›¾20181021223452.png-55.5kB"><br>New SShkey  ä¹‹åçš„titleè¿™ä¸ªéšæ„ï¼Œkeyçš„å†…å®¹æ˜¯ä½ C:\Users\Administrator.ssh\id_rsa.pubè¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹ä½ éœ€è¦éƒ½å¤åˆ¶è¿‡æ¥</p><h2 id="5-å®‰è£…Hexo"><a href="#5-å®‰è£…Hexo" class="headerlink" title="5.å®‰è£…Hexo"></a>5.å®‰è£…Hexo</h2><p>åœ¨ç£ç›˜é‡Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ ä¾‹å¦‚æˆ‘åœ¨Fç›˜æ–°å»ºä¸€ä¸ªmyBlogçš„æ–‡ä»¶å¤¹ï¼Œè¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œé¼ æ ‡å³å‡»git bash here<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-cli g</span><br><span class="line">npm <span class="keyword">install</span> hexo -g</span><br></pre></td></tr></table></figure></p><p>hexo-cliå’Œhexoéƒ½å…¨å±€å®‰è£…ä¸€ä¸‹<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo v</span></span><br></pre></td></tr></table></figure></p><p>é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥çœ‹ä¸€ä¸‹hexoæ˜¯ä¸æ˜¯è£…å¥½äº†ï¼Œå¦‚æœå‡ºç° hexo ä¸æ˜¯commandè¿™ç§æŠ¥é”™çš„ï¼Œè¡¨æ˜ç¯å¢ƒå˜é‡æ²¡æœ‰é…ç½®å¥½ï¼Œéœ€è¦é…ç½®ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œhexoåœ¨ä¹‹å‰çš„ç‰ˆæœ¬å¥½åƒæ˜¯ä¼šè‡ªå·±é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½†æ˜¯ç°åœ¨ä¸è¡Œäº†ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨é…ç½®ã€‚<br>é¦–å…ˆæ‰¾åˆ°å®‰è£… hexo çš„è·¯å¾„ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯D:\nodejs\npm_global_modules\node_modules\hexo\node_modules<br>è¿™è¾¹æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯nodeå…¨å±€å®‰è£…çš„æ¨¡å—çš„è·¯å¾„ï¼Œé»˜è®¤éƒ½æ˜¯åœ¨Cç›˜ï¼Œè¿™æ ·å¤ªå ç©ºé—´äº†ï¼Œè¿™ä¸ªå¦‚æœ‰éœ€è¦è‡ªè¡Œç™¾åº¦ä¸€ä¸‹å¦‚ä½•ä¿®æ”¹nodeå…¨å±€æ¨¡å—çš„å®‰è£…è·¯å¾„ï¼Œæˆ‘æ˜¯æ”¹è¿‡äº†ï¼ŒCç›˜å¤ªå°æ‰¿å—ä¸ä½ã€‚å›åˆ°æ­£é¢˜ï¼Œæ‰¾åˆ°hexoçš„å®‰è£…è·¯å¾„åï¼Œæ‰“å¼€è®¡ç®—æœºçš„ç¯å¢ƒå˜é‡ï¼Œåœ¨ç³»ç»Ÿå˜é‡æ–°å»º HEXOPATH å˜é‡å€¼æ˜¯æˆ‘ä»¬æ‰¾åˆ°çš„hexoå®‰è£…ç›®å½•ï¼Œä¾‹å¦‚æˆ‘çš„æ˜¯D:\nodejs\npm_global_modules\node_modules\hexo\node_modules è¿™ä¸ªè¦æ³¨æ„è¦hexoå‰é¢çš„è·¯å¾„æ¯ä¸ªäººä¸ä¸€æ ·ï¼Œä½†æ˜¯ä»hexoå¼€å§‹åˆ°åé¢çš„è·¯å¾„è‚¯å®šæ˜¯å’Œæˆ‘ä¸€æ ·çš„ã€‚<br>è¦å®šä½åˆ°hexoçš„node_modulesä¸‹ã€‚åˆ›å»ºå®Œç³»ç»Ÿå˜é‡åï¼Œåœ¨ç¯å¢ƒå˜é‡é‡Œæ‰¾åˆ°Pathå˜é‡ï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œåœ¨æœ«å°¾æ·»åŠ <br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;<span class="meta">%</span>HEXOPATH<span class="meta">%</span>\.bi<span class="symbol">n</span></span><br></pre></td></tr></table></figure></p><p>æ³¨æ„è¿™è¾¹çš„åˆ†å·ï¼Œå¦‚æœæœ¬æ¥pathçš„æœ«å°¾æœ‰åˆ†å·çš„è¯å°±ä¸ç”¨åŠ äº†ã€‚é…ç½®å®Œç¯å¢ƒå˜é‡ä¹‹åï¼Œcmdè¿›å‘½ä»¤è¡Œ hexo vçœ‹æ˜¯ä¸æ˜¯èƒ½æˆåŠŸæ‰“å°å‡ºhexoçš„ç‰ˆæœ¬å·ï¼Œç±»ä¼¼äºè¿™æ ·<br><img src="http://static.zybuluo.com/shenweizheng/qreltan9nvok2lwmp6opnidy/TIM%E6%88%AA%E5%9B%BE20181021225244.png" alt="TIMæˆªå›¾20181021225244.png-13.5kB"></p><h2 id="6-åˆå§‹åŒ–hexoæ–‡ä»¶å¤¹"><a href="#6-åˆå§‹åŒ–hexoæ–‡ä»¶å¤¹" class="headerlink" title="6.åˆå§‹åŒ–hexoæ–‡ä»¶å¤¹"></a>6.åˆå§‹åŒ–hexoæ–‡ä»¶å¤¹</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hexo init blog</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨hexo initå‘½ä»¤åˆå§‹åŒ–ä¸€ä¸ªå«blogçš„æ–‡ä»¶å¤¹ï¼Œç„¶å<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">./blog</span></span><br></pre></td></tr></table></figure></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥åˆšåˆšåˆå§‹åŒ–çš„æ–‡ä»¶å¤¹,å®‰è£…hexoçš„ç›¸å…³é…ç½®<br>å®‰è£…hexoçš„å…¶ä»–æ’ä»¶ï¼Œåœ¨åšå®¢é…ç½®ä¸­éœ€è¦ç”¨åˆ°<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-<span class="keyword">server</span> <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-<span class="keyword">admin</span> <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-<span class="keyword">archive</span> <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-feed <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-<span class="keyword">search</span> <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-tag <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-sitemap <span class="comment">--save</span></span><br></pre></td></tr></table></figure></p><h2 id="7-æœ¬åœ°è®¿é—®"><a href="#7-æœ¬åœ°è®¿é—®" class="headerlink" title="7.æœ¬åœ°è®¿é—®"></a>7.æœ¬åœ°è®¿é—®</h2><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ç”Ÿæˆé™æ€é¡µé¢</span><br><span class="line">hexo <span class="keyword">generate</span></span><br><span class="line">å¼€å¯æœ¬åœ°æœåŠ¡å™¨</span><br><span class="line">hexo s</span><br><span class="line">è®¿é—®åœ°å€</span><br><span class="line">http:<span class="comment">//localhost:4000/</span></span><br></pre></td></tr></table></figure><h2 id="8-éƒ¨ç½²github"><a href="#8-éƒ¨ç½²github" class="headerlink" title="8.éƒ¨ç½²github"></a>8.éƒ¨ç½²github</h2><p>åœ¨éƒ¨ç½²ä¹‹å‰æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹åšå®¢çš„é…ç½®ï¼Œåœ¨blog/_config.ymlä¸ºæ–‡ä»¶ä¸­æ‰¾åˆ°deployè¿™ä¸ªè¯ï¼Œè¿™ä¸ªæ˜¯é…ç½®githubçš„<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">type</span>: git</span><br><span class="line">#è¿™é‡Œæ˜¯ç¬¬äºŒéƒ¨åˆ›å»ºçš„ä»“åº“çš„åœ°å€</span><br><span class="line"><span class="attribute">repo</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:gitç”¨æˆ·å/gitç”¨æˆ·æˆ·å.github.io.git</span><br><span class="line">#éƒ¨ç½²çš„åˆ†æ”¯</span><br><span class="line"><span class="attribute">branch</span>: master</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹å®Œé…ç½®ä¹‹å<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#æ¸…ç©ºé™æ€é¡µé¢</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="meta">#ç”Ÿæˆé™æ€é¡µé¢</span></span><br><span class="line">hexo generate</span><br><span class="line"><span class="meta">#éƒ¨ç½² </span></span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure></p><p>è¾“å…¥ä½ çš„åšå®¢åœ°å€ https://ç”¨æˆ·å.github.io å°±å¯ä»¥è®¿é—®äº†<br>hexoçš„ä¸»é¢˜æ›´æ¢é…ç½®ä»¥åŠhexoåšå®¢çš„é…ç½®å°†åœ¨ä¸‹ä¸€ç¯‡å†™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>å…³äºspringboot postæ–¹æ³•å‚æ•°ä¸ºä¸¤ä¸ªå®ä½“ç±»çš„è§£å†³åŠæ³•</title>
      <link href="/2018/10/27/%E5%85%B3%E4%BA%8Espringboot%20post%E6%96%B9%E6%B3%95%E5%8F%82%E6%95%B0%E4%B8%BA%E4%B8%A4%E4%B8%AA%E5%AE%9E%E4%BD%93%E7%B1%BB%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
      <url>/2018/10/27/%E5%85%B3%E4%BA%8Espringboot%20post%E6%96%B9%E6%B3%95%E5%8F%82%E6%95%B0%E4%B8%BA%E4%B8%A4%E4%B8%AA%E5%AE%9E%E4%BD%93%E7%B1%BB%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>å‰ç«¯è°ƒç”¨åç«¯apiæŸä¸ªpostæ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°æ–¹æ³•çš„å‚æ•°ä¸ºä¸¤ä¸ªå®ä½“ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·ä¼ å‚ï¼Œåå°ä¼šå‘ç”Ÿæ¥æ”¶ä¸åˆ°å‚æ•°çš„é—®é¢˜ã€‚</p><h2 id="1-åˆ†è£…æˆdto"><a href="#1-åˆ†è£…æˆdto" class="headerlink" title="1.åˆ†è£…æˆdto"></a>1.åˆ†è£…æˆdto</h2><p>å¦‚æœä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å®ä½“ç±»çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨å°†ä¸¤ä¸ªå®ä½“ç±»å°è£…æˆä¸€ä¸ªå®ä½“ç±»çš„æ–¹æ³•ã€‚æ¯”å¦‚è¯´æœ‰ä¸¤ä¸ªå®ä½“ç±»ï¼ŒTecherå’ŒCourse è¿™æ˜¯ä¸¤ä¸ªpojo é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå®ä½“ç±»å«åš TeacherCourseDto ä»–çš„å±æ€§åªæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯Teacher teacherä¸€ä¸ªæ˜¯Course course è¿™æ ·å‰å°ä¼ å‚çš„æ—¶å€™<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attribute">teacher</span>: value1,</span><br><span class="line">    course: value2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·å°±å¯ä»¥äº†</p><a id="more"></a><h2 id="2-é‡‡ç”¨-InitBinderæ³¨è§£"><a href="#2-é‡‡ç”¨-InitBinderæ³¨è§£" class="headerlink" title="2.é‡‡ç”¨@InitBinderæ³¨è§£"></a>2.é‡‡ç”¨@InitBinderæ³¨è§£</h2><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@InitBinder</span>(<span class="string">"student"</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">initBinderStudent</span><span class="params">(WebDataBinder binder)</span></span>&#123;</span><br><span class="line">      binder.setFieldDefaultPrefix(<span class="string">"student."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@InitBinder</span>(<span class="string">"course"</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">initBinderCourse</span><span class="params">(WebDataBinder binder)</span></span>&#123;</span><br><span class="line">      binder.setFieldDefaultPrefix(<span class="string">"course."</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>@InitBinder() ä¸­é—´çš„valueå€¼ï¼Œç”¨äºæŒ‡å®šè¡¨å•å±æ€§æˆ–è¯·æ±‚å‚æ•°çš„åå­—ï¼Œç¬¦åˆè¯¥åå­—çš„å°†ä½¿ç”¨æ­¤å¤„çš„DataBinder<br>æ³¨æ„ï¼š binder.setFieldDefaultPrefix(â€œstudent.â€)ï¼Œè¿™é‡Œçš„â€.â€åƒä¸‡åˆ«å¿˜è®°äº†ï¼ï¼ï¼<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword"><span class="keyword">implements</span> <span class="type">Serializable</span></span></span>&#123;  </span><br><span class="line">  <span class="keyword">String</span> id;  </span><br><span class="line">  <span class="keyword">String</span> note;  </span><br><span class="line">  <span class="comment">//get..set....  </span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> <span class="keyword"><span class="keyword">implements</span> <span class="type">Serializable</span></span></span>&#123;  </span><br><span class="line">  <span class="keyword">String</span> id;  </span><br><span class="line">  <span class="keyword">String</span> note;</span><br><span class="line">  <span class="comment">//set..get...  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™è¾¹ä¸¤ä¸ªå®ä½“ç±»ï¼ŒåŠ ä¸Šæˆ‘ä»¬ä¸Šé¢çš„initBinderæ³¨è§£ è¿˜è¦åœ¨ctrlä¸Šåšç‚¹åŠ¨ä½œ<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span>  </span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/classtest"</span>)  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> TestController &#123;  </span><br><span class="line">    <span class="comment">// ç»‘å®šå˜é‡åå­—å’Œå±æ€§ï¼Œå‚æ•°å°è£…è¿›ç±»  </span></span><br><span class="line">    <span class="meta">@InitBinder</span>(<span class="string">"student"</span>)  </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> initBinderUser(WebDataBinder binder) &#123;  </span><br><span class="line">        binder.setFieldDefaultPrefix(<span class="string">"student."</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">// ç»‘å®šå˜é‡åå­—å’Œå±æ€§ï¼Œå‚æ•°å°è£…è¿›ç±»  </span></span><br><span class="line">    <span class="meta">@InitBinder</span>(<span class="string">"course"</span>)  </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">void</span> initBinderAddr(WebDataBinder binder) &#123;  </span><br><span class="line">        binder.setFieldDefaultPrefix(<span class="string">"course."</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/methodtest"</span>)  </span><br><span class="line">    <span class="meta">@ResponseBody</span>  </span><br><span class="line">   <span class="keyword">public</span> Map&lt;<span class="built_in">String</span>,<span class="built_in">Object</span>&gt; test(<span class="meta">@ModelAttribute</span>(<span class="string">"student"</span>) Student student,<span class="meta">@ModelAttribute</span>(<span class="string">"course"</span>) Course course)&#123;  </span><br><span class="line">        Map&lt;<span class="built_in">String</span>,<span class="built_in">Object</span>&gt; map=<span class="keyword">new</span> HashMap&lt;<span class="built_in">String</span>,<span class="built_in">Object</span>&gt;();  </span><br><span class="line">        map.put(<span class="string">"student"</span>, student);  </span><br><span class="line">        map.put(<span class="string">"course"</span>, course);  </span><br><span class="line">        <span class="keyword">return</span> map;  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>ctrlä¸Šçš„å‚æ•°ä½¿ç”¨@ModelAttributeæ³¨è§£æŒ‡å®šï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å‚æ•°ä¸¤ä¸ªå®ä½“ç±»ï¼Œä¸ç”¨å†å»å¤šå†™ä¸€ä¸ªdtoäº†<br>å½“ç„¶è¿™ç§æ–¹æ³•ä¹Ÿæœ‰ç¼ºé™·ï¼Œå…·ä½“å‚è€ƒ<a href="https://www.jianshu.com/p/59771cbf373d" target="_blank" rel="noopener">SpringMVCè¡¨å•å¤šå¯¹è±¡ä¼ é€’å°æŠ€å·§â€”â€”@InitBinder</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
